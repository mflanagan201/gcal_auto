---
title: <span class="text-center" style="color:#A3915E"> <center> <font size="6">  **External Trade Release**  </font> </center> </span>
output:
  
  

text-align:  justify
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    cache       = TRUE,     # if TRUE knitr will cache the results to reuse in future knits
    fig.width   = 10,       # the width for plots created by code chunk
    fig.height  = 5,       # the height for plots created by code chunk
    fig.align   = 'center', # how to align graphics in the final doc. 'left', 'right', 'center'
tidy.opts=list(width.cutoff=10))


library(formatR)
library(htmlwidgets)
library(htmltools)
library('openxlsx')
library(dplyr)
library(xts)
library(magrittr)
library(dplyr)
library(ggplot2)
library(rdbnomics)
library(csodata)
library(reshape2)
library(formattable)
library(knitr)
library(htmlwidgets)
library(kableExtra)
library(tinytex)
library(readr)
library(lubridate)

cso_clear_cache() 


DOF_colours <- c("#01A685", "#A3915E", "#0190D4","#4473c4","#afb6bd","#dbac00")

growth <- function(x, freq){(x/lag.xts(x, k = freq)-1)*100}



conditional <- function(x){
  if (x > 0) {
    (paste0("increased by ", round((x), digits = 1),sep="%"))
  } else if (x < 0){
    (paste0("decreased by ", round((x), digits = 1),sep="%"))
  } else {
    (paste0("was flat at ", round((x), digits = 1),sep="%"))
  }
}

conditional_alt <- function(x){
  if (x > x) {
    print(paste("pace of growth has increased", round((x), digits = 1,sep="%")))
  } else if (x < 0){
    print(paste("decreasing by", round((x), digits = 1,sep="%")))
  } else {
    print(paste("flat at", round((x), digits = 1,sep="%")))
  }
}

conditional_alt2 <- function(x){
  if (x > 0) {
    print(paste(round((x), digits = 1)," higher than ",sep="%"))
  } else if (x < 0){
    print(paste(round((x), digits = 1), " lower than ",sep="%"))
  } else {
    print(paste("remains flat at ", round(abs(x), digits = 1,sep="%")))
  }
}

conditional_alt3 <- function(x){
  if (x < lag.xts(x,k=1)) {
    print(paste("a slower pace of growth compared to the previous month"))
  } else if (x >lag.xts(x,k=1)){
    print(paste("a faster pace of growth compared to the previous month"))
  } else {
    print(paste("a consistent pace of growth compared to the previous month"))
  }
}


conditional_alt4 <- function(x){
  if (x < 0) {
    print(paste(round(x,1), "percentage points below what was forecast at the time of the Budget"))
  } else if (x >0){
    print(paste(round(x,1), "percentage points above what was forecast at the time of the Budget"))
  } else {
    print(paste("inline with the Budget forecast"))
  }
}

conditional_alt5 <- function(x){
  if (x < 0) {
    print(paste("made a negative contribution of", round(x,1), "percentage points to overall export growth"))
  } else if (x >0){
    print(paste("made a positive contribution of", round(x,1), "percentage points to overall export growth"))
  } else {
    print(paste("made a broadly balanced contribution to overall export growth"))
  }
}



conjunction <- function(x, y){
  if (x > 0 & y > 0) {
  print("and")
  } else if (x < 0 & y < 0) {
    print("and")
  }   else {
      print("but")
  }
}

growth <- function(x, freq){(x/lag.xts(x, k = freq)-1)*100}

THREE_MONTH_GROWTH<-NA
Three_month_yoy <- function(A){
  for(i in 3:nrow(A)){
  THREE_MONTH_GROWTH[i]<-((sum(A[index(A[(nrow(A[1:i])-2):nrow(A[1:i])])])/sum(A[index(A[(nrow(A[1:i])-2):nrow(A[1:i])])-years(1)]))-1)*100    
  }
  THREE_MONTH_GROWTH<-THREE_MONTH_GROWTH %>% as.xts(index(A))
  return(round(THREE_MONTH_GROWTH,2))
}

YTD_CURRENTYEAR<-NA

YTD <- function(x){
  
  CURRENTYEAR_YTD<-x[paste0("",index((last(x))) %>% year(),"")]
  LASTYEAR<-x[paste0("",(index(CURRENTYEAR_YTD)-years(1)),"")]
  
  YTD_CURRENTYEAR <- CURRENTYEAR_YTD
  
  for(i in 1:length(CURRENTYEAR_YTD)){
    YTD_CURRENTYEAR[i]<-((as.numeric(sum(CURRENTYEAR_YTD[1:i]))/as.numeric(sum(LASTYEAR[1:i])))-1)*100
  } 
  return(YTD_CURRENTYEAR)
}




Ire_Exports<- t(data.frame(subset(cso_get_data("TSM10"),Statistic=="Value of Exports")))
Ire_Exports_SA<- t(data.frame(subset(cso_get_data("TSM01"),Statistic=="Total Exports (Seasonally Adjusted)")))
Ire_Exports_val<- t(data.frame(subset(cso_get_data("TSM01"),Statistic=="Total Exports")))
Ire_Exports_vol<- na.exclude(t(data.frame(subset(cso_get_data("TSM02"),Statistic=="Trade Volume Index for Exports"))))
Ire_Exports_SA_vol<- na.exclude(t(data.frame(subset(cso_get_data("TSM02"),Statistic=="Trade Volume Index for Exports (Seasonally Adjusted)"))))

Ire_Exports_SA_vol<-na.exclude(as.numeric(Ire_Exports_SA_vol[3:length(Ire_Exports_SA_vol)]))
Ire_Exports_vol<-na.exclude(as.numeric(Ire_Exports_vol[3:length(Ire_Exports_vol)]))


Date<-seq(as.Date("2014-10-01"), by="month",length.out=NROW(Ire_Exports))
Ireland_Exports<-as.xts(Ire_Exports, order.by = Date)
colnames(Ireland_Exports)<-Ireland_Exports["2014-12-01"]

Date_vol<-seq(as.Date("1970-01-01"), by="month",length.out=NROW(Ire_Exports_SA_vol)) 
Date_value<-seq(as.Date("1969-11-01"), by="month",length.out=NROW(Ire_Exports_SA))

current_date<-format(max(Date_value), "%B %Y")
current_date_vol<-format(max(Date_vol), "%B %Y")

Date_vol_export<-seq(as.Date("1970-01-01"), by="month",length.out=NROW(Ire_Exports_vol))


#Volume data seasonally adjusted for monthly/Quarterly analysis 
Ireland_Exports_SA_vol_xts<-na.locf(as.xts(Ire_Exports_SA_vol, order.by = Date_vol_export),na.rm=TRUE)
Ireland_Exports_SA_vol_xts<-as.numeric(Ireland_Exports_SA_vol_xts["2015/"],na.rm = TRUE)
Date_vol_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Exports_SA_vol_xts))
Ireland_Exports_SA_vol_xts<-as.xts((Ireland_Exports_SA_vol_xts), order.by = Date_vol_2015)

#Volume data  Not seasonally adjusted for annual analysis 
Ireland_Exports_vol_xts<-na.locf(as.xts(Ire_Exports_vol, order.by = Date_vol_export),na.rm=TRUE)
Ireland_Exports_vol_xts<-as.numeric(Ireland_Exports_vol_xts["2015/"],na.rm = TRUE)
Date_vol_NASA_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Exports_vol_xts))
Ireland_Exports_vol_xts<-as.xts((Ireland_Exports_vol_xts), order.by = Date_vol_NASA_2015)

#Value data   seasonally adjusted for monthly/Quarterly analysis 
Ire_Exports_SA_xts<-na.locf(as.xts(Ire_Exports_SA, order.by = Date_value),na.rm=TRUE)
Ireland_Exports_val_xts<-as.numeric(Ire_Exports_SA_xts["2015/"],na.rm = TRUE)
Date_val_SA_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Exports_val_xts))
Ireland_Exports_val_xts<-as.xts((Ireland_Exports_val_xts), order.by = Date_val_SA_2015)

#Value data NOT  seasonally adjusted for monthly/Quarterly analysis 
Ire_Exports_val_xts<-na.locf(as.xts(Ire_Exports_val, order.by = Date_value),na.rm=TRUE)
Ireland_Exports_val_NAsA_xts<-as.numeric(Ire_Exports_val_xts["2015/"],na.rm = TRUE)
Date_val_Export<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Exports_val_NAsA_xts))
Ireland_Exports_val_NAsA_xts<-as.xts((Ireland_Exports_val_NAsA_xts), order.by = Date_val_Export)

Ire_Imports<- t(data.frame(subset(cso_get_data("TSM10"),Statistic=="Value of Imports")))
Ire_Imports_SA<- t(data.frame(subset(cso_get_data("TSM01"),Statistic=="Total Imports (Seasonally Adjusted)")))
Ire_Imports_val<- t(data.frame(subset(cso_get_data("TSM01"),Statistic=="Total Imports")))
Ire_Imports_vol<- na.exclude(as.numeric(t(data.frame(subset(cso_get_data("TSM02"),Statistic=="Trade Volume Index for Imports")))))
Ire_Imports_SA_vol<- na.exclude(as.numeric(t(data.frame(subset(cso_get_data("TSM02"),Statistic=="Trade Volume Index for Imports (Seasonally Adjusted)")))))

Ire_Imports_vol<-na.omit(as.numeric(Ire_Imports_vol))


Date<-seq(as.Date("2014-10-01"), by="month",length.out=NROW(Ire_Exports))
Ireland_Imports<-as.xts(Ire_Imports, order.by = Date)
colnames(Ireland_Imports)<-Ireland_Imports["2014-12-01"]

Date_vol<-seq(as.Date("1969-11-01"), by="month",length.out=NROW(Ire_Imports_SA_vol)) 
Date_value<-seq(as.Date("1969-11-01"), by="month",length.out=NROW(Ire_Imports_SA))

current_date<-format(max(Date_value), "%B %Y")
current_date_vol<-format(max(Date_vol), "%B %Y")


#Volume data seasonally adjusted for monthly/Quarterly analysis 
Ireland_Imports_SA_vol_xts<-na.locf(as.xts(Ire_Imports_SA_vol, order.by = Date_vol),na.rm=TRUE)
Ireland_Imports_SA_vol_xts<-as.numeric(Ireland_Imports_SA_vol_xts["2015/"],na.rm = TRUE)
Date_vol_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Imports_SA_vol_xts))
Ireland_Imports_SA_vol_xts<-as.xts((Ireland_Imports_SA_vol_xts), order.by = Date_vol_2015)

#Volume data  Not seasonally adjusted for annual analysis #

Date_vol_import<-seq(as.Date("1970-01-01"), by="month",length.out=NROW(Ire_Imports_vol))
Ireland_Imports_vol_xts<-na.locf(as.xts(Ire_Imports_vol, order.by = Date_vol_import),na.rm=TRUE)
Ireland_Imports_vol_xts<-as.numeric(Ireland_Imports_vol_xts["2015/"],na.rm = TRUE)
Date_vol_NASA_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Imports_vol_xts))
Ireland_Imports_vol_xts<-as.xts((Ireland_Imports_vol_xts), order.by = Date_vol_NASA_2015)


#Value data   seasonally adjusted for monthly/Quarterly analysis 
Ire_Imports_SA_xts<-na.locf(as.xts(Ire_Imports_SA, order.by = Date_value),na.rm=TRUE)
Ireland_Imports_val_xts<-as.numeric(Ire_Imports_SA_xts["2015/"],na.rm = TRUE)
Date_val_SA_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Imports_val_xts))
Ireland_Imports_val_xts<-as.xts((Ireland_Imports_val_xts), order.by = Date_val_SA_2015)


#Value data NOT  seasonally adjusted for monthly/Quarterly analysis 
Ire_Imports_val_xts<-na.locf(as.xts(Ire_Imports_val, order.by = Date_value),na.rm=TRUE)
Ireland_Imports_val_NASA_xts<-as.numeric(Ire_Imports_val_xts["2015/"],na.rm = TRUE)
Date_val_NASA_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Imports_val_NASA_xts))
Ireland_Imports_val_NASA_xts<-as.xts((Ireland_Imports_val_NASA_xts), order.by = Date_val_NASA_2015)


Export_Import<-merge(Ireland_Imports_val_NASA_xts,Ireland_Exports_val_NAsA_xts)
colnames(Export_Import)<-c("Exports", "Imports")

annual_growth_Export_Import<-na.locf(growth(Export_Import,12),na.rm=TRUE) %>% round (2)



#monthly IMPORT volume growth 
monthly_growth_exports_vol<-as.xts(round(growth(Ireland_Exports_SA_vol_xts,freq = 1),2))

#annual IMPORT volume growth
annual_growth_exports_vol<-as.xts(round(growth(Ireland_Exports_vol_xts,freq = 12),2))


#monthly IMPORT value growth 
monthly_growth_imports_val<-as.xts(round(growth(Ireland_Imports_val_xts,freq = 1),2))
Monthly_growth_imports_val_text<-conditional_alt2(monthly_growth_imports_val[length(monthly_growth_imports_val)])


#Annual IMPORT value growth 
annual_growth_imports_val<-round(growth(Ireland_Imports_val_NASA_xts,freq=12),2)
annual_growth_imports_val_text<-conditional(annual_growth_imports_val[length(annual_growth_imports_val)])

#Year to Date calculation
YTD_2022_annual_IMPORT<- 100*(sum(Ireland_Imports_val_NASA_xts["2024"])-sum(Ireland_Imports_val_NASA_xts["2023"][1:length(Ireland_Imports_val_NASA_xts["2024"])]))/sum(Ireland_Imports_val_NASA_xts["2023"][1:length(Ireland_Imports_val_NASA_xts["2024"])])
YTD_2022_annual_IMPORT_text<-conditional(YTD_2022_annual_IMPORT)


#Ire_EXports<- (cso_get_data("TSM13"))
#Ire_EXports_CLEAN<-t(Ire_EXports) %>% .[3:nrow(.),] %>% data.frame()
#colnames(Ire_EXports_CLEAN)<-t(Ire_EXports) %>% .[2,] 
#Ire_EXports_CLEAN_XTS<-Ire_EXports_CLEAN %>% as.xts(order.by = seq(from=as.Date("2020-01-01"), #length.out=nrow(Ire_EXports_CLEAN), by="month"))
                                            
                                            

#COUNTRY_NAMES<-c("") %>% stringr::str_replace_all("\t"," ")  
#t(Ire_EXports)						


#HICP_INDEX_XTS<-matrix(NA,nrow=length(Date),ncol=length(CSO_HICP_INDEX_NAMES)) %>% as.xts(order.by=Date)


#for(i in 1:length(COUNTRY_NAMES)){
#  HICP_INDEX_XTS[,i]<-CSO_HICP_INDEX_XTS[,paste(CSO_HICP_INDEX_NAMES[i])]
#}








                   #Country level aggregated 

Ireland_exports<- subset(cso_get_data("TSM10"),Statistic=="Value of Exports") %>% select(-Statistic)
Date<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ire_Exports)-3)

#Austria
Austria_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Austria") %>% select(-Countries.and.Territories))
colnames(Austria_exports) <-Austria_exports[1,]
Austria_exports<-Austria_exports[-c(1),]

Austria_exports_xts <- (as.xts(Austria_exports, order.by=Date))
Austria_exports_xts_num<-as.numeric(Austria_exports_xts["2015/"],na.rm = TRUE)
Austria_sum_export<-data.frame(NA, nrow=length(index(Austria_exports_xts["2015/"])))

for (i in 1:length(index(Austria_exports_xts["2015/"]))) {
  Austria_sum_export[i]<-sum(as.numeric(Austria_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Austria_sum_export<-as.xts(t(Austria_sum_export), order.by = Date)
colnames(Austria_sum_export)<-c("Austria")







#Australia
Australia_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Australia") %>% select(-Countries.and.Territories))
colnames(Australia_exports) <-Australia_exports[1,]
Australia_exports<-Australia_exports[-c(1),]

Australia_exports_xts <- (as.xts(Australia_exports, order.by=Date))
Australia_exports_xts_num<-as.numeric(Australia_exports_xts["2015/"],na.rm = TRUE)
Australia_sum_export<-data.frame(NA, nrow=length(index(Australia_exports_xts["2015/"])))

for (i in 1:length(index(Australia_exports_xts["2015/"]))) {
  Australia_sum_export[i]<-sum(as.numeric(Australia_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Australia_sum_export<-as.xts(t(Australia_sum_export), order.by = Date)
colnames(Australia_sum_export)<-c("Australia")



#Belgium
Belgium_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Belgium") %>% select(-Countries.and.Territories))
colnames(Belgium_exports) <-Belgium_exports[1,]
Belgium_exports<-Belgium_exports[-c(1),]

Belgium_exports_xts <- (as.xts(Belgium_exports, order.by=Date))
Belgium_exports_xts_num<-as.numeric(Belgium_exports_xts["2015/"],na.rm = TRUE)
Belgium_sum_export<-data.frame(NA, nrow=length(index(Belgium_exports_xts["2015/"])))

for (i in 1:length(index(Belgium_exports_xts["2015/"]))) {
  Belgium_sum_export[i]<-sum(as.numeric(Belgium_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Belgium_sum_export<-as.xts(t(Belgium_sum_export), order.by = Date)
colnames(Belgium_sum_export)<-c("Belgium")

#Bulgaria
Bulgaria_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Bulgaria") %>% select(-Countries.and.Territories))
colnames(Bulgaria_exports) <-Bulgaria_exports[1,]
Bulgaria_exports<-Bulgaria_exports[-c(1),]

Bulgaria_exports_xts <- (as.xts(Bulgaria_exports, order.by=Date))
Bulgaria_exports_xts_num<-as.numeric(Bulgaria_exports_xts["2015/"],na.rm = TRUE)
Bulgaria_sum_export<-data.frame(NA, nrow=length(index(Bulgaria_exports_xts["2015/"])))

for (i in 1:length(index(Bulgaria_exports_xts["2015/"]))) {
  Bulgaria_sum_export[i]<-sum(as.numeric(Bulgaria_exports_xts[i,,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Bulgaria_sum_export<-as.xts(t(Bulgaria_sum_export), order.by = Date)
colnames(Bulgaria_sum_export)<-c("Bulgaria")


#Brazil 
Brazil_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Brazil") %>% select(-Countries.and.Territories))
colnames(Brazil_exports) <-Brazil_exports[1,]
Brazil_exports<-Brazil_exports[-c(1),]

Brazil_exports_xts <- (as.xts(Brazil_exports, order.by=Date))
Brazil_exports_xts_num<-as.numeric(Brazil_exports_xts["2015/"],na.rm = TRUE)
Brazil_sum_export<-data.frame(NA, nrow=length(index(Brazil_exports_xts["2015/"])))

for (i in 1:length(index(Brazil_exports_xts["2015/"]))) {
  Brazil_sum_export[i]<-sum(as.numeric(Brazil_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Brazil_sum_export<-as.xts(t(Brazil_sum_export), order.by = Date)
colnames(Brazil_sum_export)<-c("Brazil")

#Canada 
Canada_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Canada") %>% select(-Countries.and.Territories))
colnames(Canada_exports) <-Canada_exports[1,]
Canada_exports<-Canada_exports[-c(1),]

Canada_exports_xts <- (as.xts(Canada_exports, order.by=Date))
Canada_exports_xts_num<-as.numeric(Canada_exports_xts["2015/"],na.rm = TRUE)
Canada_sum_export<-data.frame(NA, nrow=length(index(Canada_exports_xts["2015/"])))

for (i in 1:length(index(Canada_exports_xts["2015/"]))) {
  Canada_sum_export[i]<-sum(as.numeric(Canada_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Canada_sum_export<-as.xts(t(Canada_sum_export), order.by = Date)
colnames(Canada_sum_export)<-c("Canada")



#Switzerland 
Switzerland_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Switzerland") %>% select(-Countries.and.Territories))
colnames(Switzerland_exports) <-Switzerland_exports[1,]
Switzerland_exports<-Switzerland_exports[-c(1),]


Switzerland_exports_xts <- (as.xts(Switzerland_exports, order.by=Date))
Switzerland_exports_xts_num<-as.numeric(Switzerland_exports_xts["2015/"],na.rm = TRUE)
Switzerland_sum_export<-data.frame(NA, nrow=length(index(Switzerland_exports_xts["2015/"])))

for (i in 1:length(index(Switzerland_exports_xts["2015/"]))) {
  Switzerland_sum_export[i]<-sum(as.numeric(Switzerland_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Switzerland_sum_export<-as.xts(t(Switzerland_sum_export), order.by = Date)
colnames(Switzerland_sum_export)<-c("Switzerland")

#China 
China_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="China") %>% select(-Countries.and.Territories))
colnames(China_exports) <-China_exports[1,]
China_exports<-China_exports[-c(1),]

China_exports_xts <- (as.xts(China_exports, order.by=Date))
China_exports_xts_num<-as.numeric(China_exports_xts["2015/"],na.rm = TRUE)
China_sum_export<-data.frame(NA, nrow=length(index(China_exports_xts["2015/"])))

for (i in 1:length(index(China_exports_xts["2015/"]))) {
  China_sum_export[i]<-sum(as.numeric(China_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

China_sum_export<-as.xts(t(China_sum_export), order.by = Date)
colnames(China_sum_export)<-c("China")


China_breakdown_exports<-as.xts(China_exports_xts)

China_breakdown_exports1<-100*((as.numeric(China_exports_xts))/as.numeric(China_sum_export$China))

#Cyprus 
Cyprus_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Cyprus") %>% select(-Countries.and.Territories))
colnames(Cyprus_exports) <-Cyprus_exports[1,]
Cyprus_exports<-Cyprus_exports[-c(1),]

Cyprus_exports_xts <- (as.xts(Cyprus_exports, order.by=Date))
Cyprus_exports_xts_num<-as.numeric(Cyprus_exports_xts["2015/"],na.rm = TRUE)
Cyprus_sum_export<-data.frame(NA, nrow=length(index(Cyprus_exports_xts["2015/"])))

for (i in 1:length(index(Cyprus_exports_xts["2015/"]))) {
  Cyprus_sum_export[i]<-sum(as.numeric(Cyprus_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Cyprus_sum_export<-as.xts(t(Cyprus_sum_export), order.by = Date)
colnames(Cyprus_sum_export)<-c("Cyprus")


#Czech Republic
Czech_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Czech Republic") %>% select(-Countries.and.Territories))
colnames(Czech_exports) <-Czech_exports[1,]
Czech_exports<-Czech_exports[-c(1),]

Czech_exports_xts <- (as.xts(Czech_exports, order.by=Date))
Czech_exports_xts_num<-as.numeric(Czech_exports_xts["2015/"],na.rm = TRUE)
Czech_sum_export<-data.frame(NA, nrow=length(index(Czech_exports_xts["2015/"])))

for (i in 1:length(index(Czech_exports_xts["2015/"]))) {
  Czech_sum_export[i]<-sum(as.numeric(Czech_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Czech_sum_export<-as.xts(t(Czech_sum_export), order.by = Date)
colnames(Czech_sum_export)<-c("Czech")


#Germany
Germany_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Germany") %>% select(-Countries.and.Territories))
colnames(Germany_exports) <-Germany_exports[1,]
Germany_exports<-Germany_exports[-c(1),]

Germany_exports_xts <- (as.xts(Germany_exports, order.by=Date))
Germany_exports_xts_num<-as.numeric(Germany_exports_xts["2015/"],na.rm = TRUE)
Germany_sum_export<-data.frame(NA, nrow=length(index(Germany_exports_xts["2015/"])))

for (i in 1:length(index(Germany_exports_xts["2015/"]))) {
  Germany_sum_export[i]<-sum(as.numeric(Germany_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Germany_sum_export<-as.xts(t(Germany_sum_export), order.by = Date)
colnames(Germany_sum_export)<-c("Germany")



#Denmark 
Denmark_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Denmark") %>% select(-Countries.and.Territories))
colnames(Denmark_exports) <-Denmark_exports[1,]
Denmark_exports<-Denmark_exports[-c(1),]

Denmark_exports_xts <- (as.xts(Denmark_exports, order.by=Date))
Denmark_exports_xts_num<-as.numeric(Denmark_exports_xts["2015/"],na.rm = TRUE)
Denmark_sum_export<-data.frame(NA, nrow=length(index(Denmark_exports_xts["2015/"])))

for (i in 1:length(index(Denmark_exports_xts["2015/"]))) {
  Denmark_sum_export[i]<-sum(as.numeric(Denmark_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Denmark_sum_export<-as.xts(t(Denmark_sum_export), order.by = Date)
colnames(Denmark_sum_export)<-c("Denmark")


#Estonia 
Estonia_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Estonia") %>% select(-Countries.and.Territories))
colnames(Estonia_exports) <-Estonia_exports[1,]
Estonia_exports<-Estonia_exports[-c(1),]

Estonia_exports_xts <- (as.xts(Estonia_exports, order.by=Date))
Estonia_exports_xts_num<-as.numeric(Estonia_exports_xts["2015/"],na.rm = TRUE)
Estonia_sum_export<-data.frame(NA, nrow=length(index(Estonia_exports_xts["2015/"])))

for (i in 1:length(index(Estonia_exports_xts["2015/"]))) {
  Estonia_sum_export[i]<-sum(as.numeric(Estonia_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Estonia_sum_export<-as.xts(t(Estonia_sum_export), order.by = Date)
colnames(Estonia_sum_export)<-c("Estonia")

#Spain 
Spain_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Spain") %>% select(-Countries.and.Territories))
colnames(Spain_exports) <-Spain_exports[1,]
Spain_exports<-Spain_exports[-c(1),]

Spain_exports_xts <- (as.xts(Spain_exports, order.by=Date))
Spain_exports_xts_num<-as.numeric(Spain_exports_xts["2015/"],na.rm = TRUE)
Spain_sum_export<-data.frame(NA, nrow=length(index(Spain_exports_xts["2015/"])))

for (i in 1:length(index(Spain_exports_xts["2015/"]))) {
  Spain_sum_export[i]<-sum(as.numeric(Spain_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Spain_sum_export<-as.xts(t(Spain_sum_export), order.by = Date)
colnames(Spain_sum_export)<-c("Spain")



#Finland 
Finland_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Finland") %>% select(-Countries.and.Territories))
colnames(Finland_exports) <-Finland_exports[1,]
Finland_exports<-Finland_exports[-c(1),]

Finland_exports_xts <- (as.xts(Finland_exports, order.by=Date))
Finland_exports_xts_num<-as.numeric(Finland_exports_xts["2015/"],na.rm = TRUE)
Finland_sum_export<-data.frame(NA, nrow=length(index(Finland_exports_xts["2015/"])))

for (i in 1:length(index(Finland_exports_xts["2015/"]))) {
  Finland_sum_export[i]<-sum(as.numeric(Finland_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Finland_sum_export<-as.xts(t(Finland_sum_export), order.by = Date)
colnames(Finland_sum_export)<-c("Finland")



#France
France_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="France") %>% select(-Countries.and.Territories))
colnames(France_exports) <-France_exports[1,]
France_exports<-France_exports[-c(1),]

France_exports_xts <- (as.xts(France_exports, order.by=Date))
France_exports_xts_num<-as.numeric(France_exports_xts["2015/"],na.rm = TRUE)
France_sum_export<-data.frame(NA, nrow=length(index(France_exports_xts["2015/"])))

for (i in 1:length(index(France_exports_xts["2015/"]))) {
  France_sum_export[i]<-sum(as.numeric(France_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

France_sum_export<-as.xts(t(France_sum_export), order.by = Date)
colnames(France_sum_export)<-c("France")


#Greece
Greece_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Greece") %>% select(-Countries.and.Territories))
colnames(Greece_exports) <-Greece_exports[1,]
Greece_exports<-Greece_exports[-c(1),]

Greece_exports_xts <- (as.xts(Greece_exports, order.by=Date))
Greece_exports_xts_num<-as.numeric(Greece_exports_xts["2015/"],na.rm = TRUE)
Greece_sum_export<-data.frame(NA, nrow=length(index(Greece_exports_xts["2015/"])))

for (i in 1:length(index(Greece_exports_xts["2015/"]))) {
  Greece_sum_export[i]<-sum(as.numeric(Greece_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Greece_sum_export<-as.xts(t(Greece_sum_export), order.by = Date)
colnames(Greece_sum_export)<-c("Greece")


##Croatia
Croatia_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Croatia") %>% select(-Countries.and.Territories))
colnames(Croatia_exports) <-Croatia_exports[1,]
Croatia_exports<-Croatia_exports[-c(1),]

Croatia_exports_xts <- (as.xts(Croatia_exports, order.by=Date))
Croatia_exports_xts_num<-as.numeric(Croatia_exports_xts["2015/"],na.rm = TRUE)
Croatia_sum_export<-data.frame(NA, nrow=length(index(Croatia_exports_xts["2015/"])))

for (i in 1:length(index(Croatia_exports_xts["2015/"]))) {
  Croatia_sum_export[i]<-sum(as.numeric(Croatia_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Croatia_sum_export<-as.xts(t(Croatia_sum_export), order.by = Date)
colnames(Croatia_sum_export)<-c("Croatia")



#Hungary
Hungary_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Hungary") %>% select(-Countries.and.Territories))
colnames(Hungary_exports) <-Hungary_exports[1,]
Hungary_exports<-Hungary_exports[-c(1),]

Hungary_exports_xts <- (as.xts(Hungary_exports, order.by=Date))
Hungary_exports_xts_num<-as.numeric(Hungary_exports_xts["2015/"],na.rm = TRUE)
Hungary_sum_export<-data.frame(NA, nrow=length(index(Hungary_exports_xts["2015/"])))

for (i in 1:length(index(Hungary_exports_xts["2015/"]))) {
  Hungary_sum_export[i]<-sum(as.numeric(Hungary_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Hungary_sum_export<-as.xts(t(Hungary_sum_export), order.by = Date)
colnames(Hungary_sum_export)<-c("Hungary")

#India
India_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="India") %>% select(-Countries.and.Territories))
colnames(India_exports) <-India_exports[1,]
India_exports<-India_exports[-c(1),]

India_exports_xts <- (as.xts(India_exports, order.by=Date))
India_exports_xts_num<-as.numeric(India_exports_xts["2015/"],na.rm = TRUE)
India_sum_export<-data.frame(NA, nrow=length(index(India_exports_xts["2015/"])))

for (i in 1:length(index(India_exports_xts["2015/"]))) {
  India_sum_export[i]<-sum(as.numeric(India_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

India_sum_export<-as.xts(t(India_sum_export), order.by = Date)
colnames(India_sum_export)<-c("India")

#Italy
Italy_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Italy") %>% select(-Countries.and.Territories))
colnames(Italy_exports) <-Italy_exports[1,]
Italy_exports<-Italy_exports[-c(1),]

Italy_exports_xts <- (as.xts(Italy_exports, order.by=Date))
Italy_exports_xts_num<-as.numeric(Italy_exports_xts["2015/"],na.rm = TRUE)
Italy_sum_export<-data.frame(NA, nrow=length(index(Italy_exports_xts["2015/"])))

for (i in 1:length(index(Italy_exports_xts["2015/"]))) {
  Italy_sum_export[i]<-sum(as.numeric(Italy_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Italy_sum_export<-as.xts(t(Italy_sum_export), order.by = Date)
colnames(Italy_sum_export)<-c("Italy")

#Japan

Japan_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Japan") %>% select(-Countries.and.Territories))
colnames(Japan_exports) <-Japan_exports[1,]
Japan_exports<-Japan_exports[-c(1),]

Japan_exports_xts <- (as.xts(Japan_exports, order.by=Date))
Japan_exports_xts_num<-as.numeric(Japan_exports_xts["2015/"],na.rm = TRUE)
Japan_sum_export<-data.frame(NA, nrow=length(index(Japan_exports_xts["2015/"])))

for (i in 1:length(index(Japan_exports_xts["2015/"]))) {
  Japan_sum_export[i]<-sum(as.numeric(Japan_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Japan_sum_export<-as.xts(t(Japan_sum_export), order.by = Date)
colnames(Japan_sum_export)<-c("Japan")


#South Korea
Korea_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="South Korea") %>% select(-Countries.and.Territories))
colnames(Korea_exports) <-Korea_exports[1,]
Korea_exports<-Korea_exports[-c(1),]

Korea_exports_xts <- (as.xts(Korea_exports, order.by=Date))
Korea_exports_xts_num<-as.numeric(Korea_exports_xts["2015/"],na.rm = TRUE)
Korea_sum_export<-data.frame(NA, nrow=length(index(Korea_exports_xts["2015/"])))

for (i in 1:length(index(Korea_exports_xts["2015/"]))) {
  Korea_sum_export[i]<-sum(as.numeric(Korea_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Korea_sum_export<-as.xts(t(Korea_sum_export), order.by = Date)
colnames(Korea_sum_export)<-c("Korea")




#Lithuania
Lithuania_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Lithuania") %>% select(-Countries.and.Territories))
colnames(Lithuania_exports) <-Lithuania_exports[1,]
Lithuania_exports<-Lithuania_exports[-c(1),]

Lithuania_exports_xts <- (as.xts(Lithuania_exports, order.by=Date))
Lithuania_exports_xts_num<-as.numeric(Lithuania_exports_xts["2015/"],na.rm = TRUE)
Lithuania_sum_export<-data.frame(NA, nrow=length(index(Lithuania_exports_xts["2015/"])))

for (i in 1:length(index(Lithuania_exports_xts["2015/"]))) {
  Lithuania_sum_export[i]<-sum(as.numeric(Lithuania_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Lithuania_sum_export<-as.xts(t(Lithuania_sum_export), order.by = Date)
colnames(Lithuania_sum_export)<-c("Lithuania")



#Luxembourg 
Luxembourg_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Luxembourg") %>% select(-Countries.and.Territories))
colnames(Luxembourg_exports) <-Luxembourg_exports[1,]
Luxembourg_exports<-Luxembourg_exports[-c(1),]

Luxembourg_exports_xts <- (as.xts(Luxembourg_exports, order.by=Date))
Luxembourg_exports_xts_num<-as.numeric(Luxembourg_exports_xts["2015/"],na.rm = TRUE)
Luxembourg_sum_export<-data.frame(NA, nrow=length(index(Luxembourg_exports_xts["2015/"])))

for (i in 1:length(index(Luxembourg_exports_xts["2015/"]))) {
  Luxembourg_sum_export[i]<-sum(as.numeric(Luxembourg_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Luxembourg_sum_export<-as.xts(t(Luxembourg_sum_export), order.by = Date)
colnames(Luxembourg_sum_export)<-c("Luxembourg")

#Latvia 
Latvia_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Latvia") %>% select(-Countries.and.Territories))
colnames(Latvia_exports) <-Latvia_exports[1,]
Latvia_exports<-Latvia_exports[-c(1),]

Latvia_exports_xts <- (as.xts(Latvia_exports, order.by=Date))
Latvia_exports_xts_num<-as.numeric(Latvia_exports_xts["2015/"],na.rm = TRUE)
Latvia_sum_export<-data.frame(NA, nrow=length(index(Latvia_exports_xts["2015/"])))

for (i in 1:length(index(Latvia_exports_xts["2015/"]))) {
  Latvia_sum_export[i]<-sum(as.numeric(Latvia_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Latvia_sum_export<-as.xts(t(Latvia_sum_export), order.by = Date)
colnames(Latvia_sum_export)<-c("Latvia")



#Malta 
Malta_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Malta") %>% select(-Countries.and.Territories))
colnames(Malta_exports) <-Malta_exports[1,]
Malta_exports<-Malta_exports[-c(1),]

Malta_exports_xts <- (as.xts(Malta_exports, order.by=Date))
Malta_exports_xts_num<-as.numeric(Malta_exports_xts["2015/"],na.rm = TRUE)
Malta_sum_export<-data.frame(NA, nrow=length(index(Malta_exports_xts["2015/"])))

for (i in 1:length(index(Malta_exports_xts["2015/"]))) {
  Malta_sum_export[i]<-sum(as.numeric(Malta_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Malta_sum_export<-as.xts(t(Malta_sum_export), order.by = Date)
colnames(Malta_sum_export)<-c("Malta")




#Mexico 
Mexico_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Mexico") %>% select(-Countries.and.Territories))
colnames(Mexico_exports) <-Mexico_exports[1,]
Mexico_exports<-Mexico_exports[-c(1),]

Mexico_exports_xts <- (as.xts(Mexico_exports, order.by=Date))
Mexico_exports_xts_num<-as.numeric(Mexico_exports_xts["2015/"],na.rm = TRUE)
Mexico_sum_export<-data.frame(NA, nrow=length(index(Mexico_exports_xts["2015/"])))

for (i in 1:length(index(Mexico_exports_xts["2015/"]))) {
  Mexico_sum_export[i]<-sum(as.numeric(Mexico_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Mexico_sum_export<-as.xts(t(Mexico_sum_export), order.by = Date)
colnames(Mexico_sum_export)<-c("Mexico")



#Malaysia 
Malaysia_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Malaysia") %>% select(-Countries.and.Territories))
colnames(Malaysia_exports) <-Malaysia_exports[1,]
Malaysia_exports<-Malaysia_exports[-c(1),]

Malaysia_exports_xts <- (as.xts(Malaysia_exports, order.by=Date))
Malaysia_exports_xts_num<-as.numeric(Malaysia_exports_xts["2015/"],na.rm = TRUE)
Malaysia_sum_export<-data.frame(NA, nrow=length(index(Malaysia_exports_xts["2015/"])))

for (i in 1:length(index(Malaysia_exports_xts["2015/"]))) {
  Malaysia_sum_export[i]<-sum(as.numeric(Malaysia_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Malaysia_sum_export<-as.xts(t(Malaysia_sum_export), order.by = Date)
colnames(Malaysia_sum_export)<-c("Malaysia")


#Netherlands 
Netherlands_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Netherlands") %>% select(-Countries.and.Territories))
colnames(Netherlands_exports) <-Netherlands_exports[1,]
Netherlands_exports<-Netherlands_exports[-c(1),]

Netherlands_exports_xts <- (as.xts(Netherlands_exports, order.by=Date))
Netherlands_exports_xts_num<-as.numeric(Netherlands_exports_xts["2015/"],na.rm = TRUE)
Netherlands_sum_export<-data.frame(NA, nrow=length(index(Netherlands_exports_xts["2015/"])))

for (i in 1:length(index(Netherlands_exports_xts["2015/"]))) {
  Netherlands_sum_export[i]<-sum(as.numeric(Netherlands_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Netherlands_sum_export<-as.xts(t(Netherlands_sum_export), order.by = Date)
colnames(Netherlands_sum_export)<-c("Netherlands")



#Norway  
Norway_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Norway") %>% select(-Countries.and.Territories))
colnames(Norway_exports) <-Norway_exports[1,]
Norway_exports<-Norway_exports[-c(1),]

Norway_exports_xts <- (as.xts(Norway_exports, order.by=Date))
Norway_exports_xts_num<-as.numeric(Norway_exports_xts["2015/"],na.rm = TRUE)
Norway_sum_export<-data.frame(NA, nrow=length(index(Norway_exports_xts["2015/"])))

for (i in 1:length(index(Norway_exports_xts["2015/"]))) {
  Norway_sum_export[i]<-sum(as.numeric(Norway_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Norway_sum_export<-as.xts(t(Norway_sum_export), order.by = Date)
colnames(Norway_sum_export)<-c("Norway")




#Poland  
Poland_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Poland") %>% select(-Countries.and.Territories))
colnames(Poland_exports) <-Poland_exports[1,]
Poland_exports<-Poland_exports[-c(1),]

Poland_exports_xts <- (as.xts(Poland_exports, order.by=Date))
Poland_exports_xts_num<-as.numeric(Poland_exports_xts["2015/"],na.rm = TRUE)
Poland_sum_export<-data.frame(NA, nrow=length(index(Poland_exports_xts["2015/"])))

for (i in 1:length(index(Poland_exports_xts["2015/"]))) {
  Poland_sum_export[i]<-sum(as.numeric(Poland_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Poland_sum_export<-as.xts(t(Poland_sum_export), order.by = Date)
colnames(Poland_sum_export)<-c("Poland")



#Portugal  
Portugal_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Portugal") %>% select(-Countries.and.Territories))
colnames(Portugal_exports) <-Portugal_exports[1,]
Portugal_exports<-Portugal_exports[-c(1),]

Portugal_exports_xts <- (as.xts(Portugal_exports, order.by=Date))
Portugal_exports_xts_num<-as.numeric(Portugal_exports_xts["2015/"],na.rm = TRUE)
Portugal_sum_export<-data.frame(NA, nrow=length(index(Portugal_exports_xts["2015/"])))

for (i in 1:length(index(Portugal_exports_xts["2015/"]))) {
  Portugal_sum_export[i]<-sum(as.numeric(Portugal_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Portugal_sum_export<-as.xts(t(Portugal_sum_export), order.by = Date)
colnames(Portugal_sum_export)<-c("Portugal")




#Romania  
Romania_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Romania") %>% select(-Countries.and.Territories))
colnames(Romania_exports) <-Romania_exports[1,]
Romania_exports<-Romania_exports[-c(1),]

Romania_exports_xts <- (as.xts(Romania_exports, order.by=Date))
Romania_exports_xts_num<-as.numeric(Romania_exports_xts["2015/"],na.rm = TRUE)
Romania_sum_export<-data.frame(NA, nrow=length(index(Romania_exports_xts["2015/"])))

for (i in 1:length(index(Romania_exports_xts["2015/"]))) {
  Romania_sum_export[i]<-sum(as.numeric(Romania_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Romania_sum_export<-as.xts(t(Romania_sum_export), order.by = Date)
colnames(Romania_sum_export)<-c("Romania")

#Russia  
Russia_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Russia") %>% select(-Countries.and.Territories))
colnames(Russia_exports) <-Russia_exports[1,]
Russia_exports<-Russia_exports[-c(1),]


Russia_exports_xts <- (as.xts(Russia_exports, order.by=Date))
Russia_exports_xts_num<-as.numeric(Russia_exports_xts["2015/"],na.rm = TRUE)
Russia_sum_export<-data.frame(NA, nrow=length(index(Russia_exports_xts["2015/"])))

for (i in 1:length(index(Russia_exports_xts["2015/"]))) {
  Russia_sum_export[i]<-sum(as.numeric(Russia_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Russia_sum_export<-as.xts(t(Russia_sum_export), order.by = Date)
colnames(Russia_sum_export)<-c("Russia")


#Saudi Arabia  
Saudi_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Saudi Arabia") %>% select(-Countries.and.Territories))
colnames(Saudi_exports) <-Saudi_exports[1,]
Saudi_exports<-Saudi_exports[-c(1),]

Saudi_exports_xts <- (as.xts(Saudi_exports, order.by=Date))
Saudi_exports_xts_num<-as.numeric(Saudi_exports_xts["2015/"],na.rm = TRUE)
Saudi_sum_export<-data.frame(NA, nrow=length(index(Saudi_exports_xts["2015/"])))

for (i in 1:length(index(Saudi_exports_xts["2015/"]))) {
  Saudi_sum_export[i]<-sum(as.numeric(Saudi_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Saudi_sum_export<-as.xts(t(Saudi_sum_export), order.by = Date)
colnames(Saudi_sum_export)<-c("Saudi")



#Sweden  
Sweden_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Sweden") %>% select(-Countries.and.Territories))
colnames(Sweden_exports) <-Sweden_exports[1,]
Sweden_exports<-Sweden_exports[-c(1),]

Sweden_exports_xts <- (as.xts(Sweden_exports, order.by=Date))
Sweden_exports_xts_num<-as.numeric(Sweden_exports_xts["2015/"],na.rm = TRUE)
Sweden_sum_export<-data.frame(NA, nrow=length(index(Sweden_exports_xts["2015/"])))

for (i in 1:length(index(Sweden_exports_xts["2015/"]))) {
  Sweden_sum_export[i]<-sum(as.numeric(Sweden_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Sweden_sum_export<-as.xts(t(Sweden_sum_export), order.by = Date)
colnames(Sweden_sum_export)<-c("Sweden")


#Singapore  
Singapore_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Singapore") %>% select(-Countries.and.Territories))
colnames(Singapore_exports) <-Singapore_exports[1,]
Singapore_exports<-Singapore_exports[-c(1),]

Singapore_exports_xts <- (as.xts(Singapore_exports, order.by=Date))
Singapore_exports_xts_num<-as.numeric(Singapore_exports_xts["2015/"],na.rm = TRUE)
Singapore_sum_export<-data.frame(NA, nrow=length(index(Singapore_exports_xts["2015/"])))

for (i in 1:length(index(Singapore_exports_xts["2015/"]))) {
  Singapore_sum_export[i]<-sum(as.numeric(Singapore_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Singapore_sum_export<-as.xts(t(Singapore_sum_export), order.by = Date)
colnames(Singapore_sum_export)<-c("Singapore")



#Slovenia  
Slovenia_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Slovenia") %>% select(-Countries.and.Territories))
colnames(Slovenia_exports) <-Slovenia_exports[1,]
Slovenia_exports<-Slovenia_exports[-c(1),]

Slovenia_exports_xts <- (as.xts(Slovenia_exports, order.by=Date))
Slovenia_exports_xts_num<-as.numeric(Slovenia_exports_xts["2015/"],na.rm = TRUE)
Slovenia_sum_export<-data.frame(NA, nrow=length(index(Slovenia_exports_xts["2015/"])))

for (i in 1:length(index(Slovenia_exports_xts["2015/"]))) {
  Slovenia_sum_export[i]<-sum(as.numeric(Slovenia_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Slovenia_sum_export<-as.xts(t(Slovenia_sum_export), order.by = Date)
colnames(Slovenia_sum_export)<-c("Slovenia")



#Slovakia  
Slovakia_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Slovakia") %>% select(-Countries.and.Territories))
colnames(Slovakia_exports) <-Slovakia_exports[1,]
Slovakia_exports<-Slovakia_exports[-c(1),]

Slovakia_exports_xts <- (as.xts(Slovakia_exports, order.by=Date))
Slovakia_exports_xts_num<-as.numeric(Slovakia_exports_xts["2015/"],na.rm = TRUE)
Slovakia_sum_export<-data.frame(NA, nrow=length(index(Slovakia_exports_xts["2015/"])))

for (i in 1:length(index(Slovakia_exports_xts["2015/"]))) {
  Slovakia_sum_export[i]<-sum(as.numeric(Slovakia_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Slovakia_sum_export<-as.xts(t(Slovakia_sum_export), order.by = Date)
colnames(Slovakia_sum_export)<-c("Slovakia")


#Thailand  
Thailand_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Thailand") %>% select(-Countries.and.Territories))
colnames(Thailand_exports) <-Thailand_exports[1,]
Thailand_exports<-Thailand_exports[-c(1),]


Thailand_exports_xts <- (as.xts(Thailand_exports, order.by=Date))
Thailand_exports_xts_num<-as.numeric(Thailand_exports_xts["2015/"],na.rm = TRUE)
Thailand_sum_export<-data.frame(NA, nrow=length(index(Thailand_exports_xts["2015/"])))

for (i in 1:length(index(Thailand_exports_xts["2015/"]))) {
  Thailand_sum_export[i]<-sum(as.numeric(Thailand_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Thailand_sum_export<-as.xts(t(Thailand_sum_export), order.by = Date)
colnames(Thailand_sum_export)<-c("Thailand")


#Turkey  
Turkey_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Turkey") %>% select(-Countries.and.Territories))
colnames(Turkey_exports) <-Turkey_exports[1,]
Turkey_exports<-Turkey_exports[-c(1),]

Turkey_exports_xts <- (as.xts(Turkey_exports, order.by=Date))
Turkey_exports_xts_num<-as.numeric(Turkey_exports_xts["2015/"],na.rm = TRUE)
Turkey_sum_export<-data.frame(NA, nrow=length(index(Turkey_exports_xts["2015/"])))

for (i in 1:length(index(Turkey_exports_xts["2015/"]))) {
  Turkey_sum_export[i]<-sum(as.numeric(Turkey_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Turkey_sum_export<-as.xts(t(Turkey_sum_export), order.by = Date)
colnames(Turkey_sum_export)<-c("Turkey")


#Taiwan  
Taiwan_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Taiwan") %>% select(-Countries.and.Territories))
colnames(Taiwan_exports) <-Taiwan_exports[1,]
Taiwan_exports<-Taiwan_exports[-c(1),]

Taiwan_exports_xts <- (as.xts(Taiwan_exports, order.by=Date))
Taiwan_exports_xts_num<-as.numeric(Taiwan_exports_xts["2015/"],na.rm = TRUE)
Taiwan_sum_export<-data.frame(NA, nrow=length(index(Taiwan_exports_xts["2015/"])))

for (i in 1:length(index(Taiwan_exports_xts["2015/"]))) {
  Taiwan_sum_export[i]<-sum(as.numeric(Taiwan_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

Taiwan_sum_export<-as.xts(t(Taiwan_sum_export), order.by = Date)
colnames(Taiwan_sum_export)<-c("Taiwan")


#USA  
USA_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="USA") %>% select(-Countries.and.Territories))
colnames(USA_exports) <-USA_exports[1,]
USA_exports<-USA_exports[-c(1),]
USA_exports_xts <- (as.xts(USA_exports, order.by=Date))
USA_exports_xts_num<-as.numeric(USA_exports_xts["2015/"],na.rm = TRUE) 


USA_sum_export<-data.frame(NA, length(index(USA_exports_xts["2015/"])))

for (i in 1:length(index(USA_exports_xts["2015/"]))) {
  USA_sum_export[i]<-sum(as.numeric(USA_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

USA_sum_export<-as.xts(t(USA_sum_export), order.by = Date)
colnames(USA_sum_export)<-c("USA")


#Great Britian  
GB_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Great Britain") %>% select(-Countries.and.Territories))
colnames(GB_exports) <-GB_exports[1,]
GB_exports<-GB_exports[-c(1),]

GB_exports_xts <- (as.xts(GB_exports, order.by=Date))
GB_exports_xts_num<-as.numeric(GB_exports_xts["2015/"],na.rm = TRUE)
GB_sum_export<-data.frame(NA, nrow=length(index(GB_exports_xts["2015/"])))

for (i in 1:length(index(GB_exports_xts["2015/"]))) {
  GB_sum_export[i]<-sum(as.numeric(GB_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

GB_sum_export<-as.xts(t(GB_sum_export), order.by = Date)
colnames(GB_sum_export)<-c("GB")



#Northern Ireland 
NI_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Northern Ireland") %>% select(-Countries.and.Territories))
colnames(NI_exports) <-NI_exports[1,]
NI_exports<-NI_exports[-c(1),]

NI_exports_xts <- (as.xts(NI_exports, order.by=Date))
NI_exports_xts_num<-as.numeric(NI_exports_xts["2015/"],na.rm = TRUE)
NI_sum_export<-data.frame(NA, nrow=length(index(NI_exports_xts["2015/"])))

for (i in 1:length(index(NI_exports_xts["2015/"]))) {
  NI_sum_export[i]<-sum(as.numeric(NI_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

NI_sum_export<-as.xts(t(NI_sum_export), order.by = Date)
colnames(NI_sum_export)<-c("NI")



#South Africa 
SA_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="South Africa") %>% select(-Countries.and.Territories))
colnames(SA_exports) <-SA_exports[1,]
SA_exports<-SA_exports[-c(1),]

SA_exports_xts <- (as.xts(SA_exports, order.by=Date))
SA_exports_xts_num<-as.numeric(SA_exports_xts["2015/"],na.rm = TRUE)
SA_sum_export<-data.frame(NA, nrow=length(index(SA_exports_xts["2015/"])))

for (i in 1:length(index(SA_exports_xts["2015/"]))) {
  SA_sum_export[i]<-sum(as.numeric(SA_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

SA_sum_export<-as.xts(t(SA_sum_export), order.by = Date)
colnames(SA_sum_export)<-c("SA")

#EU country not specified 
OTHER_EU_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="EU country not specified") %>% select(-Countries.and.Territories))
colnames(OTHER_EU_exports) <-OTHER_EU_exports[1,]
OTHER_EU_exports<-OTHER_EU_exports[-c(1),]

OTHER_EU_exports_xts <- (as.xts(OTHER_EU_exports, order.by=Date))
OTHER_EU_exports_xts_num<-as.numeric(OTHER_EU_exports_xts["2015/"],na.rm = TRUE)
OTHER_EU_sum_export<-data.frame(NA, nrow=length(index(OTHER_EU_exports_xts["2015/"])))

for (i in 1:length(index(OTHER_EU_exports_xts["2015/"]))) {
  OTHER_EU_sum_export[i]<-sum(as.numeric(OTHER_EU_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

OTHER_EU_sum_export<-as.xts(t(OTHER_EU_sum_export), order.by = Date)
colnames(OTHER_EU_sum_export)<-c("OTHER_EU")

#OTHER 
OTHER_exports<- t(subset(Ireland_exports,Ireland_Exports["2014-12-01"]=="Other countries") %>% select(-Countries.and.Territories))
colnames(OTHER_exports) <-OTHER_exports[1,]
OTHER_exports<-OTHER_exports[-c(1),]

OTHER_exports_xts <- (as.xts(OTHER_exports, order.by=Date))
OTHER_exports_xts_num<-as.numeric(OTHER_exports_xts["2015/"],na.rm = TRUE)
OTHER_sum_export<-data.frame(NA, nrow=length(index(OTHER_exports_xts["2015/"])))

for (i in 1:length(index(OTHER_exports_xts["2015/"]))) {
  OTHER_sum_export[i]<-sum(as.numeric(OTHER_exports_xts[i,2:ncol(Austria_exports_xts)]),na.rm = TRUE)
}

OTHER_sum_export<-as.xts(t(OTHER_sum_export), order.by = Date)
colnames(OTHER_sum_export)<-c("OTHER")








Export_Country<-merge(Austria_sum_export,Australia_sum_export,Belgium_sum_export,Bulgaria_sum_export,Brazil_sum_export,Canada_sum_export,Switzerland_sum_export,China_sum_export,Cyprus_sum_export,Czech_sum_export,Germany_sum_export,Denmark_sum_export,Estonia_sum_export,Spain_sum_export,Finland_sum_export,France_sum_export,Greece_sum_export,Croatia_sum_export,Hungary_sum_export,India_sum_export,Italy_sum_export,Japan_sum_export,Korea_sum_export,Lithuania_sum_export,Luxembourg_sum_export,Latvia_sum_export,Malta_sum_export,Mexico_sum_export,Malaysia_sum_export,Netherlands_sum_export,Norway_sum_export,Poland_sum_export,Portugal_sum_export,Romania_sum_export,Russia_sum_export,Saudi_sum_export,Sweden_sum_export,Singapore_sum_export,Slovenia_sum_export,Slovakia_sum_export,Thailand_sum_export,Turkey_sum_export,Taiwan_sum_export,USA_sum_export,GB_sum_export,NI_sum_export,SA_sum_export,OTHER_EU_sum_export,OTHER_sum_export)
TOTAL_sum_export<-data.frame(NA, nrow=length(index(Export_Country["2015/"])))

for (i in 1:length(index(Export_Country["2015/"]))) {
  TOTAL_sum_export[i]<-sum(as.numeric(Export_Country[i]),na.rm = TRUE)
}


TOTAL_sum_export<-as.xts(t(TOTAL_sum_export), order.by = Date)
colnames(TOTAL_sum_export)<-c("TOTAL")



Total_Export_Country<-(merge(Austria_sum_export,Australia_sum_export,Belgium_sum_export,Bulgaria_sum_export,Brazil_sum_export,Canada_sum_export,Switzerland_sum_export,China_sum_export,Cyprus_sum_export,Czech_sum_export,Germany_sum_export,Denmark_sum_export,Estonia_sum_export,Spain_sum_export,Finland_sum_export,France_sum_export,Greece_sum_export,Croatia_sum_export,Hungary_sum_export,India_sum_export,Italy_sum_export,Japan_sum_export,Korea_sum_export,Lithuania_sum_export,Luxembourg_sum_export,Latvia_sum_export,Malta_sum_export,Mexico_sum_export,Malaysia_sum_export,Netherlands_sum_export,Norway_sum_export,Poland_sum_export,Portugal_sum_export,Romania_sum_export,Russia_sum_export,Saudi_sum_export,Sweden_sum_export,Singapore_sum_export,Slovenia_sum_export,Slovakia_sum_export,Thailand_sum_export,Turkey_sum_export,Taiwan_sum_export,USA_sum_export,GB_sum_export,NI_sum_export,SA_sum_export,OTHER_EU_sum_export,OTHER_sum_export,TOTAL_sum_export))
Total_Share<-data.frame(100*(Total_Export_Country["2015/"])/as.numeric(Total_Export_Country$TOTAL["2015/"]))
Total_Share_xts<-((Total_Export_Country["2015/"])/as.numeric(Total_Export_Country$TOTAL["2015/"]))


Total<-as.numeric(Total_Export_Country$TOTAL["2015/"])


Export_Other<-data.frame(NA, nrow=length(index(Total_Export_Country["2015/"])))

Export_Other<-Total_Export_Country$TOTAL-((Total_Export_Country$USA+Total_Export_Country$Germany+Total_Export_Country$GB+Total_Export_Country$NI))

annual_growth_exports<-growth(Total_Export_Country,freq=12)
annual_growth_exports_Others<-growth(Export_Other,freq=12)

month_growth_exports<-growth(Total_Export_Country,1)
month_growth_exports_Others<-growth(Export_Other,freq=1)

Total_Share_xts<-((Total_Export_Country["2015/"])/as.numeric(Total_Export_Country$TOTAL["2015/"]))




Contribution_annual_growth<-round(annual_growth_exports["2016/"]*(lag.xts(Total_Share_xts["2015/"],k=12)),2)




#Euro Area Agg

EURO_AREA_TOTAL_EXPORTS<-((Austria_sum_export+Belgium_sum_export+Cyprus_sum_export+Estonia_sum_export+Finland_sum_export+France_sum_export+Germany_sum_export+Greece_sum_export+Italy_sum_export+Latvia_sum_export+Lithuania_sum_export+Luxembourg_sum_export+Malta_sum_export+Netherlands_sum_export+Portugal_sum_export+Slovakia_sum_export+Slovenia_sum_export+Spain_sum_export))

EURO_AREA_Growth_Rate<-growth(EURO_AREA_TOTAL_EXPORTS, freq = 12) %>% round(1)


EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH<-Contribution_annual_growth$Austria+Contribution_annual_growth$Belgium+Contribution_annual_growth$Cyprus+Contribution_annual_growth$Estonia+Contribution_annual_growth$Finland+Contribution_annual_growth$France+Contribution_annual_growth$Germany+Contribution_annual_growth$Greece+Contribution_annual_growth$Italy+Contribution_annual_growth$Latvia+Contribution_annual_growth$Lithuania+Contribution_annual_growth$Luxembourg+Contribution_annual_growth$Malta+Contribution_annual_growth$Netherlands+Contribution_annual_growth$Portugal+Contribution_annual_growth$Slovakia+Contribution_annual_growth$Slovenia+Contribution_annual_growth$Spain


colnames(EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH)<-c("EA")

sum_contribution_annual_growth<-sum(Contribution_annual_growth$USA["2016/"],Contribution_annual_growth$GB["2016/"],Contribution_annual_growth$NI["2016/"],EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH$EA["2016/"],Contribution_annual_growth$China["2016/"])

Other_contribution_export<-data.frame(NA, nrow=length(index(Contribution_annual_growth["2016/"])))

Other_contribution_export<-Contribution_annual_growth$TOTAL-((Contribution_annual_growth$USA+Contribution_annual_growth$China+Contribution_annual_growth$GB+Contribution_annual_growth$NI+EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH$EA))


Other_contribution<-as.xts(Other_contribution_export$TOTAL)
colnames(Other_contribution)<-c("OTHER")

summary_contribution<-data.frame(merge(Contribution_annual_growth$USA["2023-01-01/"],EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH$EA["2023/"],Contribution_annual_growth$China["2023/"],Contribution_annual_growth$GB["2023/"],Contribution_annual_growth$NI["2023/"],Other_contribution$OTHER["2023/"]),index(Contribution_annual_growth["2023/"]))
colnames(summary_contribution)<-c("USA","Euro Area","China","Great Britian","Northern Ireland","Other","Date")
summary_contribution_melt<-melt(summary_contribution,id=c("Date"))





destination_plot<-ggplot(data=summary_contribution_melt, aes(y=value, x=Date, fill=variable)) + 
  geom_bar(position="stack", stat="identity")+theme(legend.position.inside='bottom',element_text(size=100))+
  labs(x="",
       title="Contribution of Ireland's Main Trading Partners to Export Growth",
       caption="Date Source: CSO monthly external trade data from 2020",
       y="contribution to annual growth (%)")+
  scale_fill_manual(name = "", values  = c("USA" = DOF_colours[1],"Euro Area" = DOF_colours[2],"China" = DOF_colours[3],"Great Britian"=DOF_colours[4],"Northern Ireland"=DOF_colours[5],"Other"=DOF_colours[6]))+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))
  
  


#3 month average share 
Date_3MA<-data.frame(Date[3:length(Date)])
colnames(Date_3MA)<-c("Date")
Total_Share_3MA<-data.frame(rollmean(Total_Share, k=3),Date_3MA$Date)
Total_Share_3MA$EURO_AREA<-Total_Share_3MA$Austria+Total_Share_3MA$Belgium+Total_Share_3MA$Cyprus+Total_Share_3MA$Estonia+Total_Share_3MA$Finland+Total_Share_3MA$France+Total_Share_3MA$Germany+Total_Share_3MA$Greece+Total_Share_3MA$Italy+Total_Share_3MA$Latvia+Total_Share_3MA$Lithuania+Total_Share_3MA$Luxembourg+Total_Share_3MA$Malta+Total_Share_3MA$Netherlands+Total_Share_3MA$Portugal+Total_Share_3MA$Slovakia+Total_Share_3MA$Slovenia+Total_Share_3MA$Spain+Total_Share_3MA$Croatia



#6 month average share 
Date_6MA<-data.frame(Date[6:length(Date)])
colnames(Date_6MA)<-c("Date")


#12 month average share 
Date_12MA<-data.frame(Date[12:length(Date)])
colnames(Date_12MA)<-c("Date")


y1<-ggplot()+geom_line(data=Total_Share_3MA,aes(x=Date_3MA.Date,y=China, colour="China"),size=1)+
  geom_line(data=Total_Share_3MA,aes(x=Date_3MA.Date,y=GB, colour="Great Britian"),size=1)+  
  geom_line(data=Total_Share_3MA,aes(x=Date_3MA.Date,y=USA, colour="USA"),size=1)+  
  geom_line(data=Total_Share_3MA,aes(x=Date_3MA.Date,y=EURO_AREA, colour="Euro Area"),size=1)+  
  scale_y_continuous(labels=function(x) paste0(x,"%"))+
  theme(legend.position.inside.inside='top',plot.caption = element_text(hjust=0))+

  
  labs(x="",
       title="Irelands Goods Export Trade share",
       caption="Date Source: CSO monthly external trade data from 2015 using a three month moving average",
       y="Percentage Share (%)")+
  scale_color_manual(name = "Country", values = c("USA" = DOF_colours[1],"China" = DOF_colours[2],"Great Britian" = DOF_colours[3],"Euro Area" = DOF_colours[6]))+
  geom_vline(xintercept=(Date_3MA$Date[62]),linetype=2,color="black")+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))+
  geom_vline(xintercept=last(Date_3MA$Date[84]),linetype=2,color="black")+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))+
  geom_rect((aes(xmin=(Date_3MA$Date[62]), xmax=last(Date_3MA$Date[84]), ymin=-Inf, ymax=Inf)),fill="grey",alpha = 0.1)
  
y1


#animate 
#y2<-y1+transition_reveal(Date_3MA.Date)
#q<-animate(y2,end_pause=25, nframes=250,renderer = gifski_renderer())

annual_growth_exports<-na.locf(growth(Total_Export_Country,12),na.rm=TRUE) %>% round (2)
month_growth_exports<-na.locf(growth(Total_Export_Country,1),na.rm=TRUE) %>% round (2)






#three month sum of exports 
sum_3M_Total<-xts(rollsum(Total_Export_Country, k=3),order.by=Date_3MA$Date)
annual_growth_exports_3M<-na.locf(growth(sum_3M_Total,12),na.rm=TRUE) %>% round (2) 

Date_3MA_Growth<-index(annual_growth_exports_3M)
annual_growth_exports_threemonth<-data.frame(annual_growth_exports_3M,Date_3MA_Growth)


#6 month sum of exports 
sum_6M_Total<-xts(rollsum(Total_Export_Country, k=6),order.by=Date_6MA$Date)
annual_growth_exports_6M<-na.locf(growth(sum_6M_Total,12),na.rm=TRUE) %>% round (2) 

Date_6MA_Growth<-index(annual_growth_exports_6M)
annual_growth_exports_sixmonth<-data.frame(annual_growth_exports_6M,Date_6MA_Growth)

#12 month sum of exports 
sum_12M_Total<-xts(rollsum(Total_Export_Country, k=12),order.by=Date_12MA$Date)
annual_growth_exports_12M<-na.locf(growth(sum_12M_Total,12),na.rm=TRUE) %>% round (2) 

Date_12MA_Growth<-index(annual_growth_exports_12M)
annual_growth_exports_twelevemonth<-data.frame(annual_growth_exports_12M,Date_12MA_Growth)

#shorten data series
short_annual_growth<-data.frame(annual_growth_exports$TOTAL["2020/"],Total_Export_Country$TOTAL["2020/"],index(annual_growth_exports["2020/"]))
colnames(short_annual_growth)<-c("TOTAL","TOTAL_LEVEL","DATE")



#Levels change

Date_level<-index(Total_Export_Country)
Total_Export_Level<-data.frame(Total_Export_Country,Date_level)

#6 month sum of exports level 
sum_6M_Total_LEVEL<-xts(rollsum(Total_Export_Level$TOTAL, k=6),order.by=Date_6MA$Date) 
Date_level_6M<-index(sum_6M_Total_LEVEL)

Export_Level<-data.frame(sum_6M_Total_LEVEL["2020/"],Date_level_6M[56:length(Date_level_6M)])
colnames(Export_Level)<-c("sum_6M_Total_LEVEL","Date")


#EXPORT_YTD<-YTD(Total_Export_Country$TOTAL) %>% round(2)



y3<-ggplot(data=short_annual_growth,aes(x=DATE))+
      geom_line(aes(y=TOTAL, colour="Export growth"),size=1)+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+
  theme(legend.position.inside="none",plot.caption = element_text(hjust=0))+
  labs(x="",
       title="Irelands Goods export growth: annual percentage change",
       caption="Date Source: CSO monthly external trade data from 2015",
       y="annual percentage change (%)")+
  scale_color_manual(name = "", values = c("Export growth" = DOF_colours[2]))+
  theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))

y3<-y3+ theme(legend.position.inside="none")


y4<-ggplot()+
  geom_line(data=Export_Level,aes(x=Date,y=sum_6M_Total_LEVEL, colour="Total"),size=1)+

  scale_y_continuous(labels=function(x) paste0(x))+
  theme(legend.position.inside='top',plot.caption = element_text(hjust=0))+
  labs(x="",
       title="Irelands Goods Export level",
       caption="Date Source: CSO monthly external trade data from 2015",
       y="")+
  scale_color_manual(name = "", values = c("Total" = DOF_colours[1]))+
  theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))
y4


#monthly volume growth 
monthly_growth_exports_vol<-as.xts(round(growth(Ireland_Exports_SA_vol_xts,freq = 1),2))

#annual volume growth
annual_growth_exports_vol<-as.xts(round(growth(Ireland_Exports_vol_xts,freq = 12),2))


#monthly value growth 
monthly_growth_exports_val<-as.xts(round(growth(Ireland_Exports_val_xts,freq = 1),2))
Monthly_growth_exports_val_text<-conditional_alt2(monthly_growth_exports_val[length(monthly_growth_exports_val)])



#Annual value growth 
annual_growth_exports_val<-round(growth(Total_Export_Country$TOTAL,freq=12),2)
annual_growth_exports_val_text<-conditional(annual_growth_exports_val$TOTAL[length(annual_growth_exports_val$TOTAL)])

#Year to Date calculation
YTD_2022_annual<- 100*(sum(Total_Export_Country$TOTAL["2024"])-sum(Total_Export_Country$TOTAL["2023"][1:length(Total_Export_Country$TOTAL["2024"])]))/sum(Total_Export_Country$TOTAL["2023"][1:length(Total_Export_Country$TOTAL["2024"])])
YTD_2022_annual_text<-conditional(YTD_2022_annual)

delta_Budget_2022<-(YTD_2022_annual+2.3)
export_nominal_budget<-conditional_alt4(delta_Budget_2022)



#Pre-Covid calculation
Pre_Covid_export<- 100*(sum(Ireland_Exports_val_xts[length(Ireland_Exports_val_xts)])-sum(Ireland_Exports_val_xts["2020-02-01"]))/sum(Ireland_Exports_val_xts["2020-02-01"])
Pre_Covid_export_text<-conditional(Pre_Covid_export)

Pre_Covid_export_vol<- 100*(sum(Ireland_Exports_SA_vol_xts[length(Ireland_Exports_SA_vol_xts)])-sum(Ireland_Exports_SA_vol_xts["2020-02-01"]))/sum(Ireland_Exports_SA_vol_xts["2020-02-01"])
Pre_Covid_export_text_vol<-conditional(Pre_Covid_export_vol)




summary_table<-data.frame((merge(monthly_growth_exports_vol["2024-09-01/"],monthly_growth_exports_val["2024-09-01/"],monthly_growth_imports_val["2024-09-01/"],annual_growth_exports_vol["2024-09-01/"],annual_growth_exports_val["2024-09-01/"],annual_growth_imports_val["2024-09-01/"])))
r<-as.Date(rownames(summary_table))
rt<-format(r,"%b-%Y")

colnames(summary_table)<-c("Export Volume (M-o-M)","Export Value (M-o-M)","Import Value (M-o-M)","Export Volume (Y-o-Y)","Export Value (Y-o-Y)","Import Value (Y-o-Y)")



rownames(summary_table)<-c(rt)
summary_table<-t(summary_table)

current<-paste0(colnames(summary_table)[ncol(summary_table)])

current_less<-paste0(colnames(summary_table)[ncol(summary_table)-1])


#table needs to be fixed to make columns dynamic once update to formattable is run 

summary_table<-data.frame(summary_table)


```

```{r plot, echo=FALSE}


```

```{r include=FALSE}
text_annual_export_USA<-conditional(annual_growth_exports$USA[length(annual_growth_exports$USA)])
text_annual_contribution_export_USA<-conditional(Contribution_annual_growth$USA[length(Contribution_annual_growth$USA)])
text_annual_contribution_export_USA_TOTAL<-paste0(round(100*Contribution_annual_growth$USA[length(Contribution_annual_growth$USA)]/(Contribution_annual_growth$TOTAL[length(Contribution_annual_growth$TOTAL)]),1),sep="%")



text_annual_export_GB<-conditional(annual_growth_exports$GB[length(annual_growth_exports$GB)])
text_annual_contribution_export_GB<-conditional(Contribution_annual_growth$GB[length(Contribution_annual_growth$GB)])
text_annual_contribution_export_GB_TOTAL<-paste0(round(100*Contribution_annual_growth$GB[length(Contribution_annual_growth$GB)]/(Contribution_annual_growth$TOTAL[length(Contribution_annual_growth$TOTAL)]),1),sep="%")


text_annual_export_NI<-conditional(annual_growth_exports$NI[length(annual_growth_exports$NI)])
text_annual_contribution_export_NI<-conditional(Contribution_annual_growth$NI[length(Contribution_annual_growth$NI)])
text_annual_contribution_export_NI_TOTAL<-paste0(round(100*Contribution_annual_growth$NI[length(Contribution_annual_growth$NI)]/(Contribution_annual_growth$TOTAL[length(Contribution_annual_growth$TOTAL)]),1),sep="%")

text_annual_export_Euro_Area<-conditional(EURO_AREA_Growth_Rate[length(EURO_AREA_Growth_Rate)])
text_annual_contribution_export_EURO_AREA<-conditional(EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH$EA[length(EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH$EA)])
text_annual_contribution_export_EURO_AREA_TOTAL<-paste0(round(100*EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH$EA[length(EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH$EA)]/(Contribution_annual_growth$TOTAL[length(Contribution_annual_growth$TOTAL)]),1),sep="%")


text_annual_export_China<-conditional(annual_growth_exports$China[length(annual_growth_exports$China)])
text_annual_contribution_export_China<-conditional(Contribution_annual_growth$China[length(Contribution_annual_growth$China)])
text_annual_contribution_export_China_TOTAL<-paste0(round(100*Contribution_annual_growth$China[length(Contribution_annual_growth$China)]/(Contribution_annual_growth$TOTAL[length(Contribution_annual_growth$TOTAL)]),1),sep="%")


text_annual_export_Other<-conditional(annual_growth_exports_Others[length(annual_growth_exports_Others)])
text_annual_contribution_export_Other<-conditional(Other_contribution_export$TOTAL[length(Other_contribution_export$TOTAL)])
text_annual_contribution_export_Other_TOTAL<-paste0(round(100*Other_contribution_export$TOTAL[length(Other_contribution_export$TOTAL)]/(Contribution_annual_growth$TOTAL[length(Contribution_annual_growth$TOTAL)]),1),sep="%")



#volume measure text
Vol_monthly_text<-conditional(monthly_growth_exports_vol[length(monthly_growth_exports_vol)])
Vol_annual<-conditional(annual_growth_exports_vol[length(annual_growth_exports_vol)])



Three_month_yoy_EXPORTS<-Three_month_yoy(Total_Export_Country$TOTAL) 
Three_month_yoy_EXPORTS[is.infinite(Three_month_yoy_EXPORTS)]<-0
Three_month_yoy_EXPORTS[is.na(Three_month_yoy_EXPORTS)]<-0
colnames(Three_month_yoy_EXPORTS)<-c("Three_month_yoy_EXPORTS")



Val_three_month_text<-conditional(Three_month_yoy_EXPORTS$Three_month_yoy_EXPORTS[length(Three_month_yoy_EXPORTS$Three_month_yoy_EXPORTS)])


```

```{r tables, echo=FALSE, message=FALSE, warning=FALSE}


d<-colnames(summary_table[length(summary_table)])




format_table1<-formattable(x=(summary_table),list(area(col=ncol(summary_table)) ~  formatter("span", style = ~ style(color = ifelse(summary_table[ncol(summary_table)]< 0, "red",ifelse(summary_table[ncol(summary_table)] >= 0,"green","grey"))),
 ~ icontext(ifelse(summary_table[ncol(summary_table)] =="", "arrow-none",ifelse(summary_table[ncol(summary_table)] <0,"arrow-down",ifelse(summary_table[ncol(summary_table)] > 0,"arrow-up",""))),pull(summary_table)))))



#export_formattable <- function(f, file, width = "100%", height = NULL, 
#                               background = "white", delay = 0.2)
#{
#  w <- as.htmlwidget(f, width = width, height = height)
#
#   path <- html_print(w, background = background, viewer = NULL)
#  url <- paste0("file:///", gsub("\\\\", "/", normalizePath(path)))
#  webshot(url,
#          file = file,
#          selector = ".formattable_widget",
#          delay = delay)
#}

#format_table1 %>% export_formattable %>% image()
#SCREENSHOT<-export_formattable(format_table1,"format.png")


#html_print(as.htmlwidget(format_table1))

library(kableExtra)


kabble_format_table_short<-format_table1 %>% kbl(caption = "<center><strong>Table 1: Latest Development </strong></center>" ,align = 'c'
) %>% 
   kable_styling("striped", full_width = T)

kabble_format_table_fix_email<-kabble_format_table_short %>% kableExtra::column_spec(ncol(summary_table)) %>%
  kableExtra::row_spec(nrow(summary_table)) %>%
  column_spec(ncol(summary_table),include_thead = FALSE, color = ifelse(is.na(summary_table[,ncol(summary_table)-1]),"black",ifelse(summary_table[,ncol(summary_table)-1]<=0,"red",DOF_colours[1]))) %>%
  column_spec(ncol(summary_table)+1,include_thead = FALSE, color = ifelse(is.na(summary_table[,ncol(summary_table)]<=0), "red",DOF_colours[1])) %>% as_image()  

```

```{r echo=FALSE, message=FALSE, warning=FALSE}

kabble_format_table_fix_email

```

------------------------------------------------------------------------

#### **Short term Trends**

-   According to the latest data, the value of export growth in `r current_date` was `r Monthly_growth_exports_val_text` than the previous month. In `r current_date` imports were also `r Monthly_growth_imports_val_text` the previous month. <br> <br>
-   On an annual basis, the value of goods exports `r annual_growth_exports_val_text` in `r current_date`.Over the same period, the value of imports `r annual_growth_imports_val_text`. <br> <br>
-   On a volume basis, goods exports `r Vol_monthly_text` in `r current_date_vol` and `r Vol_annual` on an annual basis. <br> <br>



```{r Medium term, message=FALSE, warning=FALSE, include=FALSE}

THREE_MONTH_XTS<-as.xts(annual_growth_exports_threemonth$TOTAL,annual_growth_exports_threemonth$Date_3MA_Growth)
SIX_MONTH_XTS<-as.xts(annual_growth_exports_sixmonth$TOTAL,annual_growth_exports_sixmonth$Date_6MA_Growth)
TWELEVE_MONTH_XTS<-as.xts(annual_growth_exports_twelevemonth$TOTAL,annual_growth_exports_twelevemonth$Date_12MA_Growth)

MEDIUM_TERM<-merge(THREE_MONTH_XTS,SIX_MONTH_XTS,TWELEVE_MONTH_XTS) %>% .["2024-01-01/"] 
MEDIUM_TERM_T<-MEDIUM_TERM %>% t()
rownames(MEDIUM_TERM_T)<-c("Three month (y-o-y)", "Six month (y-o-y)", "Tweleve month (y-o-y)")
colnames(MEDIUM_TERM_T)<-format(as.Date(colnames(MEDIUM_TERM_T)),"%b-%Y")


kabble_format_table_MEDIUM_TERM<- kbl((MEDIUM_TERM_T),caption = "<center><strong>Table 2: Goods Export - Medium term trends </strong></center>" ,align = 'c'
) %>% 
   kable_styling("striped", full_width = T)

kabble_format_table_MEDIUM_TERM<-kabble_format_table_MEDIUM_TERM %>% kableExtra::column_spec(ncol(MEDIUM_TERM_T)) %>%
  kableExtra::row_spec(nrow(MEDIUM_TERM_T))%>% as_image()  



TEXT_THREE_MONTH<-conditional((THREE_MONTH_XTS[nrow(THREE_MONTH_XTS)]))
TEXT_THREE_MONTH_PACE<-(as.numeric(THREE_MONTH_XTS[nrow(THREE_MONTH_XTS)])-as.numeric(THREE_MONTH_XTS[nrow(THREE_MONTH_XTS)-1])) %>% conditional_alt2()




SHORT_TERM<-((merge(monthly_growth_exports_vol,monthly_growth_exports_val,monthly_growth_imports_val,annual_growth_exports_vol,annual_growth_exports_val,annual_growth_imports_val)))

colnames(SHORT_TERM)<-c("Export Volume (M-o-M)","Export Value (M-o-M)","Import Value (M-o-M)","Export Volume (Y-o-Y)","Export Value (Y-o-Y)","Import Value (Y-o-Y)")


Medium_TERM_DATA<-merge(THREE_MONTH_XTS,SIX_MONTH_XTS,TWELEVE_MONTH_XTS)

SUMMARY_EXPORT_DATA_DOWNLOAD <- list('Short Term' =data.frame(index(SHORT_TERM),SHORT_TERM),'Medium Term' =data.frame(index(Medium_TERM_DATA),Medium_TERM_DATA))




write.xlsx(SUMMARY_EXPORT_DATA_DOWNLOAD, file = 'SUMMARY_EXPORT_DATA_DOWNLOAD.xlsx')


```

```{r medium table, echo=FALSE}
kabble_format_table_MEDIUM_TERM
```



<span class="text-center" style="color:#A3915E"> <center> <font size="4">[Download Data](https://github.com/mflanagan201/gcal_auto/raw/main/SUMMARY_EXPORT_DATA_DOWNLOAD.xlsx)</font> </center>

#### **Medium term Trends**

-   Year to date, nominal goods exports have `r YTD_2022_annual_text` in `r current_date`.\
    <br> <br>

-   On a three month basis,  goods exports have `r TEXT_THREE_MONTH` in `r current_date`.As a result, the pace of growth is `r TEXT_THREE_MONTH_PACE` over the month\
    <br> <br>







------------------------------------------------------------------------

<span class="text-center" style="color:#A3915E">

<center><font size="4"> **Goods Exports - Detailed Breakdown** </font></center>

</span>

------------------------------------------------------------------------

```{r country plots, echo=FALSE}
library(htmltools)

destination_plot2<-destination_plot+ theme(legend.position.inside=c(0.5, 0.8))
destination_plot2
```

------------------------------------------------------------------------

#### **Country Level Breakdown**

-   Exports to the USA, `r text_annual_export_USA` on an annual basis and contributed `r round(Contribution_annual_growth$USA[length(Contribution_annual_growth$USA)],1)` percentage points (representing `r text_annual_contribution_export_USA_TOTAL` of the total) in `r current_date`.\
    <br> <br>
-   Exports to Great Britian, `r text_annual_export_GB` on an annual basis and contributed `r round(Contribution_annual_growth$GB[length(Contribution_annual_growth$GB)],1)` percentage points (representing `r text_annual_contribution_export_GB_TOTAL` of the total) in `r current_date`.\
    <br> <br>
-   Exports to Northern Ireland, `r text_annual_export_NI` on an annual basis and contributed `r round(Contribution_annual_growth$NI[length(Contribution_annual_growth$NI)],1)` percentage points (representing `r text_annual_contribution_export_NI_TOTAL` of the total) in `r current_date`. <br> <br>
-   Exports to the Euro Area, `r text_annual_export_Euro_Area` on an annual basis and contributed `r round(EURO_AREA_CONTRIBUTION_ANNUAL_GROWTH$EA[length(Contribution_annual_growth$Germany)],1)` percentage points (representing `r text_annual_contribution_export_EURO_AREA_TOTAL` of the total) in `r current_date`. <br> <br>
-   Exports to China, `r text_annual_export_China` on an annual basis and contributed `r round(Contribution_annual_growth$China[length(Contribution_annual_growth$China)],1)` percentage points (representing `r text_annual_contribution_export_China_TOTAL` of the total) in `r current_date`. <br> <br>
-   Outside of our main trading partners,exports `r text_annual_export_Other` on an annual basis and contributed `r round(Other_contribution_export$TOTAL[length(Other_contribution_export$TOTAL)],1)` percentage points (representing `r text_annual_contribution_export_Other_TOTAL` of the total) in `r current_date`. </br>

------------------------------------------------------------------------

```{r Brexit, include=FALSE}

Exports_UK<-Total_Export_Country$GB+Total_Export_Country$NI

Exports_UK_growth<-growth(Exports_UK,freq=12)
annual_text_UK_EXPORT<-conditional(Exports_UK_growth$GB[length(Exports_UK_growth$GB)])


Exports_GB_growth<-growth(Total_Export_Country$GB,freq=12)
annual_text_GB_EXPORT<-conditional(Exports_GB_growth$GB[length(Exports_GB_growth$GB)])

Exports_NI_growth<-growth(Total_Export_Country$NI,freq=12)
annual_text_NI_EXPORT<-conditional(Exports_NI_growth$NI[length(Exports_NI_growth$NI)])




#Year to Date calculation
YTD_2022_annual_UK_EXPORT<- 100*(sum(Exports_UK$GB["2024"])-sum(Exports_UK$GB["2022"][1:length(Exports_UK$GB["2024"])]))/sum(Exports_UK$GB["2023"][1:length(Exports_UK$GB["2024"])])
YTD_2022_annual_text_UK_EXPORT<-conditional(YTD_2022_annual_UK_EXPORT)

YTD_2022_annual_GB_EXPORT<- 100*(sum(Total_Export_Country$GB["2024"])-sum(Total_Export_Country$GB["2023"][1:length(Total_Export_Country$GB["2024"])]))/sum(Total_Export_Country$GB["2023"][1:length(Total_Export_Country$GB["2024"])])
YTD_2022_annual_text_GB_EXPORT<-conditional(YTD_2022_annual_GB_EXPORT)


YTD_2022_annual_NI_EXPORT<- 100*(sum(Total_Export_Country$NI["2024"])-sum(Total_Export_Country$NI["2023"][1:length(Total_Export_Country$NI["2024"])]))/sum(Total_Export_Country$NI["2023"][1:length(Total_Export_Country$NI["2024"])])
YTD_2022_annual_text_NI_EXPORT<-conditional(YTD_2022_annual_NI_EXPORT)


FB_GB_EXPORTS<-na.locf(as.numeric(GB_exports_xts$`Live animals except fish etc. (00`),na.rm=TRUE)+na.locf(as.numeric(GB_exports_xts$`Meat and meat preparations (01`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Dairy products and birds eggs (02`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Fish, crustaceans, molluscs and preparations thereof (03`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Cereals and cereal preparations (04`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Vegetables and fruit (05`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Sugar, sugar preparations and honey (06`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Coffee, tea, cocoa, spices and manufactures thereof (07`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Miscellaneous edible products and preparations (09`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Beverages (11`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Tobacco and tobacco manufactures (12`),na.rm = TRUE)






FB_NI_EXPORTS<-na.locf(as.numeric(NI_exports_xts$`Live animals except fish etc. (00`),na.rm=TRUE)+na.locf(as.numeric(NI_exports_xts$`Meat and meat preparations (01`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Dairy products and birds eggs (02`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Fish, crustaceans, molluscs and preparations thereof (03`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Cereals and cereal preparations (04`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Vegetables and fruit (05`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Sugar, sugar preparations and honey (06`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Coffee, tea, cocoa, spices and manufactures thereof (07`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Miscellaneous edible products and preparations (09`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Beverages (11`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Tobacco and tobacco manufactures (12`),na.rm = TRUE)






FB_UK_EXPORTS<-FB_GB_EXPORTS+FB_NI_EXPORTS
FB_UK_EXPORTS<-as.xts(FB_UK_EXPORTS,order.by =index(GB_exports_xts)) 
colnames(FB_UK_EXPORTS)<-c("FB_UK_EXPORTS")



YTD_2022_FB_UK_EXPORTS<- 100*(sum(FB_UK_EXPORTS$FB_UK_EXPORTS["2024"])-sum(FB_UK_EXPORTS$FB_UK_EXPORTS["2023"][1:length(FB_UK_EXPORTS$FB_UK_EXPORTS["2024"])]))/sum(FB_UK_EXPORTS$FB_UK_EXPORTS["2023"][1:length(FB_UK_EXPORTS$FB_UK_EXPORTS["2024"])])


YTD_2022_annual_text_UK_FB_EXPORT<-conditional(YTD_2022_FB_UK_EXPORTS)



Pharma_GB_EXPORTS<-na.locf(as.numeric(GB_exports_xts$`Organic chemicals (51`),na.rm=TRUE)+na.locf(as.numeric(GB_exports_xts$`Inorganic chemicals (52`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Dyeing, tanning and colouring materials (53`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Medicinal and pharmaceutical products (54`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Essential oils, perfume materials, toilet preparations etc. (55`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Fertilisers, manufactured (56`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Plastics in primary forms (57`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Plastics in non-primary forms (58`),na.rm = TRUE)+na.locf(as.numeric(GB_exports_xts$`Chemical materials and products, n.e.s. (59`),na.rm = TRUE)

Pharma_NI_EXPORTS<-na.locf(as.numeric(NI_exports_xts$`Organic chemicals (51`),na.rm=TRUE)+na.locf(as.numeric(NI_exports_xts$`Inorganic chemicals (52`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Dyeing, tanning and colouring materials (53`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Medicinal and pharmaceutical products (54`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Essential oils, perfume materials, toilet preparations etc. (55`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Fertilisers, manufactured (56`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Plastics in primary forms (57`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Plastics in non-primary forms (58`),na.rm = TRUE)+na.locf(as.numeric(NI_exports_xts$`Chemical materials and products, n.e.s. (59`),na.rm = TRUE)


Pharma_UK_EXPORTS<-Pharma_GB_EXPORTS+Pharma_NI_EXPORTS
Pharma_UK_EXPORTS<-as.xts(Pharma_UK_EXPORTS,order.by =index(GB_exports_xts)) 
colnames(Pharma_UK_EXPORTS)<-c("Pharma_UK_EXPORTS")


YTD_2022_PHARMA_UK_EXPORTS<- 100*(sum(Pharma_UK_EXPORTS$Pharma_UK_EXPORTS["2024"])-sum(Pharma_UK_EXPORTS$Pharma_UK_EXPORTS["2023"][1:length(Pharma_UK_EXPORTS$Pharma_UK_EXPORTS["2024"])]))/sum(Pharma_UK_EXPORTS$Pharma_UK_EXPORTS["2023"][1:length(Pharma_UK_EXPORTS$Pharma_UK_EXPORTS["2024"])])


YTD_2022_annual_text_UK_PHARMA_EXPORT<-conditional(YTD_2022_PHARMA_UK_EXPORTS)


#cONTRIBUTION GB ANNUAL GROWTH

GB_exports_xts_NUMBER<-(as.numeric(GB_exports_xts))
 


ANNUAL_GROWTH_GB<-growth(GB_exports_xts_NUMBER,12)
ANNUAL_cONTRI_GROWTH_GB<-

GB_PROD<-data.frame(  
as.numeric(GB_exports_xts$`Live animals except fish etc. (00`),
as.numeric(GB_exports_xts$`Meat and meat preparations (01`),
as.numeric(GB_exports_xts$`Dairy products and birds eggs (02`),
as.numeric(GB_exports_xts$`Fish, crustaceans, molluscs and preparations thereof (03`),
as.numeric(GB_exports_xts$`Cereals and cereal preparations (04`),
as.numeric(GB_exports_xts$`Vegetables and fruit (05`)  ,
as.numeric(GB_exports_xts$`Sugar, sugar preparations and honey (06`),  
as.numeric(GB_exports_xts$`Coffee, tea, cocoa, spices and manufactures thereof (07`),
as.numeric(GB_exports_xts$`Miscellaneous edible products and preparations (09`)  ,
as.numeric(GB_exports_xts$`Beverages (11`)  ,
as.numeric(GB_exports_xts$`Tobacco and tobacco manufactures (12`),
as.numeric(GB_exports_xts$`Hides, skins and furskins, raw (21`),
as.numeric(GB_exports_xts$`Oilseeds and oleaginous fruit (22`),
as.numeric(GB_exports_xts$`Crude rubber, including synthetic and reclaimed rubber (23`),
as.numeric(GB_exports_xts$`Cork and wood (24`),
as.numeric(GB_exports_xts$`Pulp and waste paper (25`),
as.numeric(GB_exports_xts$`Textile fibres, excluding wool tops, and their wastes (26`),
as.numeric(GB_exports_xts$`Crude fertilisers and minerals, excluding coal, petroleum etc. (27`),
as.numeric(GB_exports_xts$`Metalliferous ores and metal scrap (28`),
as.numeric(GB_exports_xts$`Crude animal and vegetable materials, n.e.s. (29`),
as.numeric(GB_exports_xts$`Coal, coke and briquettes (32`),
as.numeric(GB_exports_xts$`Petroleum, petroleum products and related materials (33`),
as.numeric(GB_exports_xts$`Gas, natural and manufactured (34`),
as.numeric(GB_exports_xts$`Electric current (35`),
as.numeric(GB_exports_xts$`Animal oils and fats (41`),
as.numeric(GB_exports_xts$`Fixed vegetable oils and fats (42`),
as.numeric(GB_exports_xts$`Animal and vegetable oils and fats, processed, and waxes (43`),
as.numeric(GB_exports_xts$`Organic chemicals (51`),
as.numeric(GB_exports_xts$`Inorganic chemicals (52`)
,as.numeric(GB_exports_xts$`Dyeing, tanning and colouring materials (53`)
,as.numeric(GB_exports_xts$`Medicinal and pharmaceutical products (54`)
,as.numeric(GB_exports_xts$`Essential oils, perfume materials, toilet preparations etc. (55`)
,as.numeric(GB_exports_xts$`Fertilisers, manufactured (56`)
,as.numeric(GB_exports_xts$`Plastics in primary forms (57`)
,as.numeric(GB_exports_xts$`Plastics in non-primary forms (58`)
,as.numeric(GB_exports_xts$`Chemical materials and products, n.e.s. (59`)
,as.numeric(GB_exports_xts$`Leather, leather manufactures and dressed furskins (61`)
,as.numeric(GB_exports_xts$`Rubber manufactures, n.e.s. (62`)
,as.numeric(GB_exports_xts$`Cork and wood manufactures, excluding furniture (63`)
,as.numeric(GB_exports_xts$`Paper, paperboard and articles of paper pulp, paper etc. (64`)
,as.numeric(GB_exports_xts$`Textile yarn, fabrics, made-up articles and related products (65`)
,as.numeric(GB_exports_xts$`Non-metallic mineral manufactures, n.e.s. (66`)
,as.numeric(GB_exports_xts$`Iron and steel (67`)
,as.numeric(GB_exports_xts$`Non-ferrous metals (68`)
,as.numeric(GB_exports_xts$`Manufactures of metal, n.e.s. (69`)
,as.numeric(GB_exports_xts$`Power generating machinery and equipment (71`)
,as.numeric(GB_exports_xts$`Machinery specialised for particular industries (72`)
,as.numeric(GB_exports_xts$`Metalworking machinery (73`)
,as.numeric(GB_exports_xts$`General industrial machinery and parts, n.e.s. (74`)
,as.numeric(GB_exports_xts$`Office machines and automatic data processing equipment (75`)
,as.numeric(GB_exports_xts$`Telecommunications and sound recording, reproducing equipment (76`)
,as.numeric(GB_exports_xts$`Electrical machinery, appliances etc., n.e.s. (77`)
,as.numeric(GB_exports_xts$`Road vehicles (78`)
,as.numeric(GB_exports_xts$`Other transport equipment (79`)
,as.numeric(GB_exports_xts$`Prefab buildings; plumbing and electrical fixtures and fittings (81`)
,as.numeric(GB_exports_xts$`Furniture and parts thereof (82`)
,as.numeric(GB_exports_xts$`Travel goods, handbags and similar containers (83`)
,as.numeric(GB_exports_xts$`Articles of apparel and clothing accessories (84`)
,as.numeric(GB_exports_xts$`Footwear (85`)
,as.numeric(GB_exports_xts$`Professional, scientific and controlling apparatus (87`)
,as.numeric(GB_exports_xts$`Photographic apparatus, optical goods, watches and clocks (88`)
,as.numeric(GB_exports_xts$`Miscellaneous manufactured articles, n.e.s. (89`)
,as.numeric(GB_exports_xts$`Commodities and transactions n.e.s. (9`)
,as.numeric(GB_exports_xts$`Unclassified estimates`)) %>% as.xts(order.by=Date)


colnames(GB_PROD)<-c("Live animals","meat","Dairy","Fish","Cereal","Veg","Sugar","Coffee","Miscellaneous","Beverages","Tobacco","Hides","oilseeds","Crude rubber","Cork","Pulp","Textile fibres","Crude fertilisers","Metalliferous ores","Crude animal and vegetable materials","Coal","Petroleum","Gas","Electric current","Animal oils and fats","Fixed vegetable oils and fats", "Animal and vegetable oils","Organic chemicals","Inorganic chemicals","Dyeing tanning","Medicinal and pharma","Essential oils","Fertilisers","Plastics","Plastics non primary","Chemical materials","Leather","Rubber manufactures","Cork and wood manufactures","Paper paperboard","Textile yarn","Non metallic mineral","Iron and steel","Non ferrous metals","Manufactures of metal","Power generating machinery","Machinery specialised for particular industries","Metalworking machinery","General industrial machinery","Office machines and automatic data processing equipment", "Telecommunications and sound recording","Electrical machinery","Road vehicles","Other transport equipment","Prefab buildings plumbing and electrical","Furniture and parts thereof","Travel goods handbags and similar containers","Articles of apparel","Footwear","Professional scientific and controlling apparatus","Photographic apparatus","Miscellaneous manufactured articles","Commodities and transactions","Unclassified_estimates") 


Annual_GR_GB_PROD<-growth(GB_PROD,12)
GB_PROD_SHARE<-(GB_PROD["2015/"]/as.numeric(Total_Export_Country$GB["2015/"]))

Contribution_annual_growth_GB_product<-round(Annual_GR_GB_PROD["2016/"]*(lag.xts(GB_PROD_SHARE["2015/"],k=12)),2)

latest_GB_prod_contribution<-na.fill0(Contribution_annual_growth_GB_product[nrow(Contribution_annual_growth_GB_product)],fill = 0) %>% data.frame()

colnames(latest_GB_prod_contribution)<-c("Live animals","meat","Dairy","Fish","Cereal","Veg","Sugar","Coffee","Miscellaneous","Beverages","Tobacco","Hides","oilseeds","Crude rubber","Cork","Pulp","Textile fibres","Crude fertilisers","Metalliferous ores","Crude animal and vegetable materials","Coal","Petroleum","Gas","Electric current","Animal oils and fats","Fixed vegetable oils and fats", "Animal and vegetable oils","Organic chemicals","Inorganic chemicals","Dyeing tanning","Medicinal and pharma","Essential oils","Fertilisers","Plastics","Plastics non primary","Chemical materials","Leather","Rubber manufactures","Cork and wood manufactures","Paper paperboard","Textile yarn","Non metallic mineral","Iron and steel","Non ferrous metals","Manufactures of metal","Power generating machinery","Machinery specialised for particular industries","Metalworking machinery","General industrial machinery","Office machines and automatic data processing equipment", "Telecommunications and sound recording","Electrical machinery","Road vehicles","Other transport equipment","Prefab buildings plumbing and electrical","Furniture and parts thereof","Travel goods handbags and similar containers","Articles of apparel","Footwear","Professional scientific and controlling apparatus","Photographic apparatus","Miscellaneous manufactured articles","Commodities and transactions","Unclassified_estimates") 


latest_annual_GB_prod_growth<-Annual_GR_GB_PROD[nrow(Annual_GR_GB_PROD)]  


high_contribution_GB_PROD<-colnames(latest_GB_prod_contribution[max.col(latest_GB_prod_contribution)])
High_contribution_GB_growth_rate<-round(as.numeric(latest_annual_GB_prod_growth[,paste0(high_contribution_GB_PROD)]),1)
High_contribution_growth_rate_GB_text<-conditional(High_contribution_GB_growth_rate)

high_contribution_value_GB<-round(as.numeric(latest_GB_prod_contribution[,paste0(high_contribution_GB_PROD)]),1)



Low_contribution_GB<-colnames(latest_GB_prod_contribution)[which.min(latest_GB_prod_contribution)]
Low_contribution_GB_value<-round(as.numeric(latest_GB_prod_contribution[,paste0(Low_contribution_GB)]),1)


Low_contribution_growth_rate_GB<-round(as.numeric(latest_annual_GB_prod_growth[,paste0(Low_contribution_GB)]),1)
Low_contribution_growth_rate_text_GB<-conditional(Low_contribution_growth_rate_GB)



Core_M_E<-data.frame(as.numeric(GB_exports_xts$`Power generating machinery and equipment (71`),
                      as.numeric(GB_exports_xts$`Machinery specialised for particular industries (72`),
                      as.numeric(GB_exports_xts$`Metalworking machinery (73`),
                      as.numeric(GB_exports_xts$`General industrial machinery and parts, n.e.s. (74`),
                      as.numeric(GB_exports_xts$`Office machines and automatic data processing equipment (75`), 
                      as.numeric(GB_exports_xts$`Telecommunications and sound recording, reproducing equipment (76`),
                      as.numeric(GB_exports_xts$`Electrical machinery, appliances etc., n.e.s. (77`),
                      as.numeric(GB_exports_xts$`Road vehicles (78`)) %>% as.xts(order.by=index(GB_exports_xts))



Core_M_E_GB<-data.frame(NA, nrow=length(index(Core_M_E["2015/"])))

for (i in 1:length(index(Core_M_E["2015/"]))) {
  Core_M_E_GB[i]<-sum(as.numeric(Core_M_E[i]),na.rm = TRUE)
}

Core_M_E_GB<-as.xts(t(Core_M_E_GB), order.by = Date)
colnames(Core_M_E_GB)<-c("Core_M_E_GB")



s<-growth(Core_M_E_GB,freq=12)

#cONTRIBUTION NI ANNUAL GROWTH

NI_exports_xts_NUMBER<-(as.numeric(NI_exports_xts))

ANNUAL_GROWTH_NI<-growth(NI_exports_xts_NUMBER,12)

NI_PROD<-data.frame(  
as.numeric(NI_exports_xts$`Live animals except fish etc. (00`),
as.numeric(NI_exports_xts$`Meat and meat preparations (01`),
as.numeric(NI_exports_xts$`Dairy products and birds eggs (02`),
as.numeric(NI_exports_xts$`Fish, crustaceans, molluscs and preparations thereof (03`),
as.numeric(NI_exports_xts$`Cereals and cereal preparations (04`),
as.numeric(NI_exports_xts$`Vegetables and fruit (05`)  ,
as.numeric(NI_exports_xts$`Sugar, sugar preparations and honey (06`),  
as.numeric(NI_exports_xts$`Coffee, tea, cocoa, spices and manufactures thereof (07`),
as.numeric(NI_exports_xts$`Miscellaneous edible products and preparations (09`)  ,
as.numeric(NI_exports_xts$`Beverages (11`)  ,
as.numeric(NI_exports_xts$`Tobacco and tobacco manufactures (12`),
as.numeric(NI_exports_xts$`Hides, skins and furskins, raw (21`),
as.numeric(NI_exports_xts$`Oilseeds and oleaginous fruit (22`),
as.numeric(NI_exports_xts$`Crude rubber, including synthetic and reclaimed rubber (23`),
as.numeric(NI_exports_xts$`Cork and wood (24`),
as.numeric(NI_exports_xts$`Pulp and waste paper (25`),
as.numeric(NI_exports_xts$`Textile fibres, excluding wool tops, and their wastes (26`),
as.numeric(NI_exports_xts$`Crude fertilisers and minerals, excluding coal, petroleum etc. (27`),
as.numeric(NI_exports_xts$`Metalliferous ores and metal scrap (28`),
as.numeric(NI_exports_xts$`Crude animal and vegetable materials, n.e.s. (29`),
as.numeric(NI_exports_xts$`Coal, coke and briquettes (32`),
as.numeric(NI_exports_xts$`Petroleum, petroleum products and related materials (33`),
as.numeric(NI_exports_xts$`Gas, natural and manufactured (34`),
as.numeric(NI_exports_xts$`Electric current (35`),
as.numeric(NI_exports_xts$`Animal oils and fats (41`),
as.numeric(NI_exports_xts$`Fixed vegetable oils and fats (42`),
as.numeric(NI_exports_xts$`Animal and vegetable oils and fats, processed, and waxes (43`),
as.numeric(NI_exports_xts$`Organic chemicals (51`),
as.numeric(NI_exports_xts$`Inorganic chemicals (52`)
,as.numeric(NI_exports_xts$`Dyeing, tanning and colouring materials (53`)
,as.numeric(NI_exports_xts$`Medicinal and pharmaceutical products (54`)
,as.numeric(NI_exports_xts$`Essential oils, perfume materials, toilet preparations etc. (55`)
,as.numeric(NI_exports_xts$`Fertilisers, manufactured (56`)
,as.numeric(NI_exports_xts$`Plastics in primary forms (57`)
,as.numeric(NI_exports_xts$`Plastics in non-primary forms (58`)
,as.numeric(NI_exports_xts$`Chemical materials and products, n.e.s. (59`)
,as.numeric(NI_exports_xts$`Leather, leather manufactures and dressed furskins (61`)
,as.numeric(NI_exports_xts$`Rubber manufactures, n.e.s. (62`)
,as.numeric(NI_exports_xts$`Cork and wood manufactures, excluding furniture (63`)
,as.numeric(NI_exports_xts$`Paper, paperboard and articles of paper pulp, paper etc. (64`)
,as.numeric(NI_exports_xts$`Textile yarn, fabrics, made-up articles and related products (65`)
,as.numeric(NI_exports_xts$`Non-metallic mineral manufactures, n.e.s. (66`)
,as.numeric(NI_exports_xts$`Iron and steel (67`)
,as.numeric(NI_exports_xts$`Non-ferrous metals (68`)
,as.numeric(NI_exports_xts$`Manufactures of metal, n.e.s. (69`)
,as.numeric(NI_exports_xts$`Power generating machinery and equipment (71`)
,as.numeric(NI_exports_xts$`Machinery specialised for particular industries (72`)
,as.numeric(NI_exports_xts$`Metalworking machinery (73`)
,as.numeric(NI_exports_xts$`General industrial machinery and parts, n.e.s. (74`)
,as.numeric(NI_exports_xts$`Office machines and automatic data processing equipment (75`)
,as.numeric(NI_exports_xts$`Telecommunications and sound recording, reproducing equipment (76`)
,as.numeric(NI_exports_xts$`Electrical machinery, appliances etc., n.e.s. (77`)
,as.numeric(NI_exports_xts$`Road vehicles (78`)
,as.numeric(NI_exports_xts$`Other transport equipment (79`)
,as.numeric(NI_exports_xts$`Prefab buildings; plumbing and electrical fixtures and fittings (81`)
,as.numeric(NI_exports_xts$`Furniture and parts thereof (82`)
,as.numeric(NI_exports_xts$`Travel goods, handbags and similar containers (83`)
,as.numeric(NI_exports_xts$`Articles of apparel and clothing accessories (84`)
,as.numeric(NI_exports_xts$`Footwear (85`)
,as.numeric(NI_exports_xts$`Professional, scientific and controlling apparatus (87`)
,as.numeric(NI_exports_xts$`Photographic apparatus, optical goods, watches and clocks (88`)
,as.numeric(NI_exports_xts$`Miscellaneous manufactured articles, n.e.s. (89`)
,as.numeric(NI_exports_xts$`Commodities and transactions n.e.s. (9`)
,as.numeric(NI_exports_xts$`Unclassified estimates`)) %>% as.xts(order.by=Date)


colnames(NI_PROD)<-c("Live animals","meat","Dairy","Fish","Cereal","Veg","Sugar","Coffee","Miscellaneous","Beverages","Tobacco","Hides","oilseeds","Crude rubber","Cork","Pulp","Textile fibres","Crude fertilisers","Metalliferous ores","Crude animal and vegetable materials","Coal","Petroleum","Gas","Electric current","Animal oils and fats","Fixed vegetable oils and fats", "Animal and vegetable oils","Organic chemicals","Inorganic chemicals","Dyeing tanning","Medicinal and pharma","Essential oils","Fertilisers","Plastics","Plastics non primary","Chemical materials","Leather","Rubber manufactures","Cork and wood manufactures","Paper paperboard","Textile yarn","Non metallic mineral","Iron and steel","Non ferrous metals","Manufactures of metal","Power generating machinery","Machinery specialised for particular industries","Metalworking machinery","General industrial machinery","Office machines and automatic data processing equipment", "Telecommunications and sound recording","Electrical machinery","Road vehicles","Other transport equipment","Prefab buildings plumbing and electrical","Furniture and parts thereof","Travel goods handbags and similar containers","Articles of apparel","Footwear","Professional scientific and controlling apparatus","Photographic apparatus","Miscellaneous manufactured articles","Commodities and transactions","Unclassified_estimates") 


Annual_GR_NI_PROD<-growth(NI_PROD,12)
NI_PROD_SHARE<-(NI_PROD["2015/"]/as.numeric(Total_Export_Country$NI["2015/"]))

Contribution_annual_growth_NI_product<-round(Annual_GR_NI_PROD["2016/"]*(lag.xts(NI_PROD_SHARE["2015/"],k=12)),2)

latest_NI_prod_contribution<-na.fill0(Contribution_annual_growth_NI_product[nrow(Contribution_annual_growth_NI_product)],fill = 0) %>% data.frame()


colnames(latest_NI_prod_contribution)<-c("Live animals","meat","Dairy","Fish","Cereal","Veg","Sugar","Coffee","Miscellaneous","Beverages","Tobacco","Hides","oilseeds","Crude rubber","Cork","Pulp","Textile fibres","Crude fertilisers","Metalliferous ores","Crude animal and vegetable materials","Coal","Petroleum","Gas","Electric current","Animal oils and fats","Fixed vegetable oils and fats", "Animal and vegetable oils","Organic chemicals","Inorganic chemicals","Dyeing tanning","Medicinal and pharma","Essential oils","Fertilisers","Plastics","Plastics non primary","Chemical materials","Leather","Rubber manufactures","Cork and wood manufactures","Paper paperboard","Textile yarn","Non metallic mineral","Iron and steel","Non ferrous metals","Manufactures of metal","Power generating machinery","Machinery specialised for particular industries","Metalworking machinery","General industrial machinery","Office machines and automatic data processing equipment", "Telecommunications and sound recording","Electrical machinery","Road vehicles","Other transport equipment","Prefab buildings plumbing and electrical","Furniture and parts thereof","Travel goods handbags and similar containers","Articles of apparel","Footwear","Professional scientific and controlling apparatus","Photographic apparatus","Miscellaneous manufactured articles","Commodities and transactions","Unclassified_estimates") 

  
  

latest_annual_NI_prod_growth<-Annual_GR_NI_PROD[nrow(Annual_GR_NI_PROD)]  


high_contribution_NI_PROD<-colnames(latest_NI_prod_contribution[max.col(latest_NI_prod_contribution)])

High_contribution_NI_growth_rate<-round(as.numeric(latest_annual_NI_prod_growth[,paste0(high_contribution_NI_PROD)]),1)
High_contribution_growth_rate_NI_text<-conditional(High_contribution_NI_growth_rate)

high_contribution_value_NI<-round(as.numeric(latest_NI_prod_contribution[,paste0(high_contribution_NI_PROD)]),1)



```

#### **Trade with United Kingdom**

-   In `r current_date` exports to the UK `r annual_text_UK_EXPORT` on an annual basis. Over the same period, exports to Great Britian `r annual_text_GB_EXPORT` and exports to Northern Ireland `r annual_text_NI_EXPORT` <br> <br>
-   In the year to date, Exports to the UK `r YTD_2022_annual_text_UK_EXPORT`. Exports to mainland Great Britian `r YTD_2022_annual_text_GB_EXPORT` whilst exports to Northern Ireland `r YTD_2022_annual_text_NI_EXPORT` over the same period. <br> <br>
-   In year to date terms, pharma exports to the UK `r YTD_2022_annual_text_UK_PHARMA_EXPORT` whilst Food & Beverage Exports to the UK `r YTD_2022_annual_text_UK_FB_EXPORT`. <br> <br>
-   [**High Contribution Warning:**]{style="color:green"} At a subcomponent level, `r high_contribution_GB_PROD` reported the highest contribution to annual export growth to Great Britian, contributing `r high_contribution_value_GB` percentage points to growth, as annual export growth in `r high_contribution_GB_PROD` `r High_contribution_growth_rate_GB_text`.\
    <br> <br>
-   [**Big fall Warning:**]{style="color:darkred"} At a subcomponent level, `r Low_contribution_GB` reported the largest drag on annual export growth to Great Britian, contributing `r Low_contribution_GB_value` percentage points to growth, as annual exports in `r Low_contribution_GB` `r Low_contribution_growth_rate_text_GB`. <br> <br>
-   [**High Contribution Warning:**]{style="color:green"} At a subcomponent level, `r high_contribution_NI_PROD` reported the highest contribution to annual export growth to Northern Ireland, contributing `r high_contribution_value_NI` percentage points to growth, as annual export growth in `r high_contribution_NI_PROD` `r High_contribution_growth_rate_NI_text`.

------------------------------------------------------------------------

```{r product breakdown, include=FALSE}
#Product level breakdown 



#Live animals except fish etc. (00)
Live_animals_00<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Live animals except fish etc. (00)") %>% select(-Countries.and.Territories,-Commodity.group))
Live_animals_00_exports_xts <- (as.xts(Live_animals_00, order.by=Date))
Live_animals_00_exports<-data.frame(NA, nrow=length(index(Live_animals_00_exports_xts["2015/"])))

for (i in 1:length(index(Live_animals_00_exports_xts["2015/"]))) {
  Live_animals_00_exports[i]<-sum(as.numeric(Live_animals_00_exports_xts[i]),na.rm = TRUE)
}

Live_animals_00_exports<-as.xts(t(Live_animals_00_exports), order.by = Date)
colnames(Live_animals_00_exports)<-c("Live_animals_00")



#Meat and meat preparations (01)
meat_01<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Meat and meat preparations (01)") %>% select(-Countries.and.Territories,-Commodity.group))
meat_01_exports_xts <- (as.xts(meat_01, order.by=Date))
meat_01_exports<-data.frame(NA, nrow=length(index(meat_01_exports_xts["2015/"])))

for (i in 1:length(index(meat_01_exports_xts["2015/"]))) {
  meat_01_exports[i]<-sum(as.numeric(meat_01_exports_xts[i]),na.rm = TRUE)
}

meat_01_exports<-as.xts(t(meat_01_exports), order.by = Date)
colnames(meat_01_exports)<-c("meat_01")



#Dairy products and birds eggs (02)                                       
Dairy_02<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Dairy products and birds eggs (02)") %>% select(-Countries.and.Territories,-Commodity.group))
Dairy_02_exports_xts <- (as.xts(Dairy_02, order.by=Date))
Dairy_02_exports<-data.frame(NA, nrow=length(index(Dairy_02_exports_xts["2015/"])))

for (i in 1:length(index(Dairy_02_exports_xts["2015/"]))) {
  Dairy_02_exports[i]<-sum(as.numeric(Dairy_02_exports_xts[i]),na.rm = TRUE)
}

Dairy_02_exports<-as.xts(t(Dairy_02_exports), order.by = Date)
colnames(Dairy_02_exports)<-c("Dairy_02")


#Fish, crustaceans, molluscs and preparations thereof (03)                                       
                                       
Fish_03<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Fish, crustaceans, molluscs and preparations thereof (03)") %>% select(-Countries.and.Territories,-Commodity.group))
Fish_03_exports_xts <- (as.xts(Fish_03, order.by=Date))
Fish_03_exports<-data.frame(NA, nrow=length(index(Fish_03_exports_xts["2015/"])))

for (i in 1:length(index(Fish_03_exports_xts["2015/"]))) {
  Fish_03_exports[i]<-sum(as.numeric(Fish_03_exports_xts[i]),na.rm = TRUE)
}

Fish_03_exports<-as.xts(t(Fish_03_exports), order.by = Date)
colnames(Fish_03_exports)<-c("Fish_03")



#Cereals and cereal preparations (04)                                       

Cereal_04<-t(subset(Ireland_exports,Commodity.group=="Cereals and cereal preparations (04)") %>% select(-Countries.and.Territories,-Commodity.group))
Cereal_04_exports_xts <- (as.xts(Cereal_04, order.by=Date))
Cereal_04_exports<-data.frame(NA, nrow=length(index(Cereal_04_exports_xts["2015/"])))

for (i in 1:length(index(Cereal_04_exports_xts["2015/"]))) {
  Cereal_04_exports[i]<-sum(as.numeric(Cereal_04_exports_xts[i]),na.rm = TRUE)
}

Cereal_04_exports<-as.xts(t(Cereal_04_exports), order.by = Date)
colnames(Cereal_04_exports)<-c("Cereal_04")




#Vegetables and fruit (05)                                       

Veg_05<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Vegetables and fruit (05)") %>% select(-Countries.and.Territories,-Commodity.group))
Veg_05_exports_xts <- (as.xts(Veg_05, order.by=Date))
Veg_05_exports<-data.frame(NA, nrow=length(index(Veg_05_exports_xts["2015/"])))

for (i in 1:length(index(Veg_05_exports_xts["2015/"]))) {
  Veg_05_exports[i]<-sum(as.numeric(Veg_05_exports_xts[i]),na.rm = TRUE)
}

Veg_05_exports<-as.xts(t(Veg_05_exports), order.by = Date)
colnames(Veg_05_exports)<-c("Veg_05")


#Sugar, sugar preparations and honey (06)      
Sugar_06<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Sugar, sugar preparations and honey (06)") %>% select(-Countries.and.Territories,-Commodity.group))
Sugar_06_exports_xts <- (as.xts(Sugar_06, order.by=Date))
Sugar_06_exports<-data.frame(NA, nrow=length(index(Sugar_06_exports_xts["2015/"])))

for (i in 1:length(index(Sugar_06_exports_xts["2015/"]))) {
  Sugar_06_exports[i]<-sum(as.numeric(Sugar_06_exports_xts[i]),na.rm = TRUE)
}

Sugar_06_exports<-as.xts(t(Sugar_06_exports), order.by = Date)
colnames(Sugar_06_exports)<-c("Sugar_06")

#Coffee, tea, cocoa, spices and manufactures thereof (07)      
Coffee_07<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Coffee, tea, cocoa, spices and manufactures thereof (07)") %>% select(-Countries.and.Territories,-Commodity.group))
Coffee_07_exports_xts <- (as.xts(Coffee_07, order.by=Date))
Coffee_07_exports<-data.frame(NA, nrow=length(index(Coffee_07_exports_xts["2015/"])))

for (i in 1:length(index(Coffee_07_exports_xts["2015/"]))) {
  Coffee_07_exports[i]<-sum(as.numeric(Coffee_07_exports_xts[i]),na.rm = TRUE)
}

Coffee_07_exports<-as.xts(t(Coffee_07_exports), order.by = Date)
colnames(Coffee_07_exports)<-c("Coffee_07")






#Feeding stuffs for animals, excluding unmilled cereals (08)      
animal_feed_08<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Feeding stuffs for animals, excluding unmilled cereals (08)") %>% select(-Countries.and.Territories,-Commodity.group))
animal_feed_08_exports_xts <- (as.xts(animal_feed_08, order.by=Date))
animal_feed_08_exports<-data.frame(NA, nrow=length(index(animal_feed_08_exports_xts["2015/"])))

for (i in 1:length(index(animal_feed_08_exports_xts["2015/"]))) {
  animal_feed_08_exports[i]<-sum(as.numeric(animal_feed_08_exports_xts[i]),na.rm = TRUE)
}

animal_feed_08_exports<-as.xts(t(animal_feed_08_exports), order.by = Date)
colnames(animal_feed_08_exports)<-c("animal_feed_08")



#Feeding stuffs for animals, excluding unmilled cereals (08)      
animal_feed_08<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Feeding stuffs for animals, excluding unmilled cereals (08)") %>% select(-Countries.and.Territories,-Commodity.group))
animal_feed_08_exports_xts <- (as.xts(animal_feed_08, order.by=Date))
animal_feed_08_exports<-data.frame(NA, nrow=length(index(animal_feed_08_exports_xts["2015/"])))

for (i in 1:length(index(animal_feed_08_exports_xts["2015/"]))) {
  animal_feed_08_exports[i]<-sum(as.numeric(animal_feed_08_exports_xts[i]),na.rm = TRUE)
}

animal_feed_08_exports<-as.xts(t(animal_feed_08_exports), order.by = Date)
colnames(animal_feed_08_exports)<-c("animal_feed_08")


#Miscellaneous edible products and preparations (09)     
Miscellaneous_09<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Miscellaneous edible products and preparations (09)") %>% select(-Countries.and.Territories,-Commodity.group))
Miscellaneous_09_exports_xts <- (as.xts(Miscellaneous_09, order.by=Date))

Miscellaneous_09_exports<-data.frame(NA, nrow=length(index(Miscellaneous_09_exports_xts["2015/"])))

for (i in 1:length(index(Miscellaneous_09_exports_xts["2015/"]))) {
  Miscellaneous_09_exports[i]<-sum(as.numeric(Miscellaneous_09_exports_xts[i]),na.rm = TRUE)
}

Miscellaneous_09_exports<-as.xts(t(Miscellaneous_09_exports), order.by = Date)
colnames(Miscellaneous_09_exports)<-c("Miscellaneous_09")


#Beverages (11)                                                      
Beverages_11<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Beverages (11)") %>% select(-Countries.and.Territories,-Commodity.group))
Beverages_11_exports_xts <- (as.xts(Beverages_11, order.by=Date))

Beverages_11_exports<-data.frame(NA, nrow=length(index(Beverages_11_exports_xts["2015/"])))

for (i in 1:length(index(Beverages_11_exports_xts["2015/"]))) {
  Beverages_11_exports[i]<-sum(as.numeric(Beverages_11_exports_xts[i]),na.rm = TRUE)
}

Beverages_11_exports<-as.xts(t(Beverages_11_exports), order.by = Date)
colnames(Beverages_11_exports)<-c("Beverages_11")


#Tobacco and tobacco manufactures (12)                                                      
Tobacco_12<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Tobacco and tobacco manufactures (12)") %>% select(-Countries.and.Territories,-Commodity.group))
Tobacco_12_exports_xts <- (as.xts(Tobacco_12, order.by=Date))

Tobacco_12_exports<-data.frame(NA, nrow=length(index(Tobacco_12_exports_xts["2015/"])))

for (i in 1:length(index(Tobacco_12_exports_xts["2015/"]))) {
  Tobacco_12_exports[i]<-sum(as.numeric(Tobacco_12_exports_xts[i]),na.rm = TRUE)
}

Tobacco_12_exports<-as.xts(t(Tobacco_12_exports), order.by = Date)
colnames(Tobacco_12_exports)<-c("Tobacco_12")



#Hides, skins and furskins, raw (21)                                                      
Hides_21<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Hides, skins and furskins, raw (21)") %>% select(-Countries.and.Territories,-Commodity.group))
Hides_21_exports_xts <- (as.xts(Hides_21, order.by=Date))

Hides_21_exports<-data.frame(NA, nrow=length(index(Hides_21_exports_xts["2015/"])))

for (i in 1:length(index(Hides_21_exports_xts["2015/"]))) {
  Hides_21_exports[i]<-sum(as.numeric(Hides_21_exports_xts[i]),na.rm = TRUE)
}

Hides_21_exports<-as.xts(t(Hides_21_exports), order.by = Date)
colnames(Hides_21_exports)<-c("Hides_21")


#Oilseeds and oleaginous fruit (22)                                                      
oilseeds_22<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Oilseeds and oleaginous fruit (22)") %>% select(-Countries.and.Territories,-Commodity.group))
oilseeds_22_exports_xts <- (as.xts(oilseeds_22, order.by=Date))

oilseeds_22_exports<-data.frame(NA, nrow=length(index(oilseeds_22_exports_xts["2015/"])))

for (i in 1:length(index(oilseeds_22_exports_xts["2015/"]))) {
  oilseeds_22_exports[i]<-sum(as.numeric(oilseeds_22_exports_xts[i]),na.rm = TRUE)
}

oilseeds_22_exports<-as.xts(t(oilseeds_22_exports), order.by = Date)
colnames(oilseeds_22_exports)<-c("oilseeds_22")



# Crude rubber, including synthetic and reclaimed rubber (23)  

Crude_rubber_23<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Crude rubber, including synthetic and reclaimed rubber (23)") %>% select(-Countries.and.Territories,-Commodity.group))
Crude_rubber_23_exports_xts <- (as.xts(Crude_rubber_23, order.by=Date))

Crude_rubber_23_exports<-data.frame(NA, nrow=length(index(Crude_rubber_23_exports_xts["2015/"])))

for (i in 1:length(index(Crude_rubber_23_exports_xts["2015/"]))) {
  Crude_rubber_23_exports[i]<-sum(as.numeric(Crude_rubber_23_exports_xts[i]),na.rm = TRUE)
}

Crude_rubber_23_exports<-as.xts(t(Crude_rubber_23_exports), order.by = Date)
colnames(Crude_rubber_23_exports)<-c("Crude_rubber_23")


# Cork and wood (24)

Cork_24<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Cork and wood (24)") %>% select(-Countries.and.Territories,-Commodity.group))
Cork_24_exports_xts <- (as.xts(Cork_24, order.by=Date))

Cork_24_exports<-data.frame(NA, nrow=length(index(Cork_24_exports_xts["2015/"])))

for (i in 1:length(index(Cork_24_exports_xts["2015/"]))) {
  Cork_24_exports[i]<-sum(as.numeric(Cork_24_exports_xts[i]),na.rm = TRUE)
}

Cork_24_exports<-as.xts(t(Cork_24_exports), order.by = Date)
colnames(Cork_24_exports)<-c("Cork_24")


# Pulp and waste paper (25)" 

Pulp_25<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Pulp and waste paper (25)") %>% select(-Countries.and.Territories,-Commodity.group))
Pulp_25_exports_xts <- (as.xts(Pulp_25, order.by=Date))

Pulp_25_exports<-data.frame(NA, nrow=length(index(Pulp_25_exports_xts["2015/"])))

for (i in 1:length(index(Pulp_25_exports_xts["2015/"]))) {
  Pulp_25_exports[i]<-sum(as.numeric(Pulp_25_exports_xts[i]),na.rm = TRUE)
}

Pulp_25_exports<-as.xts(t(Pulp_25_exports), order.by = Date)
colnames(Pulp_25_exports)<-c("Pulp_25")


# Textile fibres, excluding wool tops, and their wastes (26) 

Textile_fibres_26<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Textile fibres, excluding wool tops, and their wastes (26)") %>% select(-Countries.and.Territories,-Commodity.group))
Textile_fibres_26_exports_xts <- (as.xts(Textile_fibres_26, order.by=Date))

Textile_fibres_26_exports<-data.frame(NA, nrow=length(index(Textile_fibres_26_exports_xts["2015/"])))

for (i in 1:length(index(Textile_fibres_26_exports_xts["2015/"]))) {
  Textile_fibres_26_exports[i]<-sum(as.numeric(Textile_fibres_26_exports_xts[i]),na.rm = TRUE)
}

Textile_fibres_26_exports<-as.xts(t(Textile_fibres_26_exports), order.by = Date)
colnames(Textile_fibres_26_exports)<-c("Textile_fibres_26")



# Crude fertilisers and minerals, excluding coal, petroleum etc. (27)

Crude_fertilisers_27<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Crude fertilisers and minerals, excluding coal, petroleum etc. (27)") %>% select(-Countries.and.Territories,-Commodity.group))
Crude_fertilisers_27_exports_xts <- (as.xts(Crude_fertilisers_27, order.by=Date))

Crude_fertilisers_27_exports<-data.frame(NA, nrow=length(index(Crude_fertilisers_27_exports_xts["2015/"])))

for (i in 1:length(index(Crude_fertilisers_27_exports_xts["2015/"]))) {
  Crude_fertilisers_27_exports[i]<-sum(as.numeric(Crude_fertilisers_27_exports_xts[i]),na.rm = TRUE)
}

Crude_fertilisers_27_exports<-as.xts(t(Crude_fertilisers_27_exports), order.by = Date)
colnames(Crude_fertilisers_27_exports)<-c("Crude_fertilisers_27")




# Metalliferous ores and metal scrap (28)

Metalliferous_ores_28<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Metalliferous ores and metal scrap (28)") %>% select(-Countries.and.Territories,-Commodity.group))
Metalliferous_ores_28_exports_xts <- (as.xts(Metalliferous_ores_28, order.by=Date))

Metalliferous_ores_28_exports<-data.frame(NA, nrow=length(index(Metalliferous_ores_28_exports_xts["2015/"])))

for (i in 1:length(index(Metalliferous_ores_28_exports_xts["2015/"]))) {
  Metalliferous_ores_28_exports[i]<-sum(as.numeric(Metalliferous_ores_28_exports_xts[i]),na.rm = TRUE)
}

Metalliferous_ores_28_exports<-as.xts(t(Metalliferous_ores_28_exports), order.by = Date)
colnames(Metalliferous_ores_28_exports)<-c("Metalliferous_ores_28")

# Crude animal and vegetable materials, n.e.s. (29)

Crude_animal_and_vegetable_materials_29<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Crude animal and vegetable materials, n.e.s. (29)") %>% select(-Countries.and.Territories,-Commodity.group))
Crude_animal_and_vegetable_materials_29_exports_xts <- (as.xts(Crude_animal_and_vegetable_materials_29, order.by=Date))

Crude_animal_and_vegetable_materials_29_exports<-data.frame(NA, nrow=length(index(Crude_animal_and_vegetable_materials_29_exports_xts["2015/"])))

for (i in 1:length(index(Crude_animal_and_vegetable_materials_29_exports_xts["2015/"]))) {
  Crude_animal_and_vegetable_materials_29_exports[i]<-sum(as.numeric(Crude_animal_and_vegetable_materials_29_exports_xts[i]),na.rm = TRUE)
}

Crude_animal_and_vegetable_materials_29_exports<-as.xts(t(Crude_animal_and_vegetable_materials_29_exports), order.by = Date)
colnames(Crude_animal_and_vegetable_materials_29_exports)<-c("Crude_animal_and_vegetable_materials_29")



# Coal, coke and briquettes (32)

Coal_32<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Coal, coke and briquettes (32)") %>% select(-Countries.and.Territories,-Commodity.group))
Coal_32_exports_xts <- (as.xts(Coal_32, order.by=Date))

Coal_32_exports<-data.frame(NA, nrow=length(index(Coal_32_exports_xts["2015/"])))

for (i in 1:length(index(Coal_32_exports_xts["2015/"]))) {
  Coal_32_exports[i]<-sum(as.numeric(Coal_32_exports_xts[i]),na.rm = TRUE)
}

Coal_32_exports<-as.xts(t(Coal_32_exports), order.by = Date)
colnames(Coal_32_exports)<-c("Coal_32_exports")


# Petroleum, petroleum products and related materials (33)

Petroleum_33<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Petroleum, petroleum products and related materials (33)") %>% select(-Countries.and.Territories,-Commodity.group))
Petroleum_33_exports_xts <- (as.xts(Petroleum_33, order.by=Date))

Petroleum_33_exports<-data.frame(NA, nrow=length(index(Petroleum_33_exports_xts["2015/"])))

for (i in 1:length(index(Petroleum_33_exports_xts["2015/"]))) {
  Petroleum_33_exports[i]<-sum(as.numeric(Petroleum_33_exports_xts[i]),na.rm = TRUE)
}

Petroleum_33_exports<-as.xts(t(Petroleum_33_exports), order.by = Date)
colnames(Petroleum_33_exports)<-c("Petroleum_33")

# Gas, natural and manufactured (34)

Gas_34<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Gas, natural and manufactured (34)") %>% select(-Countries.and.Territories,-Commodity.group))
Gas_34_exports_xts <- (as.xts(Gas_34, order.by=Date))

Gas_34_exports<-data.frame(NA, nrow=length(index(Gas_34_exports_xts["2015/"])))

for (i in 1:length(index(Gas_34_exports_xts["2015/"]))) {
  Gas_34_exports[i]<-sum(as.numeric(Gas_34_exports_xts[i]),na.rm = TRUE)
}

Gas_34_exports<-as.xts(t(Gas_34_exports), order.by = Date)
colnames(Gas_34_exports)<-c("Gas_34")


# Electric current (35)

Electric_current_35<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Electric current (35)") %>% select(-Countries.and.Territories,-Commodity.group))
Electric_current_35_exports_xts <- (as.xts(Electric_current_35, order.by=Date))

Electric_current_35_exports<-data.frame(NA, nrow=length(index(Electric_current_35_exports_xts["2015/"])))

for (i in 1:length(index(Electric_current_35_exports_xts["2015/"]))) {
  Electric_current_35_exports[i]<-sum(as.numeric(Electric_current_35_exports_xts[i]),na.rm = TRUE)
}

Electric_current_35_exports<-as.xts(t(Electric_current_35_exports), order.by = Date)
colnames(Electric_current_35_exports)<-c("Electric_current_35")

# Animal oils and fats (41)

Animal_oils_and_fats_41<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Animal oils and fats (41)") %>% select(-Countries.and.Territories,-Commodity.group))
Animal_oils_and_fats_41_exports_xts <- (as.xts(Animal_oils_and_fats_41, order.by=Date))

Animal_oils_and_fats_41_exports<-data.frame(NA, nrow=length(index(Animal_oils_and_fats_41_exports_xts["2015/"])))

for (i in 1:length(index(Animal_oils_and_fats_41_exports_xts["2015/"]))) {
  Animal_oils_and_fats_41_exports[i]<-sum(as.numeric(Animal_oils_and_fats_41_exports_xts[i]),na.rm = TRUE)
}

Animal_oils_and_fats_41_exports<-as.xts(t(Animal_oils_and_fats_41_exports), order.by = Date)
colnames(Animal_oils_and_fats_41_exports)<-c("Animal_oils_and_fats_41")

# Fixed vegetable oils and fats (42)

Fixed_vegetable_oils_and_fats_42<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Fixed vegetable oils and fats (42)") %>% select(-Countries.and.Territories,-Commodity.group))
Fixed_vegetable_oils_and_fats_42_exports_xts <- (as.xts(Fixed_vegetable_oils_and_fats_42, order.by=Date))

Fixed_vegetable_oils_and_fats_42_exports<-data.frame(NA, nrow=length(index(Fixed_vegetable_oils_and_fats_42_exports_xts["2015/"])))

for (i in 1:length(index(Fixed_vegetable_oils_and_fats_42_exports_xts["2015/"]))) {
  Fixed_vegetable_oils_and_fats_42_exports[i]<-sum(as.numeric(Fixed_vegetable_oils_and_fats_42_exports_xts[i]),na.rm = TRUE)
}

Fixed_vegetable_oils_and_fats_42_exports<-as.xts(t(Fixed_vegetable_oils_and_fats_42_exports), order.by = Date)
colnames(Fixed_vegetable_oils_and_fats_42_exports)<-c("Fixed_vegetable_oils_and_fats_42")

# Animal and vegetable oils and fats, processed, and waxes (43)

Animal_and_vegetable_oils_43<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Animal and vegetable oils and fats, processed, and waxes (43)") %>% select(-Countries.and.Territories,-Commodity.group))
Animal_and_vegetable_oils_43_exports_xts <- (as.xts(Animal_and_vegetable_oils_43, order.by=Date))

Animal_and_vegetable_oils_43_exports<-data.frame(NA, nrow=length(index(Animal_and_vegetable_oils_43_exports_xts["2015/"])))

for (i in 1:length(index(Animal_and_vegetable_oils_43_exports_xts["2015/"]))) {
  Animal_and_vegetable_oils_43_exports[i]<-sum(as.numeric(Animal_and_vegetable_oils_43_exports_xts[i]),na.rm = TRUE)
}

Animal_and_vegetable_oils_43_exports<-as.xts(t(Animal_and_vegetable_oils_43_exports), order.by = Date)
colnames(Animal_and_vegetable_oils_43_exports)<-c("Animal_and_vegetable_oils_43")

# Organic chemicals (51)

Organic_chemicals_51<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Organic chemicals (51)") %>% select(-Countries.and.Territories,-Commodity.group))
Organic_chemicals_51_exports_xts <- (as.xts(Organic_chemicals_51, order.by=Date))

Organic_chemicals_51_exports<-data.frame(NA, nrow=length(index(Organic_chemicals_51_exports_xts["2015/"])))

for (i in 1:length(index(Organic_chemicals_51_exports_xts["2015/"]))) {
  Organic_chemicals_51_exports[i]<-sum(as.numeric(Organic_chemicals_51_exports_xts[i]),na.rm = TRUE)
}

Organic_chemicals_51_exports<-as.xts(t(Organic_chemicals_51_exports), order.by = Date)
colnames(Organic_chemicals_51_exports)<-c("Organic_chemicals_51")


# Inorganic chemicals (52)

Inorganic_chemicals_52<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Inorganic chemicals (52)") %>% select(-Countries.and.Territories,-Commodity.group))
Inorganic_chemicals_52_exports_xts <- (as.xts(Inorganic_chemicals_52, order.by=Date))

Inorganic_chemicals_52_exports<-data.frame(NA, nrow=length(index(Inorganic_chemicals_52_exports_xts["2015/"])))

for (i in 1:length(index(Inorganic_chemicals_52_exports_xts["2015/"]))) {
  Inorganic_chemicals_52_exports[i]<-sum(as.numeric(Inorganic_chemicals_52_exports_xts[i]),na.rm = TRUE)
}

Inorganic_chemicals_52_exports<-as.xts(t(Inorganic_chemicals_52_exports), order.by = Date)
colnames(Inorganic_chemicals_52_exports)<-c("Inorganic_chemicals_52")



#Dyeing, tanning and colouring materials (53)

Dyeing_tanning_53<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Dyeing, tanning and colouring materials (53)") %>% select(-Countries.and.Territories,-Commodity.group))
Dyeing_tanning_53_exports_xts <- (as.xts(Dyeing_tanning_53, order.by=Date))

Dyeing_tanning_53_exports<-data.frame(NA, nrow=length(index(Dyeing_tanning_53_exports_xts["2015/"])))

for (i in 1:length(index(Dyeing_tanning_53_exports_xts["2015/"]))) {
  Dyeing_tanning_53_exports[i]<-sum(as.numeric(Dyeing_tanning_53_exports_xts[i]),na.rm = TRUE)
}

Dyeing_tanning_53_exports<-as.xts(t(Dyeing_tanning_53_exports), order.by = Date)
colnames(Dyeing_tanning_53_exports)<-c("Dyeing_tanning_53")



#Medicinal and pharmaceutical products (54)

Medicinal_and_pharma_54<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Medicinal and pharmaceutical products (54)") %>% select(-Countries.and.Territories,-Commodity.group))
Medicinal_and_pharma_54_exports_xts <- (as.xts(Medicinal_and_pharma_54, order.by=Date))

Medicinal_and_pharma_54_exports<-data.frame(NA, nrow=length(index(Medicinal_and_pharma_54_exports_xts["2015/"])))

for (i in 1:length(index(Medicinal_and_pharma_54_exports_xts["2015/"]))) {
  Medicinal_and_pharma_54_exports[i]<-sum(as.numeric(Medicinal_and_pharma_54_exports_xts[i]),na.rm = TRUE)
}

Medicinal_and_pharma_54_exports<-as.xts(t(Medicinal_and_pharma_54_exports), order.by = Date)
colnames(Medicinal_and_pharma_54_exports)<-c("Medicinal_and_pharma_54")




#Essential oils, perfume materials, toilet preparations etc. (55) 

Essential_oils_55<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Essential oils, perfume materials, toilet preparations etc. (55)") %>% select(-Countries.and.Territories,-Commodity.group))
Essential_oils_55_exports_xts <- (as.xts(Essential_oils_55, order.by=Date))

Essential_oils_55_exports<-data.frame(NA, nrow=length(index(Essential_oils_55_exports_xts["2015/"])))

for (i in 1:length(index(Essential_oils_55_exports_xts["2015/"]))) {
  Essential_oils_55_exports[i]<-sum(as.numeric(Essential_oils_55_exports_xts[i]),na.rm = TRUE)
}

Essential_oils_55_exports<-as.xts(t(Essential_oils_55_exports), order.by = Date)
colnames(Essential_oils_55_exports)<-c("Essential_oils_55")


#Fertilisers, manufactured (56)
Fertilisers_56<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Fertilisers, manufactured (56)") %>% select(-Countries.and.Territories,-Commodity.group))
Fertilisers_56_exports_xts <- (as.xts(Fertilisers_56, order.by=Date))

Fertilisers_56_exports<-data.frame(NA, nrow=length(index(Fertilisers_56_exports_xts["2015/"])))

for (i in 1:length(index(Fertilisers_56_exports_xts["2015/"]))) {
  Fertilisers_56_exports[i]<-sum(as.numeric(Fertilisers_56_exports_xts[i]),na.rm = TRUE)
}

Fertilisers_56_exports<-as.xts(t(Fertilisers_56_exports), order.by = Date)
colnames(Fertilisers_56_exports)<-c("Fertilisers_56")



#Plastics in primary forms (57)
Plastics_57<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Plastics in primary forms (57)") %>% select(-Countries.and.Territories,-Commodity.group))
Plastics_57_exports_xts <- (as.xts(Plastics_57, order.by=Date))

Plastics_57_exports<-data.frame(NA, nrow=length(index(Plastics_57_exports_xts["2015/"])))

for (i in 1:length(index(Plastics_57_exports_xts["2015/"]))) {
  Plastics_57_exports[i]<-sum(as.numeric(Plastics_57_exports_xts[i]),na.rm = TRUE)
}

Plastics_57_exports<-as.xts(t(Plastics_57_exports), order.by = Date)
colnames(Plastics_57_exports)<-c("Plastics_57")



#Plastics in non-primary forms (58)
Plastics_non_primary_58<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Plastics in non-primary forms (58)") %>% select(-Countries.and.Territories,-Commodity.group))
Plastics_non_primary_58_exports_xts <- (as.xts(Plastics_non_primary_58, order.by=Date))

Plastics_non_primary_58_exports<-data.frame(NA, nrow=length(index(Plastics_non_primary_58_exports_xts["2015/"])))

for (i in 1:length(index(Plastics_non_primary_58_exports_xts["2015/"]))) {
  Plastics_non_primary_58_exports[i]<-sum(as.numeric(Plastics_non_primary_58_exports_xts[i]),na.rm = TRUE)
}

Plastics_non_primary_58_exports<-as.xts(t(Plastics_non_primary_58_exports), order.by = Date)
colnames(Plastics_non_primary_58_exports)<-c("Plastics_non_primary_58")


#Chemical materials and products, n.e.s. (59)
Chemical_materials_59<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Chemical materials and products, n.e.s. (59)") %>% select(-Countries.and.Territories,-Commodity.group))
Chemical_materials_59_exports_xts <- (as.xts(Chemical_materials_59, order.by=Date))

Chemical_materials_59_exports<-data.frame(NA, nrow=length(index(Chemical_materials_59_exports_xts["2015/"])))

for (i in 1:length(index(Chemical_materials_59_exports_xts["2015/"]))) {
  Chemical_materials_59_exports[i]<-sum(as.numeric(Chemical_materials_59_exports_xts[i]),na.rm = TRUE)
}

Chemical_materials_59_exports<-as.xts(t(Chemical_materials_59_exports), order.by = Date)
colnames(Chemical_materials_59_exports)<-c("Chemical_materials_59")


#Leather, leather manufactures and dressed furskins (61)
Leather_61<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Leather, leather manufactures and dressed furskins (61)") %>% select(-Countries.and.Territories,-Commodity.group))
Leather_61_exports_xts <- (as.xts(Leather_61, order.by=Date))

Leather_61_exports<-data.frame(NA, nrow=length(index(Leather_61_exports_xts["2015/"])))

for (i in 1:length(index(Leather_61_exports_xts["2015/"]))) {
  Leather_61_exports[i]<-sum(as.numeric(Leather_61_exports_xts[i]),na.rm = TRUE)
}

Leather_61_exports<-as.xts(t(Leather_61_exports), order.by = Date)
colnames(Leather_61_exports)<-c("Leather_61")



#Rubber manufactures, n.e.s. (62)
Rubber_manufactures_62<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Rubber manufactures, n.e.s. (62)") %>% select(-Countries.and.Territories,-Commodity.group))
Rubber_manufactures_62_exports_xts <- (as.xts(Rubber_manufactures_62, order.by=Date))

Rubber_manufactures_62_exports<-data.frame(NA, nrow=length(index(Rubber_manufactures_62_exports_xts["2015/"])))

for (i in 1:length(index(Rubber_manufactures_62_exports_xts["2015/"]))) {
  Rubber_manufactures_62_exports[i]<-sum(as.numeric(Rubber_manufactures_62_exports_xts[i]),na.rm = TRUE)
}

Rubber_manufactures_62_exports<-as.xts(t(Rubber_manufactures_62_exports), order.by = Date)
colnames(Rubber_manufactures_62_exports)<-c("Rubber_manufactures_62")




#Cork and wood manufactures, excluding furniture (63)
Cork_and_wood_manufactures_63<-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Cork and wood manufactures, excluding furniture (63)") %>% select(-Countries.and.Territories,-Commodity.group))
Cork_and_wood_manufactures_63_exports_xts <- (as.xts(Cork_and_wood_manufactures_63, order.by=Date))

Cork_and_wood_manufactures_63_exports<-data.frame(NA, nrow=length(index(Cork_and_wood_manufactures_63_exports_xts["2015/"])))

for (i in 1:length(index(Cork_and_wood_manufactures_63_exports_xts["2015/"]))) {
  Cork_and_wood_manufactures_63_exports[i]<-sum(as.numeric(Cork_and_wood_manufactures_63_exports_xts[i]),na.rm = TRUE)
}

Cork_and_wood_manufactures_63_exports<-as.xts(t(Cork_and_wood_manufactures_63_exports), order.by = Date)
colnames(Cork_and_wood_manufactures_63_exports)<-c("Cork_and_wood_manufactures_63")



#Paper, paperboard and articles of paper pulp, paper etc. (64)       
Paper_paperboard_64 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Paper, paperboard and articles of paper pulp, paper etc. (64)") %>% select(-Countries.and.Territories,-Commodity.group))
Paper_paperboard_64_exports_xts <- (as.xts(Paper_paperboard_64, order.by=Date))

Paper_paperboard_64_exports<-data.frame(NA, nrow=length(index(Paper_paperboard_64_exports_xts["2015/"])))

for (i in 1:length(index(Paper_paperboard_64_exports_xts["2015/"]))) {
  Paper_paperboard_64_exports[i]<-sum(as.numeric(Paper_paperboard_64_exports_xts[i]),na.rm = TRUE)
}

Paper_paperboard_64_exports<-as.xts(t(Paper_paperboard_64_exports), order.by = Date)
colnames(Paper_paperboard_64_exports)<-c("Paper_paperboard_64")


#Textile yarn, fabrics, made-up articles and related products (65) 

Textile_yarn_65 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Textile yarn, fabrics, made-up articles and related products (65)") %>% select(-Countries.and.Territories,-Commodity.group))
Textile_yarn_65_exports_xts <- (as.xts(Textile_yarn_65, order.by=Date))

Textile_yarn_65_exports<-data.frame(NA, nrow=length(index(Textile_yarn_65_exports_xts["2015/"])))

for (i in 1:length(index(Textile_yarn_65_exports_xts["2015/"]))) {
  Textile_yarn_65_exports[i]<-sum(as.numeric(Textile_yarn_65_exports_xts[i]),na.rm = TRUE)
}

Textile_yarn_65_exports<-as.xts(t(Textile_yarn_65_exports), order.by = Date)
colnames(Textile_yarn_65_exports)<-c("Textile_yarn_65")




#Non-metallic mineral manufactures, n.e.s. (66)  

Non_metallic_mineral_66 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Non-metallic mineral manufactures, n.e.s. (66)") %>% select(-Countries.and.Territories,-Commodity.group))
Non_metallic_mineral_66_exports_xts <- (as.xts(Non_metallic_mineral_66, order.by=Date))

Non_metallic_mineral_66_exports<-data.frame(NA, nrow=length(index(Non_metallic_mineral_66_exports_xts["2015/"])))

for (i in 1:length(index(Non_metallic_mineral_66_exports_xts["2015/"]))) {
  Non_metallic_mineral_66_exports[i]<-sum(as.numeric(Non_metallic_mineral_66_exports_xts[i]),na.rm = TRUE)
}

Non_metallic_mineral_66_exports<-as.xts(t(Non_metallic_mineral_66_exports), order.by = Date)
colnames(Non_metallic_mineral_66_exports)<-c("Non_metallic_mineral_66")




#Iron and steel (67)
Iron_and_steel_67 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Iron and steel (67)") %>% select(-Countries.and.Territories,-Commodity.group))
Iron_and_steel_67_exports_xts <- (as.xts(Iron_and_steel_67, order.by=Date))

Iron_and_steel_67_exports<-data.frame(NA, nrow=length(index(Iron_and_steel_67_exports_xts["2015/"])))

for (i in 1:length(index(Iron_and_steel_67_exports_xts["2015/"]))) {
  Iron_and_steel_67_exports[i]<-sum(as.numeric(Iron_and_steel_67_exports_xts[i]),na.rm = TRUE)
}

Iron_and_steel_67_exports<-as.xts(t(Iron_and_steel_67_exports), order.by = Date)
colnames(Iron_and_steel_67_exports)<-c("Iron_and_steel_67")

#Non-ferrous metals (68)                                             
Non_ferrous_metals_68 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Non-ferrous metals (68)") %>% select(-Countries.and.Territories,-Commodity.group))
Non_ferrous_metals_68_exports_xts <- (as.xts(Non_ferrous_metals_68, order.by=Date))

Non_ferrous_metals_68_exports<-data.frame(NA, nrow=length(index(Non_ferrous_metals_68_exports_xts["2015/"])))

for (i in 1:length(index(Non_ferrous_metals_68_exports_xts["2015/"]))) {
  Non_ferrous_metals_68_exports[i]<-sum(as.numeric(Non_ferrous_metals_68_exports_xts[i]),na.rm = TRUE)
}

Non_ferrous_metals_68_exports<-as.xts(t(Non_ferrous_metals_68_exports), order.by = Date)
colnames(Non_ferrous_metals_68_exports)<-c("Non_ferrous_metals_68")



#Manufactures of metal, n.e.s. (69)
Manufactures_of_metal_69 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Manufactures of metal, n.e.s. (69)") %>% select(-Countries.and.Territories,-Commodity.group))
Manufactures_of_metal_69_exports_xts <- (as.xts(Manufactures_of_metal_69, order.by=Date))

Manufactures_of_metal_69_exports<-data.frame(NA, nrow=length(index(Manufactures_of_metal_69_exports_xts["2015/"])))

for (i in 1:length(index(Manufactures_of_metal_69_exports_xts["2015/"]))) {
  Manufactures_of_metal_69_exports[i]<-sum(as.numeric(Manufactures_of_metal_69_exports_xts[i]),na.rm = TRUE)
}

Manufactures_of_metal_69_exports<-as.xts(t(Manufactures_of_metal_69_exports), order.by = Date)
colnames(Manufactures_of_metal_69_exports)<-c("Manufactures_of_metal_69")



#Power generating machinery and equipment (71)

Power_generating_machinery_71 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Power generating machinery and equipment (71)") %>% select(-Countries.and.Territories,-Commodity.group))
Power_generating_machinery_71_exports_xts <- (as.xts(Power_generating_machinery_71, order.by=Date))

Power_generating_machinery_71_exports<-data.frame(NA, nrow=length(index(Power_generating_machinery_71_exports_xts["2015/"])))

for (i in 1:length(index(Power_generating_machinery_71_exports_xts["2015/"]))) {
  Power_generating_machinery_71_exports[i]<-sum(as.numeric(Power_generating_machinery_71_exports_xts[i]),na.rm = TRUE)
}

Power_generating_machinery_71_exports<-as.xts(t(Power_generating_machinery_71_exports), order.by = Date)
colnames(Power_generating_machinery_71_exports)<-c("Power_generating_machinery_71")


#Machinery specialised for particular industries (72)

Machinery_specialised_for_particular_industries_72 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Machinery specialised for particular industries (72)") %>% select(-Countries.and.Territories,-Commodity.group))
Machinery_specialised_for_particular_industries_72_exports_xts <- (as.xts(Machinery_specialised_for_particular_industries_72, order.by=Date))

Machinery_specialised_for_particular_industries_72_exports<-data.frame(NA, nrow=length(index(Machinery_specialised_for_particular_industries_72_exports_xts["2015/"])))

for (i in 1:length(index(Machinery_specialised_for_particular_industries_72_exports_xts["2015/"]))) {
  Machinery_specialised_for_particular_industries_72_exports[i]<-sum(as.numeric(Machinery_specialised_for_particular_industries_72_exports_xts[i]),na.rm = TRUE)
}

Machinery_specialised_for_particular_industries_72_exports<-as.xts(t(Machinery_specialised_for_particular_industries_72_exports), order.by = Date)
colnames(Machinery_specialised_for_particular_industries_72_exports)<-c("Machinery_specialised_for_particular_industries_72")


#Metalworking machinery (73)

Metalworking_machinery_73 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Metalworking machinery (73)") %>% select(-Countries.and.Territories,-Commodity.group))
Metalworking_machinery_73_exports_xts <- (as.xts(Metalworking_machinery_73, order.by=Date))

Metalworking_machinery_73_exports<-data.frame(NA, nrow=length(index(Metalworking_machinery_73_exports_xts["2015/"])))

for (i in 1:length(index(Metalworking_machinery_73_exports_xts["2015/"]))) {
  Metalworking_machinery_73_exports[i]<-sum(as.numeric(Metalworking_machinery_73_exports_xts[i]),na.rm = TRUE)
}

Metalworking_machinery_73_exports<-as.xts(t(Metalworking_machinery_73_exports), order.by = Date)
colnames(Metalworking_machinery_73_exports)<-c("Metalworking_machinery_73")


#General industrial machinery and parts, n.e.s. (74)


General_industrial_machinery_74 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="General industrial machinery and parts, n.e.s. (74)") %>% select(-Countries.and.Territories,-Commodity.group))
General_industrial_machinery_74_exports_xts <- (as.xts(General_industrial_machinery_74, order.by=Date))

General_industrial_machinery_74_exports<-data.frame(NA, nrow=length(index(General_industrial_machinery_74_exports_xts["2015/"])))

for (i in 1:length(index(General_industrial_machinery_74_exports_xts["2015/"]))) {
  General_industrial_machinery_74_exports[i]<-sum(as.numeric(General_industrial_machinery_74_exports_xts[i]),na.rm = TRUE)
}

General_industrial_machinery_74_exports<-as.xts(t(General_industrial_machinery_74_exports), order.by = Date)
colnames(General_industrial_machinery_74_exports)<-c("General_industrial_machinery_74")




#Office machines and automatic data processing equipment (75)


Office_machines_and_automatic_data_processing_equipment_75 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Office machines and automatic data processing equipment (75)") %>% select(-Countries.and.Territories,-Commodity.group))
Office_machines_and_automatic_data_processing_equipment_75_exports_xts <- (as.xts(Office_machines_and_automatic_data_processing_equipment_75, order.by=Date))

Office_machines_and_automatic_data_processing_equipment_75_exports<-data.frame(NA, nrow=length(index(Office_machines_and_automatic_data_processing_equipment_75_exports_xts["2015/"])))

for (i in 1:length(index(Office_machines_and_automatic_data_processing_equipment_75_exports_xts["2015/"]))) {
  Office_machines_and_automatic_data_processing_equipment_75_exports[i]<-sum(as.numeric(Office_machines_and_automatic_data_processing_equipment_75_exports_xts[i]),na.rm = TRUE)
}

Office_machines_and_automatic_data_processing_equipment_75_exports<-as.xts(t(Office_machines_and_automatic_data_processing_equipment_75_exports), order.by = Date)
colnames(Office_machines_and_automatic_data_processing_equipment_75_exports)<-c("Office_machines_and_automatic_data_processing_equipment_75")


#Telecommunications and sound recording, reproducing equipment (76)


Telecommunications_and_sound_recording_76 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Telecommunications and sound recording, reproducing equipment (76)") %>% select(-Countries.and.Territories,-Commodity.group))
Telecommunications_and_sound_recording_76_exports_xts <- (as.xts(Telecommunications_and_sound_recording_76, order.by=Date))

Telecommunications_and_sound_recording_76_exports<-data.frame(NA, nrow=length(index(Telecommunications_and_sound_recording_76_exports_xts["2015/"])))

for (i in 1:length(index(Telecommunications_and_sound_recording_76_exports_xts["2015/"]))) {
  Telecommunications_and_sound_recording_76_exports[i]<-sum(as.numeric(Telecommunications_and_sound_recording_76_exports_xts[i]),na.rm = TRUE)
}

Telecommunications_and_sound_recording_76_exports<-as.xts(t(Telecommunications_and_sound_recording_76_exports), order.by = Date)
colnames(Telecommunications_and_sound_recording_76_exports)<-c("Telecommunications_and_sound_recording_76")



#Electrical machinery, appliances etc., n.e.s. (77)                  


Electrical_machinery_77 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Electrical machinery, appliances etc., n.e.s. (77)") %>% select(-Countries.and.Territories,-Commodity.group))
Electrical_machinery_77_exports_xts <- (as.xts(Electrical_machinery_77, order.by=Date))

Electrical_machinery_77_exports<-data.frame(NA, nrow=length(index(Electrical_machinery_77_exports_xts["2015/"])))

for (i in 1:length(index(Electrical_machinery_77_exports_xts["2015/"]))) {
  Electrical_machinery_77_exports[i]<-sum(as.numeric(Electrical_machinery_77_exports_xts[i]),na.rm = TRUE)
}

Electrical_machinery_77_exports<-as.xts(t(Electrical_machinery_77_exports), order.by = Date)
colnames(Electrical_machinery_77_exports)<-c("Electrical_machinery_77")





#Road vehicles (78)


Road_vehicles_78 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Road vehicles (78)") %>% select(-Countries.and.Territories,-Commodity.group))
Road_vehicles_78_exports_xts <- (as.xts(Road_vehicles_78, order.by=Date))

Road_vehicles_78_exports<-data.frame(NA, nrow=length(index(Road_vehicles_78_exports_xts["2015/"])))

for (i in 1:length(index(Road_vehicles_78_exports_xts["2015/"]))) {
  Road_vehicles_78_exports[i]<-sum(as.numeric(Road_vehicles_78_exports_xts[i]),na.rm = TRUE)
}

Road_vehicles_78_exports<-as.xts(t(Road_vehicles_78_exports), order.by = Date)
colnames(Road_vehicles_78_exports)<-c("Road_vehicles_78")





#Other transport equipment (79)      

Other_transport_equipment_79 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Other transport equipment (79)") %>% select(-Countries.and.Territories,-Commodity.group))
Other_transport_equipment_79_exports_xts <- (as.xts(Other_transport_equipment_79, order.by=Date))

Other_transport_equipment_79_exports<-data.frame(NA, nrow=length(index(Other_transport_equipment_79_exports_xts["2015/"])))

for (i in 1:length(index(Other_transport_equipment_79_exports_xts["2015/"]))) {
  Other_transport_equipment_79_exports[i]<-sum(as.numeric(Other_transport_equipment_79_exports_xts[i]),na.rm = TRUE)
}

Other_transport_equipment_79_exports<-as.xts(t(Other_transport_equipment_79_exports), order.by = Date)
colnames(Other_transport_equipment_79_exports)<-c("Other_transport_equipment_79")


#Prefab buildings; plumbing and electrical fixtures and fittings (81)

Prefab_buildings_plumbing_and_electrical_81 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Prefab buildings; plumbing and electrical fixtures and fittings (81)") %>% select(-Countries.and.Territories,-Commodity.group))
Prefab_buildings_plumbing_and_electrical_81_exports_xts <- (as.xts(Prefab_buildings_plumbing_and_electrical_81, order.by=Date))

Prefab_buildings_plumbing_and_electrical_81_exports<-data.frame(NA, nrow=length(index(Prefab_buildings_plumbing_and_electrical_81_exports_xts["2015/"])))

for (i in 1:length(index(Prefab_buildings_plumbing_and_electrical_81_exports_xts["2015/"]))) {
  Prefab_buildings_plumbing_and_electrical_81_exports[i]<-sum(as.numeric(Prefab_buildings_plumbing_and_electrical_81_exports_xts[i]),na.rm = TRUE)
}

Prefab_buildings_plumbing_and_electrical_81_exports<-as.xts(t(Prefab_buildings_plumbing_and_electrical_81_exports), order.by = Date)
colnames(Prefab_buildings_plumbing_and_electrical_81_exports)<-c("Prefab_buildings_plumbing_and_electrical_81")



#Furniture and parts thereof (82)
Furniture_and_parts_thereof_82 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Furniture and parts thereof (82)") %>% select(-Countries.and.Territories,-Commodity.group))
Furniture_and_parts_thereof_82_exports_xts <- (as.xts(Furniture_and_parts_thereof_82, order.by=Date))

Furniture_and_parts_thereof_82_exports<-data.frame(NA, nrow=length(index(Furniture_and_parts_thereof_82_exports_xts["2015/"])))

for (i in 1:length(index(Furniture_and_parts_thereof_82_exports_xts["2015/"]))) {
  Furniture_and_parts_thereof_82_exports[i]<-sum(as.numeric(Furniture_and_parts_thereof_82_exports_xts[i]),na.rm = TRUE)
}

Furniture_and_parts_thereof_82_exports<-as.xts(t(Furniture_and_parts_thereof_82_exports), order.by = Date)
colnames(Furniture_and_parts_thereof_82_exports)<-c("Furniture_and_parts_thereof_82")




#Travel goods, handbags and similar containers (83)
Travel_goods_handbags_and_similar_containers_83 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Travel goods, handbags and similar containers (83)") %>% select(-Countries.and.Territories,-Commodity.group))
Travel_goods_handbags_and_similar_containers_83_exports_xts <- (as.xts(Travel_goods_handbags_and_similar_containers_83, order.by=Date))

Travel_goods_handbags_and_similar_containers_83_exports<-data.frame(NA, nrow=length(index(Travel_goods_handbags_and_similar_containers_83_exports_xts["2015/"])))

for (i in 1:length(index(Travel_goods_handbags_and_similar_containers_83_exports_xts["2015/"]))) {
  Travel_goods_handbags_and_similar_containers_83_exports[i]<-sum(as.numeric(Travel_goods_handbags_and_similar_containers_83_exports_xts[i]),na.rm = TRUE)
}

Travel_goods_handbags_and_similar_containers_83_exports<-as.xts(t(Travel_goods_handbags_and_similar_containers_83_exports), order.by = Date)
colnames(Travel_goods_handbags_and_similar_containers_83_exports)<-c("Travel_goods_handbags_and_similar_containers_83")



#Articles of apparel and clothing accessories (84)
Articles_of_apparel_84 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Articles of apparel and clothing accessories (84)") %>% select(-Countries.and.Territories,-Commodity.group))
Articles_of_apparel_84_exports_xts <- (as.xts(Articles_of_apparel_84, order.by=Date))

Articles_of_apparel_84_exports<-data.frame(NA, nrow=length(index(Articles_of_apparel_84_exports_xts["2015/"])))

for (i in 1:length(index(Articles_of_apparel_84_exports_xts["2015/"]))) {
  Articles_of_apparel_84_exports[i]<-sum(as.numeric(Articles_of_apparel_84_exports_xts[i]),na.rm = TRUE)
}

Articles_of_apparel_84_exports<-as.xts(t(Articles_of_apparel_84_exports), order.by = Date)
colnames(Articles_of_apparel_84_exports)<-c("Articles_of_apparel_84")




#Footwear (85)

Footwear_85 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Footwear (85)") %>% select(-Countries.and.Territories,-Commodity.group))
Footwear_85_exports_xts <- (as.xts(Footwear_85, order.by=Date))

Footwear_85_exports<-data.frame(NA, nrow=length(index(Footwear_85_exports_xts["2015/"])))

for (i in 1:length(index(Footwear_85_exports_xts["2015/"]))) {
  Footwear_85_exports[i]<-sum(as.numeric(Footwear_85_exports_xts[i]),na.rm = TRUE)
}

Footwear_85_exports<-as.xts(t(Footwear_85_exports), order.by = Date)
colnames(Footwear_85_exports)<-c("Footwear_85")



#Professional, scientific and controlling apparatus (87)

Professional_scientific_and_controlling_apparatus_87 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Professional, scientific and controlling apparatus (87)") %>% select(-Countries.and.Territories,-Commodity.group))
Professional_scientific_and_controlling_apparatus_87_exports_xts <- (as.xts(Professional_scientific_and_controlling_apparatus_87, order.by=Date))

Professional_scientific_and_controlling_apparatus_87_exports<-data.frame(NA, nrow=length(index(Professional_scientific_and_controlling_apparatus_87_exports_xts["2015/"])))

for (i in 1:length(index(Professional_scientific_and_controlling_apparatus_87_exports_xts["2015/"]))) {
  Professional_scientific_and_controlling_apparatus_87_exports[i]<-sum(as.numeric(Professional_scientific_and_controlling_apparatus_87_exports_xts[i]),na.rm = TRUE)
}

Professional_scientific_and_controlling_apparatus_87_exports<-as.xts(t(Professional_scientific_and_controlling_apparatus_87_exports), order.by = Date)
colnames(Professional_scientific_and_controlling_apparatus_87_exports)<-c("Professional_scientific_and_controlling_apparatus_87")



#Photographic apparatus, optical goods, watches and clocks (88)

Photographic_apparatus_88 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Photographic apparatus, optical goods, watches and clocks (88)") %>% select(-Countries.and.Territories,-Commodity.group))
Photographic_apparatus_88_exports_xts <- (as.xts(Photographic_apparatus_88, order.by=Date))

Photographic_apparatus_88_exports<-data.frame(NA, nrow=length(index(Photographic_apparatus_88_exports_xts["2015/"])))

for (i in 1:length(index(Photographic_apparatus_88_exports_xts["2015/"]))) {
  Photographic_apparatus_88_exports[i]<-sum(as.numeric(Photographic_apparatus_88_exports_xts[i]),na.rm = TRUE)
}

Photographic_apparatus_88_exports<-as.xts(t(Photographic_apparatus_88_exports), order.by = Date)
colnames(Photographic_apparatus_88_exports)<-c("Photographic_apparatus_88")


#Miscellaneous manufactured articles, n.e.s. (89)

Miscellaneous_manufactured_articles_89 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Miscellaneous manufactured articles, n.e.s. (89)") %>% select(-Countries.and.Territories,-Commodity.group))
Miscellaneous_manufactured_articles_89_exports_xts <- (as.xts(Miscellaneous_manufactured_articles_89, order.by=Date))

Miscellaneous_manufactured_articles_89_exports<-data.frame(NA, nrow=length(index(Miscellaneous_manufactured_articles_89_exports_xts["2015/"])))

for (i in 1:length(index(Miscellaneous_manufactured_articles_89_exports_xts["2015/"]))) {
  Miscellaneous_manufactured_articles_89_exports[i]<-sum(as.numeric(Miscellaneous_manufactured_articles_89_exports_xts[i]),na.rm = TRUE)
}

Miscellaneous_manufactured_articles_89_exports<-as.xts(t(Miscellaneous_manufactured_articles_89_exports), order.by = Date)
colnames(Miscellaneous_manufactured_articles_89_exports)<-c("Miscellaneous_manufactured_articles_89")

#Commodities and transactions n.e.s. (9)

Commodities_and_transactions_9 <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Commodities and transactions n.e.s. (9)") %>% select(-Countries.and.Territories,-Commodity.group))
Commodities_and_transactions_9_exports_xts <- (as.xts(Commodities_and_transactions_9, order.by=Date))

Commodities_and_transactions_9_exports<-data.frame(NA, nrow=length(index(Commodities_and_transactions_9_exports_xts["2015/"])))

for (i in 1:length(index(Commodities_and_transactions_9_exports_xts["2015/"]))) {
  Commodities_and_transactions_9_exports[i]<-sum(as.numeric(Commodities_and_transactions_9_exports_xts[i]),na.rm = TRUE)
}

Commodities_and_transactions_9_exports<-as.xts(t(Commodities_and_transactions_9_exports), order.by = Date)
colnames(Commodities_and_transactions_9_exports)<-c("Commodities_and_transactions_9")

#Unclassified estimates 


Unclassified_estimates <-t(subset(Ireland_exports,Ireland_Exports["2014-11-01"]=="Unclassified estimates") %>% select(-Countries.and.Territories,-Commodity.group))
Unclassified_estimates_exports_xts <- (as.xts(Commodities_and_transactions_9, order.by=Date))

Unclassified_estimates_exports<-data.frame(NA, nrow=length(index(Unclassified_estimates_exports_xts["2015/"])))

for (i in 1:length(index(Unclassified_estimates_exports_xts["2015/"]))) {
  Unclassified_estimates_exports[i]<-sum(as.numeric(Unclassified_estimates_exports_xts[i]),na.rm = TRUE)
}

Unclassified_estimates_exports<-as.xts(t(Unclassified_estimates_exports), order.by = Date)
colnames(Unclassified_estimates_exports)<-c("Unclassified_estimates")

Export_Product<-merge.xts(Live_animals_00_exports,meat_01_exports,Dairy_02_exports,Fish_03_exports,Cereal_04_exports,Veg_05_exports,Sugar_06_exports,Coffee_07_exports,
                      animal_feed_08_exports,Miscellaneous_09_exports,Beverages_11_exports,Tobacco_12_exports,Hides_21_exports,oilseeds_22_exports,Crude_rubber_23_exports,                      
                      Cork_24_exports,Pulp_25_exports,Textile_fibres_26_exports,Crude_fertilisers_27_exports,Metalliferous_ores_28_exports,Crude_animal_and_vegetable_materials_29_exports,
                      Coal_32_exports,Petroleum_33_exports,Gas_34_exports,Electric_current_35_exports,Animal_oils_and_fats_41_exports,Fixed_vegetable_oils_and_fats_42_exports,
                      Animal_and_vegetable_oils_43_exports,Organic_chemicals_51_exports,Inorganic_chemicals_52_exports,Dyeing_tanning_53_exports,Medicinal_and_pharma_54_exports, 
                      Essential_oils_55_exports,Fertilisers_56_exports,Plastics_57_exports,Plastics_non_primary_58_exports,Chemical_materials_59_exports,Leather_61_exports,Rubber_manufactures_62_exports,
                      Cork_and_wood_manufactures_63_exports,Paper_paperboard_64_exports,Textile_yarn_65_exports,Non_metallic_mineral_66_exports,
                      Iron_and_steel_67_exports,Non_ferrous_metals_68_exports,Manufactures_of_metal_69_exports,Power_generating_machinery_71_exports,Machinery_specialised_for_particular_industries_72_exports,
                      Metalworking_machinery_73_exports,General_industrial_machinery_74_exports,Office_machines_and_automatic_data_processing_equipment_75_exports,Telecommunications_and_sound_recording_76_exports,
                      Electrical_machinery_77_exports,Road_vehicles_78_exports,Other_transport_equipment_79_exports,Prefab_buildings_plumbing_and_electrical_81_exports,
                      Furniture_and_parts_thereof_82_exports,Travel_goods_handbags_and_similar_containers_83_exports,Articles_of_apparel_84_exports,Footwear_85_exports,
                      Professional_scientific_and_controlling_apparatus_87_exports,Photographic_apparatus_88_exports,Miscellaneous_manufactured_articles_89_exports,Commodities_and_transactions_9_exports,Unclassified_estimates_exports)
                      
                      
TOTAL_sum_export_product<-data.frame(NA, nrow=length(index(Export_Product["2015/"])))

for (i in 1:length(index(Export_Product["2015/"]))) {
  TOTAL_sum_export_product[i]<-sum(as.numeric(Export_Product[i]),na.rm = TRUE)
}


TOTAL_sum_export_product<-as.xts(t(TOTAL_sum_export_product), order.by = Date)
colnames(TOTAL_sum_export_product)<-c("TOTAL")






Food_and_live_animals<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))

for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Food_and_live_animals[i]<-sum(Export_Product$Live_animals_00[i],Export_Product$meat_01[i],Export_Product$Dairy_02[i],Export_Product$Fish_03[i],Export_Product$Cereal_04[i],Export_Product$Veg_05[i],Export_Product$Sugar_06[i],Export_Product$Coffee_07[i],
                                Export_Product$animal_feed_08[i],Export_Product$Miscellaneous_09[i])
}

Food_and_live_animals<-as.xts(t(Food_and_live_animals), order.by = Date)
colnames(Food_and_live_animals)<-c("Food_and_live_animals")




Beverages_and_tobacco<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Beverages_and_tobacco[i]<-sum(Export_Product$Beverages_11[i],Export_Product$Tobacco_12[i])
}

Beverages_and_tobacco<-as.xts(t(Beverages_and_tobacco), order.by = Date)
colnames(Beverages_and_tobacco)<-c("Beverages_and_tobacco")





Crude_materials_inedible_except_fuels<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Crude_materials_inedible_except_fuels[i]<-sum(Export_Product$Hides_21[i],Export_Product$oilseeds_22[i],Export_Product$Crude_rubber_23[i],Export_Product$Cork_24[i],Export_Product$Pulp_25[i],Export_Product$Textile_fibres_26[i],Export_Product$Crude_fertilisers_27[i],Export_Product$Metalliferous_ores_28[i],Export_Product$Crude_animal_and_vegetable_materials_29[i])
}



          
Crude_materials_inedible_except_fuels<-as.xts(t(Crude_materials_inedible_except_fuels), order.by = Date)
colnames(Crude_materials_inedible_except_fuels)<-c("Crude_materials_inedible_except_fuels")




Mineral_fuels_lubricants_and_related_materials<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))	
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Mineral_fuels_lubricants_and_related_materials[i]<-sum(Export_Product$Coal_32_exports[i],Export_Product$Petroleum_33[i],Export_Product$Gas_34[i],Export_Product$Electric_current_35[i])
                                                         }

Mineral_fuels_lubricants_and_related_materials<-as.xts(t(Mineral_fuels_lubricants_and_related_materials), order.by = Date)
colnames(Mineral_fuels_lubricants_and_related_materials)<-c("Mineral_fuels_lubricants_and_related_materials")








Animal_and_vegetable_oils_fats_and_waxes<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Animal_and_vegetable_oils_fats_and_waxes[i]<-sum(Export_Product$Animal_oils_and_fats_41[i],Export_Product$Fixed_vegetable_oils_and_fats_42[i],Export_Product$Animal_and_vegetable_oils_43_exports[i])
}

Animal_and_vegetable_oils_fats_and_waxes<-as.xts(t(Animal_and_vegetable_oils_fats_and_waxes), order.by = Date)
colnames(Animal_and_vegetable_oils_fats_and_waxes)<-c("Animal_and_vegetable_oils_fats_and_waxes")


Chemicals_and_related_products<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Chemicals_and_related_products[i]<-sum(Export_Product$Organic_chemicals_51[i],Export_Product$Inorganic_chemicals_52[i],Export_Product$Dyeing_tanning_53[i],Export_Product$Medicinal_and_pharma_54[i],Export_Product$Essential_oils_55[i],Export_Product$Fertilisers_56[i],Export_Product$Plastics_57[i],Export_Product$Plastics_non_primary_58[i],Export_Product$Chemical_materials_59[i])
}


Chemicals_and_related_products<-as.xts(t(Chemicals_and_related_products), order.by = Date)
colnames(Chemicals_and_related_products)<-c("Chemicals_and_related_products")


Manufactured_goods_classified_chiefly_by_material<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Manufactured_goods_classified_chiefly_by_material[i]<-sum(Export_Product$Leather_61[i],Export_Product$Rubber_manufactures_62[i],Export_Product$Cork_and_wood_manufactures_63[i],Export_Product$Paper_paperboard_64[i],Export_Product$Textile_yarn_65[i],Export_Product$Non_metallic_mineral_66[i],Export_Product$Iron_and_steel_67[i],Export_Product$Non_ferrous_metals_68[i],Export_Product$Manufactures_of_metal_69[i])
}

Manufactured_goods_classified_chiefly_by_material<-as.xts(t(Manufactured_goods_classified_chiefly_by_material), order.by = Date)
colnames(Manufactured_goods_classified_chiefly_by_material)<-c("Manufactured_goods_classified_chiefly_by_material")


Machinery_and_transport_equipment<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Machinery_and_transport_equipment[i]<-sum(Export_Product$Power_generating_machinery_71[i],Export_Product$Machinery_specialised_for_particular_industries_72[i],Export_Product$Metalworking_machinery_73[i],Export_Product$General_industrial_machinery_74[i],Export_Product$Office_machines_and_automatic_data_processing_equipment_75[i],Export_Product$Telecommunications_and_sound_recording_76[i],Export_Product$Electrical_machinery_77[i],Export_Product$Road_vehicles_78[i],Export_Product$Other_transport_equipment_79[i])
}

Machinery_and_transport_equipment<-as.xts(t(Machinery_and_transport_equipment), order.by = Date)
colnames(Machinery_and_transport_equipment)<-c("Machinery_and_transport_equipment")






Miscellaneous_manufactured_articles<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Miscellaneous_manufactured_articles[i]<-sum(Export_Product$Prefab_buildings_plumbing_and_electrical_81[i],Export_Product$Furniture_and_parts_thereof_82[i],Export_Product$Travel_goods_handbags_and_similar_containers_83[i],Export_Product$Articles_of_apparel_84[i],Export_Product$Footwear_85[i],Export_Product$Professional_scientific_and_controlling_apparatus_87[i],Export_Product$Photographic_apparatus_88[i],Export_Product$Miscellaneous_manufactured_articles_89[i])
}

Miscellaneous_manufactured_articles<-as.xts(t(Miscellaneous_manufactured_articles), order.by = Date)
colnames(Miscellaneous_manufactured_articles)<-c("Miscellaneous_manufactured_articles")






Other<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  Other[i]<-sum(Export_Product$Commodities_and_transactions_9[i],Export_Product$Unclassified_estimates[i])
}

Other<-as.xts(t(Other), order.by = Date)
colnames(Other)<-c("Other")

Other


TOTAL_PRODUCT_AGG<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
TOTAL_PRODUCT_AGG[i]<-sum(Food_and_live_animals[i],Beverages_and_tobacco[i],Crude_materials_inedible_except_fuels[i],Mineral_fuels_lubricants_and_related_materials[i],Animal_and_vegetable_oils_fats_and_waxes[i],Chemicals_and_related_products[i],Manufactured_goods_classified_chiefly_by_material[i],Machinery_and_transport_equipment[i],Miscellaneous_manufactured_articles[i],Other[i])
}


TOTAL_PRODUCT_AGG<-as.xts(t(TOTAL_PRODUCT_AGG), order.by = Date)
colnames(TOTAL_PRODUCT_AGG)<-c("TOTAL_PRODUCT_AGG")


#Core M&E defined as M&E less other transport equip, to avoid aircraft exports. 
CORE_M_E<-data.frame(NA, nrow=length(index(Export_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Export_Product$Live_animals_00["2015/"]))) {
  CORE_M_E[i]<-(Machinery_and_transport_equipment[i]-Export_Product$Other_transport_equipment_79[i])
}

CORE_M_E<-as.xts(t(CORE_M_E), order.by = Date)
colnames(CORE_M_E)<-c("CORE_M_E")

100*CORE_M_E/TOTAL_sum_export$TOTAL

#semi conductors
semi_conductors<-Export_Product$Electrical_machinery_77
100*semi_conductors/CORE_M_E

OTHER_CORE_M_E<-CORE_M_E-semi_conductors

#FOOD & Beverage 
FOOD_and_Beverage<-(Food_and_live_animals+Beverages_and_tobacco)
100*FOOD_and_Beverage/TOTAL_sum_export$TOTAL

annual_growth_FB<-growth(FOOD_and_Beverage,12)
monthly_growth_FB<-growth(FOOD_and_Beverage,1)

text_monthly_growth_FB<-conditional(monthly_growth_FB[length(monthly_growth_FB)])
text_annual_growth_FB<-conditional(annual_growth_FB[length(annual_growth_FB)])

YTD_Food_Beverage<- 100*(sum(FOOD_and_Beverage["2024"])-sum(FOOD_and_Beverage["2023/"][1:length(FOOD_and_Beverage["2024/"])]))/sum(FOOD_and_Beverage["2023/"][1:length(FOOD_and_Beverage["2024/"])])
YTD_Food_Beverage_text<-conditional(YTD_Food_Beverage)

length_current_year<-length(FOOD_and_Beverage["2024/"])



#Pharma
Pharma_Share<-paste0(round(100*Chemicals_and_related_products/TOTAL_sum_export$TOTAL,1),sep="%")



annual_growth_Pharma<-growth(Chemicals_and_related_products,12)
monthly_growth_Pharma<-growth(Chemicals_and_related_products,1)

annual_growth_Pharma_text<-conditional(annual_growth_Pharma$Chemicals_and_related_products[length(annual_growth_Pharma)])
monthly_growth_Pharma_text<-conditional(monthly_growth_Pharma$Chemicals_and_related_products[length(monthly_growth_Pharma)])


YTD_Pharma<- 100*(sum(Chemicals_and_related_products["2024"])-sum(Chemicals_and_related_products["2023/"][1:length(Chemicals_and_related_products["2024/"])]))/sum(Chemicals_and_related_products["2023/"][1:length(Chemicals_and_related_products["2024/"])])
YTD_Pharma_text<-conditional(YTD_Pharma)



Pharma_Share_2021<- sum(Chemicals_and_related_products["2023"][1:length(Total_Export_Country$TOTAL["2024"])])/(sum(Total_Export_Country$TOTAL["2023"][1:length(Total_Export_Country$TOTAL["2024"])]))

YTD_Contribution_Pharma_Growth<-YTD_Pharma*Pharma_Share_2021
                                                              
Pharma_Contribution_Overall_YTD<-conditional_alt5(YTD_Contribution_Pharma_Growth)







Miscellaneous_Medical_Devices<-Export_Product$Miscellaneous_manufactured_articles_89

OTHER_PRODUCT<-(TOTAL_sum_export_product$TOTAL-(FOOD_and_Beverage+semi_conductors+Chemicals_and_related_products+OTHER_CORE_M_E+Miscellaneous_Medical_Devices))

PRODUCT_AGG<-merge(FOOD_and_Beverage,semi_conductors,Chemicals_and_related_products,OTHER_CORE_M_E,Miscellaneous_Medical_Devices,OTHER_PRODUCT)
colnames(PRODUCT_AGG)<-c("Food & Beverage","semi Conductors","Pharma","Other Core M&E","Miscellaneous Medical Devices","Other")


PRODUCT_AGG_SHARE<-merge((PRODUCT_AGG$`Food & Beverage`/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$`semi Conductors`/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$Pharma/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$`Other Core M&E`/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$`Miscellaneous Medical Devices`/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$Other/TOTAL_sum_export$TOTAL))
colnames(PRODUCT_AGG_SHARE)<-c("Food & Beverage","semi Conductors","Pharma","Other Core M&E","Miscellaneous Medical Devices","Other")

  
annual_growth_Products<-growth(PRODUCT_AGG,freq=12)
month_growth_Products<-growth(PRODUCT_AGG,1)


Contribution_annual_growth_product<-round(annual_growth_Products["2016/"]*(lag.xts(PRODUCT_AGG_SHARE["2016/"],12)),2)
colnames(Contribution_annual_growth_product)<-c("Food & Beverage","semi Conductors","Pharma","Other Core M&E","Miscellaneous Medical Devices","Other")

Contribution_annual_growth_product_df<-data.frame(index(Contribution_annual_growth_product),Contribution_annual_growth_product)
colnames(Contribution_annual_growth_product_df)<-c("Date",colnames(Contribution_annual_growth_product))

dataset_names <- list('Contribution_Annual_Growth' = Contribution_annual_growth_product_df)



#create summary graph of products below
summary_contribution_Product<-data.frame(merge(Contribution_annual_growth_product$`Food & Beverage`["2023/"],Contribution_annual_growth_product$`semi Conductors`["2023/"],Contribution_annual_growth_product$Pharma["2023/"],Contribution_annual_growth_product$`Other Core M&E`["2023/"],Contribution_annual_growth_product$`Miscellaneous Medical Devices`["2023/"],Contribution_annual_growth_product$Other["2023/"]),index(Contribution_annual_growth_product["2023/"]))
colnames(summary_contribution_Product)<-c("Food & Beverage","Semi Conductors","Pharma","Other Core M&E","Miscellaneous Medical Devices","Other","Date")
summary_contribution_melt_Product<-melt(summary_contribution_Product,id=c("Date"))


product_contribution<-ggplot(data=summary_contribution_melt_Product, aes(y=value, x=Date, fill=variable)) + 
  geom_bar(position="stack", stat="identity")+theme(legend.position.inside=c(0.8, 0.2),plot.caption = element_text(hjust=0))+
  labs(x="",
       title="Ireland Export Contribution to Growth",
       caption="Date Source: CSO monthly external trade data. from 2020",
       y="Percentage Share (%)")+
  scale_fill_manual(name = "", values  = c("Food & Beverage" = DOF_colours[3],"Semi Conductors" = DOF_colours[2],"Pharma" = DOF_colours[1],"Other Core M&E"=DOF_colours[4],"Miscellaneous Medical Devices"=DOF_colours[5],"Other"=DOF_colours[6]))+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))



```

```{r Product Commodity Graph, echo=FALSE}


product_contribution+theme(legend.position.inside = c(0.2, 0.8))

```

```{r Product Warning, include=FALSE}

Export_Product_share<-Export_Product/Total_Export_Level$TOTAL
prod_annual_growth<-growth(Export_Product,freq = 12)*lag.xts(Export_Product_share,k=12)

prod_con_excel<-prod_annual_growth["2016/"] %>% round(3)
colnames(prod_con_excel)<-c("Live animals","meat","Dairy","Fish","Cereal","Veg","Sugar","Coffee","animal feed","Miscellaneous","Beverages","Tobacco","Hides","oilseeds","Crude rubber","Cork","Pulp","Textile fibres","Crude fertilisers","Metalliferous ores","Crude animal and vegetable materials","Coal","Petroleum","Gas","Electric current","Animal oils and fats","Fixed vegetable oils and fats", "Animal and vegetable oils","Organic chemicals","Inorganic chemicals","Dyeing tanning","Medicinal and pharma","Essential oils","Fertilisers","Plastics","Plastics non primary","Chemical materials","Leather","Rubber manufactures","Cork and wood manufactures","Paper paperboard","Textile yarn","Non metallic mineral","Iron and steel","Non ferrous metals","Manufactures of metal","Power generating machinery","Machinery specialised for particular industries","Metalworking machinery","General industrial machinery","Office machines and automatic data processing equipment", "Telecommunications and sound recording","Electrical machinery","Road vehicles","Other transport equipment","Prefab buildings plumbing and electrical","Furniture and parts thereof","Travel goods handbags and similar containers","Articles of apparel","Footwear","Professional scientific and controlling apparatus","Photographic apparatus","Miscellaneous manufactured articles","Commodities and transactions","Unclassified_estimates")





latest_prod_contribution<-(prod_annual_growth[nrow(prod_annual_growth)])

colnames(latest_prod_contribution)<-c("Live animals","meat","Dairy","Fish","Cereal","Veg","Sugar","Coffee","animal feed","Miscellaneous","Beverages","Tobacco","Hides","oilseeds","Crude rubber","Cork","Pulp","Textile fibres","Crude fertilisers","Metalliferous ores","Crude animal and vegetable materials","Coal","Petroleum","Gas","Electric current","Animal oils and fats","Fixed vegetable oils and fats", "Animal and vegetable oils","Organic chemicals","Inorganic chemicals","Dyeing tanning","Medicinal and pharma","Essential oils","Fertilisers","Plastics","Plastics non primary","Chemical materials","Leather","Rubber manufactures","Cork and wood manufactures","Paper paperboard","Textile yarn","Non metallic mineral","Iron and steel","Non ferrous metals","Manufactures of metal","Power generating machinery","Machinery specialised for particular industries","Metalworking machinery","General industrial machinery","Office machines and automatic data processing equipment", "Telecommunications and sound recording","Electrical machinery","Road vehicles","Other transport equipment","Prefab buildings plumbing and electrical","Furniture and parts thereof","Travel goods handbags and similar containers","Articles of apparel","Footwear","Professional scientific and controlling apparatus","Photographic apparatus","Miscellaneous manufactured articles","Commodities and transactions","Unclassified_estimates")                                    

latest_prod_contribution<-(prod_annual_growth[nrow(prod_annual_growth)])
colnames(latest_prod_contribution)<-c("Live animals","meat","Dairy","Fish","Cereal","Veg","Sugar","Coffee","animal feed","Miscellaneous","Beverages","Tobacco","Hides","oilseeds","Crude rubber","Cork","Pulp","Textile fibres","Crude fertilisers","Metalliferous ores","Crude animal and vegetable materials","Coal","Petroleum","Gas","Electric current","Animal oils and fats","Fixed vegetable oils and fats", "Animal and vegetable oils","Organic chemicals","Inorganic chemicals","Dyeing tanning","Medicinal and pharma","Essential oils","Fertilisers","Plastics","Plastics non primary","Chemical materials","Leather","Rubber manufactures","Cork and wood manufactures","Paper paperboard","Textile yarn","Non metallic mineral","Iron and steel","Non ferrous metals","Manufactures of metal","Power generating machinery","Machinery specialised for particular industries","Metalworking machinery","General industrial machinery","Office machines and automatic data processing equipment", "Telecommunications and sound recording","Electrical machinery","Road vehicles","Other transport equipment","Prefab buildings plumbing and electrical","Furniture and parts thereof","Travel goods handbags and similar containers","Articles of apparel","Footwear","Professional scientific and controlling apparatus","Photographic apparatus","Miscellaneous manufactured articles","Commodities and transactions","Unclassified_estimates")                                    


high_contribution<-colnames(latest_prod_contribution)[max.col(latest_prod_contribution,ties.method="first")]
high_contribution_value<-round(as.numeric(latest_prod_contribution[,paste0(high_contribution)]),1)


Low_contribution<-colnames(latest_prod_contribution)[which.min(latest_prod_contribution)]
Low_contribution_value<-round(as.numeric(latest_prod_contribution[,paste0(Low_contribution)]),1)


annual_prod_growth<-growth(Export_Product,freq = 12)
latest_annual_prod_growth<-annual_prod_growth[nrow(annual_prod_growth)]

colnames(latest_annual_prod_growth)<-c("Live animals","meat","Dairy","Fish","Cereal","Veg","Sugar","Coffee","animal feed","Miscellaneous","Beverages","Tobacco","Hides","oilseeds","Crude rubber","Cork","Pulp","Textile fibres","Crude fertilisers","Metalliferous ores","Crude animal and vegetable materials","Coal","Petroleum","Gas","Electric current","Animal oils and fats","Fixed vegetable oils and fats", "Animal and vegetable oils","Organic chemicals","Inorganic chemicals","Dyeing tanning","Medicinal and pharma","Essential oils","Fertilisers","Plastics","Plastics non primary","Chemical materials","Leather","Rubber manufactures","Cork and wood manufactures","Paper paperboard","Textile yarn","Non metallic mineral","Iron and steel","Non ferrous metals","Manufactures of metal","Power generating machinery","Machinery specialised for particular industries","Metalworking machinery","General industrial machinery","Office machines and automatic data processing equipment", "Telecommunications and sound recording","Electrical machinery","Road vehicles","Other transport equipment","Prefab buildings plumbing and electrical","Furniture and parts thereof","Travel goods handbags and similar containers","Articles of apparel","Footwear","Professional scientific and controlling apparatus","Photographic apparatus","Miscellaneous manufactured articles","Commodities and transactions","Unclassified_estimates")                                    



Low_contribution_growth_rate<-round(as.numeric(latest_annual_prod_growth[,paste0(Low_contribution)]),1)
Low_contribution_growth_rate_text<-conditional(Low_contribution_growth_rate)

High_contribution_growth_rate<-round(as.numeric(latest_annual_prod_growth[,paste0(high_contribution)]),1)
High_contribution_growth_rate_text<-conditional(High_contribution_growth_rate)



```

------------------------------------------------------------------------

#### **Product Level Breakdown**

-   Exports in the employment rich food and beverage sector in `r current_date` `r text_monthly_growth_FB` and `r text_annual_growth_FB` on an annual basis.In the first `r length_current_year` months of the year, food and beverage exports have `r YTD_Food_Beverage_text`.\
    <br> <br>
-   Pharma exports in `r current_date` `r monthly_growth_Pharma_text` over the month. Compared to the same period last year, pharma exports `r annual_growth_Pharma_text` in `r current_date`. Having `r YTD_Pharma_text` in the year to date, pharma exports `r Pharma_Contribution_Overall_YTD` in 2023.\
    <br> <br>
-   [**High Contribution Warning:**]{style="color:green"} At a subcomponent level `r high_contribution` reported the highest contribution to annual growth over the month, contributing `r high_contribution_value` percentage points to growth, as annual growth in `r current_date` `r High_contribution_growth_rate_text`.\
    <br> <br>
-   [**Big fall Warning:**]{style="color:darkred"} At a subcomponent level `r Low_contribution` reported the largest drag on annual growth over the month, contributing `r Low_contribution_value` percentage points to growth, as annual growth in `r current_date` `r Low_contribution_growth_rate_text`. <br> <br> \*\*\*

```{r Imports, include=FALSE}
Ire_Imports<- t(data.frame(subset(cso_get_data("TSM10"),Statistic=="Value of Imports")))
Ire_Imports_SA<- t(data.frame(subset(cso_get_data("TSM01"),Statistic=="Total Imports (Seasonally Adjusted)")))
Ire_Imports_vol<- na.exclude(t(data.frame(subset(cso_get_data("TSM02"),Statistic=="Trade Volume Index for Imports"))))
Ire_Imports_SA_vol<- na.exclude(t(data.frame(subset(cso_get_data("TSM02"),Statistic=="Trade Volume Index for Imports (Seasonally Adjusted)"))))


Date<-seq(as.Date("2014-10-01"), by="month",length.out=NROW(Ire_Exports))
Ireland_Imports<-as.xts(Ire_Imports, order.by = Date)
colnames(Ireland_Imports)<-Ireland_Imports["2014-12-01"]

Date_vol<-seq(as.Date("1969-11-01"), by="month",length.out=NROW(Ire_Imports_SA_vol)) 
Date_value<-seq(as.Date("1969-11-01"), by="month",length.out=NROW(Ire_Imports_SA))

current_date<-format(max(Date_value), "%B %Y")
current_date_vol<-format(max(Date_vol), "%B %Y")


#Volume data seasonally adjusted for monthly/Quarterly analysis 
Ireland_Imports_SA_vol_xts<-na.locf(as.xts(Ire_Imports_SA_vol, order.by = Date_vol),na.rm=TRUE)
Ireland_Imports_SA_vol_xts<-as.numeric(Ireland_Imports_SA_vol_xts["2015/"],na.rm = TRUE)
Date_vol_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Imports_SA_vol_xts))
Ireland_Imports_SA_vol_xts<-as.xts((Ireland_Imports_SA_vol_xts), order.by = Date_vol_2015)

#Volume data  Not seasonally adjusted for annual analysis 
Ire_Imports_vol<-as.numeric(Ire_Imports_vol) %>% na.omit()
Ireland_Imports_vol_xts<-na.locf(as.xts(Ire_Imports_vol, order.by = Date_vol_import),na.rm=TRUE)
Ireland_Imports_vol_xts<-as.numeric(Ireland_Imports_vol_xts["2015/"],na.rm = TRUE)
Date_vol_NASA_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Imports_vol_xts))
Ireland_Imports_vol_xts<-as.xts((Ireland_Imports_vol_xts), order.by = Date_vol_NASA_2015)


#Value data   seasonally adjusted for monthly/Quarterly analysis 
Ire_Imports_SA_xts<-na.locf(as.xts(Ire_Imports_SA, order.by = Date_value),na.rm=TRUE)
Ireland_Imports_val_xts<-as.numeric(Ire_Imports_SA_xts["2015/"],na.rm = TRUE)
Date_val_SA_2015<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ireland_Imports_val_xts))
Ireland_Imports_val_xts<-as.xts((Ireland_Imports_val_xts), order.by = Date_val_SA_2015)



                   #Country level aggregated 

Ireland_imports<- subset(cso_get_data("TSM10"),Statistic=="Value of Imports") %>% select(-Statistic)
Date<-seq(as.Date("2015-01-01"), by="month",length.out=NROW(Ire_Imports)-3)

#Austria
Austria_Imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Austria") %>% select(-Countries.and.Territories))
colnames(Austria_Imports) <-Austria_Imports[1,]
Austria_Imports<-Austria_Imports[-c(1),]

Austria_Imports_xts <- (as.xts(Austria_Imports, order.by=Date))
Austria_Imports_xts_num<-as.numeric(Austria_Imports_xts["2015/"],na.rm = TRUE)
Austria_sum_import<-data.frame(NA, nrow=length(index(Austria_Imports_xts["2015/"])))

for (i in 1:length(index(Austria_Imports_xts["2015/"]))) {
  Austria_sum_import[i]<-sum(as.numeric(Austria_Imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Austria_sum_import<-as.xts(t(Austria_sum_import), order.by = Date)
colnames(Austria_sum_import)<-c("Austria")







#Australia
Australia_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Australia") %>% select(-Countries.and.Territories))
colnames(Australia_imports) <-Australia_imports[1,]
Australia_imports<-Australia_imports[-c(1),]

Australia_imports_xts <- (as.xts(Australia_imports, order.by=Date))
Australia_imports_xts_num<-as.numeric(Australia_imports_xts["2015/"],na.rm = TRUE)
Australia_sum_import<-data.frame(NA, nrow=length(index(Australia_imports_xts["2015/"])))

for (i in 1:length(index(Australia_imports_xts["2015/"]))) {
  Australia_sum_import[i]<-sum(as.numeric(Australia_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Australia_sum_import<-as.xts(t(Australia_sum_import), order.by = Date)
colnames(Australia_sum_import)<-c("Australia")



#Belgium
Belgium_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Belgium") %>% select(-Countries.and.Territories))
colnames(Belgium_imports) <-Belgium_imports[1,]
Belgium_imports<-Belgium_imports[-c(1),]

Belgium_imports_xts <- (as.xts(Belgium_imports, order.by=Date))
Belgium_imports_xts_num<-as.numeric(Belgium_imports_xts["2015/"],na.rm = TRUE)
Belgium_sum_import<-data.frame(NA, nrow=length(index(Belgium_imports_xts["2015/"])))

for (i in 1:length(index(Belgium_imports_xts["2015/"]))) {
  Belgium_sum_import[i]<-sum(as.numeric(Belgium_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Belgium_sum_import<-as.xts(t(Belgium_sum_import), order.by = Date)
colnames(Belgium_sum_import)<-c("Belgium")

#Bulgaria
Bulgaria_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Bulgaria") %>% select(-Countries.and.Territories))
colnames(Bulgaria_imports) <-Bulgaria_imports[1,]
Bulgaria_imports<-Bulgaria_imports[-c(1),]

Bulgaria_imports_xts <- (as.xts(Bulgaria_imports, order.by=Date))
Bulgaria_imports_xts_num<-as.numeric(Bulgaria_imports_xts["2015/"],na.rm = TRUE)
Bulgaria_sum_import<-data.frame(NA, nrow=length(index(Bulgaria_imports_xts["2015/"])))

for (i in 1:length(index(Bulgaria_imports_xts["2015/"]))) {
  Bulgaria_sum_import[i]<-sum(as.numeric(Bulgaria_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Bulgaria_sum_import<-as.xts(t(Bulgaria_sum_import), order.by = Date)
colnames(Bulgaria_sum_import)<-c("Bulgaria")


#Brazil 
Brazil_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Brazil") %>% select(-Countries.and.Territories))
colnames(Brazil_imports) <-Brazil_imports[1,]
Brazil_imports<-Brazil_imports[-c(1),]

Brazil_imports_xts <- (as.xts(Brazil_imports, order.by=Date))
Brazil_imports_xts_num<-as.numeric(Brazil_imports_xts["2015/"],na.rm = TRUE)
Brazil_sum_import<-data.frame(NA, nrow=length(index(Brazil_imports_xts["2015/"])))

for (i in 1:length(index(Brazil_imports_xts["2015/"]))) {
  Brazil_sum_import[i]<-sum(as.numeric(Brazil_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Brazil_sum_import<-as.xts(t(Brazil_sum_import), order.by = Date)
colnames(Brazil_sum_import)<-c("Brazil")

#Canada 
Canada_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Canada") %>% select(-Countries.and.Territories))
colnames(Canada_imports) <-Canada_imports[1,]
Canada_imports<-Canada_imports[-c(1),]

Canada_imports_xts <- (as.xts(Canada_imports, order.by=Date))
Canada_imports_xts_num<-as.numeric(Canada_imports_xts["2015/"],na.rm = TRUE)
Canada_sum_import<-data.frame(NA, nrow=length(index(Canada_imports_xts["2015/"])))

for (i in 1:length(index(Canada_imports_xts["2015/"]))) {
  Canada_sum_import[i]<-sum(as.numeric(Canada_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Canada_sum_import<-as.xts(t(Canada_sum_import), order.by = Date)
colnames(Canada_sum_import)<-c("Canada")



#Switzerland 
Switzerland_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Switzerland") %>% select(-Countries.and.Territories))
colnames(Switzerland_imports) <-Switzerland_imports[1,]
Switzerland_imports<-Switzerland_imports[-c(1),]


Switzerland_imports_xts <- (as.xts(Switzerland_imports, order.by=Date))
Switzerland_imports_xts_num<-as.numeric(Switzerland_imports_xts["2015/"],na.rm = TRUE)
Switzerland_sum_import<-data.frame(NA, nrow=length(index(Switzerland_imports_xts["2015/"])))

for (i in 1:length(index(Switzerland_imports_xts["2015/"]))) {
  Switzerland_sum_import[i]<-sum(as.numeric(Switzerland_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Switzerland_sum_import<-as.xts(t(Switzerland_sum_import), order.by = Date)
colnames(Switzerland_sum_import)<-c("Switzerland")

#China 
China_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="China") %>% select(-Countries.and.Territories))
colnames(China_imports) <-China_imports[1,]
China_imports<-China_imports[-c(1),]

China_imports_xts <- (as.xts(China_imports, order.by=Date))
China_imports_xts_num<-as.numeric(China_imports_xts["2015/"],na.rm = TRUE)
China_sum_import<-data.frame(NA, nrow=length(index(China_imports_xts["2015/"])))

for (i in 1:length(index(China_imports_xts["2015/"]))) {
  China_sum_import[i]<-sum(as.numeric(China_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

China_sum_import<-as.xts(t(China_sum_import), order.by = Date)
colnames(China_sum_import)<-c("China")



#Cyprus 
Cyprus_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Cyprus") %>% select(-Countries.and.Territories))
colnames(Cyprus_imports) <-Cyprus_imports[1,]
Cyprus_imports<-Cyprus_imports[-c(1),]

Cyprus_imports_xts <- (as.xts(Cyprus_imports, order.by=Date))
Cyprus_imports_xts_num<-as.numeric(Cyprus_imports_xts["2015/"],na.rm = TRUE)
Cyprus_sum_import<-data.frame(NA, nrow=length(index(Cyprus_imports_xts["2015/"])))

for (i in 1:length(index(Cyprus_imports_xts["2015/"]))) {
  Cyprus_sum_import[i]<-sum(as.numeric(Cyprus_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Cyprus_sum_import<-as.xts(t(Cyprus_sum_import), order.by = Date)
colnames(Cyprus_sum_import)<-c("Cyprus")


#Czech Republic
Czech_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Czech Republic") %>% select(-Countries.and.Territories))
colnames(Czech_imports) <-Czech_imports[1,]
Czech_imports<-Czech_imports[-c(1),]

Czech_imports_xts <- (as.xts(Czech_imports, order.by=Date))
Czech_imports_xts_num<-as.numeric(Czech_imports_xts["2015/"],na.rm = TRUE)
Czech_sum_import<-data.frame(NA, nrow=length(index(Czech_imports_xts["2015/"])))

for (i in 1:length(index(Czech_imports_xts["2015/"]))) {
  Czech_sum_import[i]<-sum(as.numeric(Czech_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Czech_sum_import<-as.xts(t(Czech_sum_import), order.by = Date)
colnames(Czech_sum_import)<-c("Czech")


#Germany
Germany_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Germany") %>% select(-Countries.and.Territories))
colnames(Germany_imports) <-Germany_imports[1,]
Germany_imports<-Germany_imports[-c(1),]

Germany_imports_xts <- (as.xts(Germany_imports, order.by=Date))
Germany_imports_xts_num<-as.numeric(Germany_imports_xts["2015/"],na.rm = TRUE)
Germany_sum_import<-data.frame(NA, nrow=length(index(Germany_imports_xts["2015/"])))

for (i in 1:length(index(Germany_imports_xts["2015/"]))) {
  Germany_sum_import[i]<-sum(as.numeric(Germany_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Germany_sum_import<-as.xts(t(Germany_sum_import), order.by = Date)
colnames(Germany_sum_import)<-c("Germany")



#Denmark 
Denmark_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Denmark") %>% select(-Countries.and.Territories))
colnames(Denmark_imports) <-Denmark_imports[1,]
Denmark_imports<-Denmark_imports[-c(1),]

Denmark_imports_xts <- (as.xts(Denmark_imports, order.by=Date))
Denmark_imports_xts_num<-as.numeric(Denmark_imports_xts["2015/"],na.rm = TRUE)
Denmark_sum_import<-data.frame(NA, nrow=length(index(Denmark_imports_xts["2015/"])))

for (i in 1:length(index(Denmark_imports_xts["2015/"]))) {
  Denmark_sum_import[i]<-sum(as.numeric(Denmark_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Denmark_sum_import<-as.xts(t(Denmark_sum_import), order.by = Date)
colnames(Denmark_sum_import)<-c("Denmark")


#Estonia 
Estonia_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Estonia") %>% select(-Countries.and.Territories))
colnames(Estonia_imports) <-Estonia_imports[1,]
Estonia_imports<-Estonia_imports[-c(1),]

Estonia_imports_xts <- (as.xts(Estonia_imports, order.by=Date))
Estonia_imports_xts_num<-as.numeric(Estonia_imports_xts["2015/"],na.rm = TRUE)
Estonia_sum_import<-data.frame(NA, nrow=length(index(Estonia_imports_xts["2015/"])))

for (i in 1:length(index(Estonia_imports_xts["2015/"]))) {
  Estonia_sum_import[i]<-sum(as.numeric(Estonia_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Estonia_sum_import<-as.xts(t(Estonia_sum_import), order.by = Date)
colnames(Estonia_sum_import)<-c("Estonia")

#Spain 
Spain_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Spain") %>% select(-Countries.and.Territories))
colnames(Spain_imports) <-Spain_imports[1,]
Spain_imports<-Spain_imports[-c(1),]

Spain_imports_xts <- (as.xts(Spain_imports, order.by=Date))
Spain_imports_xts_num<-as.numeric(Spain_imports_xts["2015/"],na.rm = TRUE)
Spain_sum_import<-data.frame(NA, nrow=length(index(Spain_imports_xts["2015/"])))

for (i in 1:length(index(Spain_imports_xts["2015/"]))) {
  Spain_sum_import[i]<-sum(as.numeric(Spain_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Spain_sum_import<-as.xts(t(Spain_sum_import), order.by = Date)
colnames(Spain_sum_import)<-c("Spain")



#Finland 
Finland_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Finland") %>% select(-Countries.and.Territories))
colnames(Finland_imports) <-Finland_imports[1,]
Finland_imports<-Finland_imports[-c(1),]

Finland_imports_xts <- (as.xts(Finland_imports, order.by=Date))
Finland_imports_xts_num<-as.numeric(Finland_imports_xts["2015/"],na.rm = TRUE)
Finland_sum_import<-data.frame(NA, nrow=length(index(Finland_imports_xts["2015/"])))

for (i in 1:length(index(Finland_imports_xts["2015/"]))) {
  Finland_sum_import[i]<-sum(as.numeric(Finland_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Finland_sum_import<-as.xts(t(Finland_sum_import), order.by = Date)
colnames(Finland_sum_import)<-c("Finland")



#France
France_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="France") %>% select(-Countries.and.Territories))
colnames(France_imports) <-France_imports[1,]
France_imports<-France_imports[-c(1),]

France_imports_xts <- (as.xts(France_imports, order.by=Date))
France_imports_xts_num<-as.numeric(France_imports_xts["2015/"],na.rm = TRUE)
France_sum_import<-data.frame(NA, nrow=length(index(France_imports_xts["2015/"])))

for (i in 1:length(index(France_imports_xts["2015/"]))) {
  France_sum_import[i]<-sum(as.numeric(France_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

France_sum_import<-as.xts(t(France_sum_import), order.by = Date)
colnames(France_sum_import)<-c("France")


#Greece
Greece_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Greece") %>% select(-Countries.and.Territories))
colnames(Greece_imports) <-Greece_imports[1,]
Greece_imports<-Greece_imports[-c(1),]

Greece_imports_xts <- (as.xts(Greece_imports, order.by=Date))
Greece_imports_xts_num<-as.numeric(Greece_imports_xts["2015/"],na.rm = TRUE)
Greece_sum_import<-data.frame(NA, nrow=length(index(Greece_imports_xts["2015/"])))

for (i in 1:length(index(Greece_imports_xts["2015/"]))) {
  Greece_sum_import[i]<-sum(as.numeric(Greece_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Greece_sum_import<-as.xts(t(Greece_sum_import), order.by = Date)
colnames(Greece_sum_import)<-c("Greece")


##Croatia
Croatia_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Croatia") %>% select(-Countries.and.Territories))
colnames(Croatia_imports) <-Croatia_imports[1,]
Croatia_imports<-Croatia_imports[-c(1),]

Croatia_imports_xts <- (as.xts(Croatia_imports, order.by=Date))
Croatia_imports_xts_num<-as.numeric(Croatia_imports_xts["2015/"],na.rm = TRUE)
Croatia_sum_import<-data.frame(NA, nrow=length(index(Croatia_imports_xts["2015/"])))

for (i in 1:length(index(Croatia_imports_xts["2015/"]))) {
  Croatia_sum_import[i]<-sum(as.numeric(Croatia_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Croatia_sum_import<-as.xts(t(Croatia_sum_import), order.by = Date)
colnames(Croatia_sum_import)<-c("Croatia")



#Hungary
Hungary_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Hungary") %>% select(-Countries.and.Territories))
colnames(Hungary_imports) <-Hungary_imports[1,]
Hungary_imports<-Hungary_imports[-c(1),]

Hungary_imports_xts <- (as.xts(Hungary_imports, order.by=Date))
Hungary_imports_xts_num<-as.numeric(Hungary_imports_xts["2015/"],na.rm = TRUE)
Hungary_sum_import<-data.frame(NA, nrow=length(index(Hungary_imports_xts["2015/"])))

for (i in 1:length(index(Hungary_imports_xts["2015/"]))) {
  Hungary_sum_import[i]<-sum(as.numeric(Hungary_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Hungary_sum_import<-as.xts(t(Hungary_sum_import), order.by = Date)
colnames(Hungary_sum_import)<-c("Hungary")

#India
India_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="India") %>% select(-Countries.and.Territories))
colnames(India_imports) <-India_imports[1,]
India_imports<-India_imports[-c(1),]

India_imports_xts <- (as.xts(India_imports, order.by=Date))
India_imports_xts_num<-as.numeric(India_imports_xts["2015/"],na.rm = TRUE)
India_sum_import<-data.frame(NA, nrow=length(index(India_imports_xts["2015/"])))

for (i in 1:length(index(India_imports_xts["2015/"]))) {
  India_sum_import[i]<-sum(as.numeric(India_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

India_sum_import<-as.xts(t(India_sum_import), order.by = Date)
colnames(India_sum_import)<-c("India")

#Italy
Italy_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Italy") %>% select(-Countries.and.Territories))
colnames(Italy_imports) <-Italy_imports[1,]
Italy_imports<-Italy_imports[-c(1),]

Italy_imports_xts <- (as.xts(Italy_imports, order.by=Date))
Italy_imports_xts_num<-as.numeric(Italy_imports_xts["2015/"],na.rm = TRUE)
Italy_sum_import<-data.frame(NA, nrow=length(index(Italy_imports_xts["2015/"])))

for (i in 1:length(index(Italy_imports_xts["2015/"]))) {
  Italy_sum_import[i]<-sum(as.numeric(Italy_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Italy_sum_import<-as.xts(t(Italy_sum_import), order.by = Date)
colnames(Italy_sum_import)<-c("Italy")



#Japan

Japan_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Japan") %>% select(-Countries.and.Territories))
colnames(Japan_imports) <-Japan_imports[1,]
Japan_imports<-Japan_imports[-c(1),]

Japan_imports_xts <- (as.xts(Japan_imports, order.by=Date))
Japan_imports_xts_num<-as.numeric(Japan_imports_xts["2015/"],na.rm = TRUE)
Japan_sum_import<-data.frame(NA, nrow=length(index(Japan_imports_xts["2015/"])))

for (i in 1:length(index(Japan_imports_xts["2015/"]))) {
  Japan_sum_import[i]<-sum(as.numeric(Japan_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Japan_sum_import<-as.xts(t(Japan_sum_import), order.by = Date)
colnames(Japan_sum_import)<-c("Japan")


#South Korea
Korea_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="South Korea") %>% select(-Countries.and.Territories))
colnames(Korea_imports) <-Korea_imports[1,]
Korea_imports<-Korea_imports[-c(1),]

Korea_imports_xts <- (as.xts(Korea_imports, order.by=Date))
Korea_imports_xts_num<-as.numeric(Korea_imports_xts["2015/"],na.rm = TRUE)
Korea_sum_import<-data.frame(NA, nrow=length(index(Korea_imports_xts["2015/"])))

for (i in 1:length(index(Korea_imports_xts["2015/"]))) {
  Korea_sum_import[i]<-sum(as.numeric(Korea_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Korea_sum_import<-as.xts(t(Korea_sum_import), order.by = Date)
colnames(Korea_sum_import)<-c("Korea")




#Lithuania
Lithuania_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Lithuania") %>% select(-Countries.and.Territories))
colnames(Lithuania_imports) <-Lithuania_imports[1,]
Lithuania_imports<-Lithuania_imports[-c(1),]

Lithuania_imports_xts <- (as.xts(Lithuania_imports, order.by=Date))
Lithuania_imports_xts_num<-as.numeric(Lithuania_imports_xts["2015/"],na.rm = TRUE)
Lithuania_sum_import<-data.frame(NA, nrow=length(index(Lithuania_imports_xts["2015/"])))

for (i in 1:length(index(Lithuania_imports_xts["2015/"]))) {
  Lithuania_sum_import[i]<-sum(as.numeric(Lithuania_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Lithuania_sum_import<-as.xts(t(Lithuania_sum_import), order.by = Date)
colnames(Lithuania_sum_import)<-c("Lithuania")



#Luxembourg 
Luxembourg_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Luxembourg") %>% select(-Countries.and.Territories))
colnames(Luxembourg_imports) <-Luxembourg_imports[1,]
Luxembourg_imports<-Luxembourg_imports[-c(1),]

Luxembourg_imports_xts <- (as.xts(Luxembourg_imports, order.by=Date))
Luxembourg_imports_xts_num<-as.numeric(Luxembourg_imports_xts["2015/"],na.rm = TRUE)
Luxembourg_sum_import<-data.frame(NA, nrow=length(index(Luxembourg_imports_xts["2015/"])))

for (i in 1:length(index(Luxembourg_imports_xts["2015/"]))) {
  Luxembourg_sum_import[i]<-sum(as.numeric(Luxembourg_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Luxembourg_sum_import<-as.xts(t(Luxembourg_sum_import), order.by = Date)
colnames(Luxembourg_sum_import)<-c("Luxembourg")



#Latvia 
Latvia_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Latvia") %>% select(-Countries.and.Territories))
colnames(Latvia_imports) <-Latvia_imports[1,]
Latvia_imports<-Latvia_imports[-c(1),]

Latvia_imports_xts <- (as.xts(Latvia_imports, order.by=Date))
Latvia_imports_xts_num<-as.numeric(Latvia_imports_xts["2015/"],na.rm = TRUE)
Latvia_sum_import<-data.frame(NA, nrow=length(index(Latvia_imports_xts["2015/"])))

for (i in 1:length(index(Latvia_imports_xts["2015/"]))) {
  Latvia_sum_import[i]<-sum(as.numeric(Latvia_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Latvia_sum_import<-as.xts(t(Latvia_sum_import), order.by = Date)
colnames(Latvia_sum_import)<-c("Latvia")



#Malta 
Malta_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Malta") %>% select(-Countries.and.Territories))
colnames(Malta_imports) <-Malta_imports[1,]
Malta_imports<-Malta_imports[-c(1),]

Malta_imports_xts <- (as.xts(Malta_imports, order.by=Date))
Malta_imports_xts_num<-as.numeric(Malta_imports_xts["2015/"],na.rm = TRUE)
Malta_sum_import<-data.frame(NA, nrow=length(index(Malta_imports_xts["2015/"])))

for (i in 1:length(index(Malta_imports_xts["2015/"]))) {
  Malta_sum_import[i]<-sum(as.numeric(Malta_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Malta_sum_import<-as.xts(t(Malta_sum_import), order.by = Date)
colnames(Malta_sum_import)<-c("Malta")




#Mexico 
Mexico_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Mexico") %>% select(-Countries.and.Territories))
colnames(Mexico_imports) <-Mexico_imports[1,]
Mexico_imports<-Mexico_imports[-c(1),]

Mexico_imports_xts <- (as.xts(Mexico_imports, order.by=Date))
Mexico_imports_xts_num<-as.numeric(Mexico_imports_xts["2015/"],na.rm = TRUE)
Mexico_sum_import<-data.frame(NA, nrow=length(index(Mexico_imports_xts["2015/"])))

for (i in 1:length(index(Mexico_imports_xts["2015/"]))) {
  Mexico_sum_import[i]<-sum(as.numeric(Mexico_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Mexico_sum_import<-as.xts(t(Mexico_sum_import), order.by = Date)
colnames(Mexico_sum_import)<-c("Mexico")



#Malaysia 
Malaysia_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Malaysia") %>% select(-Countries.and.Territories))
colnames(Malaysia_imports) <-Malaysia_imports[1,]
Malaysia_imports<-Malaysia_imports[-c(1),]

Malaysia_imports_xts <- (as.xts(Malaysia_imports, order.by=Date))
Malaysia_imports_xts_num<-as.numeric(Malaysia_imports_xts["2015/"],na.rm = TRUE)
Malaysia_sum_import<-data.frame(NA, nrow=length(index(Malaysia_imports_xts["2015/"])))

for (i in 1:length(index(Malaysia_imports_xts["2015/"]))) {
  Malaysia_sum_import[i]<-sum(as.numeric(Malaysia_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Malaysia_sum_import<-as.xts(t(Malaysia_sum_import), order.by = Date)
colnames(Malaysia_sum_import)<-c("Malaysia")


#Netherlands 
Netherlands_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Netherlands") %>% select(-Countries.and.Territories))
colnames(Netherlands_imports) <-Netherlands_imports[1,]
Netherlands_imports<-Netherlands_imports[-c(1),]

Netherlands_imports_xts <- (as.xts(Netherlands_imports, order.by=Date))
Netherlands_imports_xts_num<-as.numeric(Netherlands_imports_xts["2015/"],na.rm = TRUE)
Netherlands_sum_import<-data.frame(NA, nrow=length(index(Netherlands_imports_xts["2015/"])))

for (i in 1:length(index(Netherlands_imports_xts["2015/"]))) {
  Netherlands_sum_import[i]<-sum(as.numeric(Netherlands_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Netherlands_sum_import<-as.xts(t(Netherlands_sum_import), order.by = Date)
colnames(Netherlands_sum_import)<-c("Netherlands")



#Norway  
Norway_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Norway") %>% select(-Countries.and.Territories))
colnames(Norway_imports) <-Norway_imports[1,]
Norway_imports<-Norway_imports[-c(1),]

Norway_imports_xts <- (as.xts(Norway_imports, order.by=Date))
Norway_imports_xts_num<-as.numeric(Norway_imports_xts["2015/"],na.rm = TRUE)
Norway_sum_import<-data.frame(NA, nrow=length(index(Norway_imports_xts["2015/"])))

for (i in 1:length(index(Norway_imports_xts["2015/"]))) {
  Norway_sum_import[i]<-sum(as.numeric(Norway_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Norway_sum_import<-as.xts(t(Norway_sum_import), order.by = Date)
colnames(Norway_sum_import)<-c("Norway")




#Poland  
Poland_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Poland") %>% select(-Countries.and.Territories))
colnames(Poland_imports) <-Poland_imports[1,]
Poland_imports<-Poland_imports[-c(1),]

Poland_imports_xts <- (as.xts(Poland_imports, order.by=Date))
Poland_imports_xts_num<-as.numeric(Poland_imports_xts["2015/"],na.rm = TRUE)
Poland_sum_import<-data.frame(NA, nrow=length(index(Poland_imports_xts["2015/"])))

for (i in 1:length(index(Poland_imports_xts["2015/"]))) {
  Poland_sum_import[i]<-sum(as.numeric(Poland_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Poland_sum_import<-as.xts(t(Poland_sum_import), order.by = Date)
colnames(Poland_sum_import)<-c("Poland")



#Portugal  
Portugal_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Portugal") %>% select(-Countries.and.Territories))
colnames(Portugal_imports) <-Portugal_imports[1,]
Portugal_imports<-Portugal_imports[-c(1),]

Portugal_imports_xts <- (as.xts(Portugal_imports, order.by=Date))
Portugal_imports_xts_num<-as.numeric(Portugal_imports_xts["2015/"],na.rm = TRUE)
Portugal_sum_import<-data.frame(NA, nrow=length(index(Portugal_imports_xts["2015/"])))

for (i in 1:length(index(Portugal_imports_xts["2015/"]))) {
  Portugal_sum_import[i]<-sum(as.numeric(Portugal_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Portugal_sum_import<-as.xts(t(Portugal_sum_import), order.by = Date)
colnames(Portugal_sum_import)<-c("Portugal")




#Romania  
Romania_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Romania") %>% select(-Countries.and.Territories))
colnames(Romania_imports) <-Romania_imports[1,]
Romania_imports<-Romania_imports[-c(1),]

Romania_imports_xts <- (as.xts(Romania_imports, order.by=Date))
Romania_imports_xts_num<-as.numeric(Romania_imports_xts["2015/"],na.rm = TRUE)
Romania_sum_import<-data.frame(NA, nrow=length(index(Romania_imports_xts["2015/"])))

for (i in 1:length(index(Romania_imports_xts["2015/"]))) {
  Romania_sum_import[i]<-sum(as.numeric(Romania_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Romania_sum_import<-as.xts(t(Romania_sum_import), order.by = Date)
colnames(Romania_sum_import)<-c("Romania")

#Russia  
Russia_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Russia") %>% select(-Countries.and.Territories))
colnames(Russia_imports) <-Russia_imports[1,]
Russia_imports<-Russia_imports[-c(1),]

Russia_imports_xts <- (as.xts(Russia_imports, order.by=Date))
Russia_imports_xts_num<-as.numeric(Russia_imports_xts["2015/"],na.rm = TRUE)
Russia_sum_import<-data.frame(NA, nrow=length(index(Russia_imports_xts["2015/"])))

for (i in 1:length(index(Russia_imports_xts["2015/"]))) {
  Russia_sum_import[i]<-sum(as.numeric(Russia_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Russia_sum_import<-as.xts(t(Russia_sum_import), order.by = Date)
colnames(Russia_sum_import)<-c("Russia")


#Saudi Arabia  
Saudi_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Saudi Arabia") %>% select(-Countries.and.Territories))
colnames(Saudi_imports) <-Saudi_imports[1,]
Saudi_imports<-Saudi_imports[-c(1),]

Saudi_imports_xts <- (as.xts(Saudi_imports, order.by=Date))
Saudi_imports_xts_num<-as.numeric(Saudi_imports_xts["2015/"],na.rm = TRUE)
Saudi_sum_import<-data.frame(NA, nrow=length(index(Saudi_imports_xts["2015/"])))

for (i in 1:length(index(Saudi_imports_xts["2015/"]))) {
  Saudi_sum_import[i]<-sum(as.numeric(Saudi_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Saudi_sum_import<-as.xts(t(Saudi_sum_import), order.by = Date)
colnames(Saudi_sum_import)<-c("Saudi")



#Sweden  
Sweden_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Sweden") %>% select(-Countries.and.Territories))
colnames(Sweden_imports) <-Sweden_imports[1,]
Sweden_imports<-Sweden_imports[-c(1),]

Sweden_imports_xts <- (as.xts(Sweden_imports, order.by=Date))
Sweden_imports_xts_num<-as.numeric(Sweden_imports_xts["2015/"],na.rm = TRUE)
Sweden_sum_import<-data.frame(NA, nrow=length(index(Sweden_imports_xts["2015/"])))

for (i in 1:length(index(Sweden_imports_xts["2015/"]))) {
  Sweden_sum_import[i]<-sum(as.numeric(Sweden_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Sweden_sum_import<-as.xts(t(Sweden_sum_import), order.by = Date)
colnames(Sweden_sum_import)<-c("Sweden")


#Singapore  
Singapore_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Singapore") %>% select(-Countries.and.Territories))
colnames(Singapore_imports) <-Singapore_imports[1,]
Singapore_imports<-Singapore_imports[-c(1),]

Singapore_imports_xts <- (as.xts(Singapore_imports, order.by=Date))
Singapore_imports_xts_num<-as.numeric(Singapore_imports_xts["2015/"],na.rm = TRUE)
Singapore_sum_import<-data.frame(NA, nrow=length(index(Singapore_imports_xts["2015/"])))

for (i in 1:length(index(Singapore_imports_xts["2015/"]))) {
  Singapore_sum_import[i]<-sum(as.numeric(Singapore_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Singapore_sum_import<-as.xts(t(Singapore_sum_import), order.by = Date)
colnames(Singapore_sum_import)<-c("Singapore")



#Slovenia  
Slovenia_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Slovenia") %>% select(-Countries.and.Territories))
colnames(Slovenia_imports) <-Slovenia_imports[1,]
Slovenia_imports<-Slovenia_imports[-c(1),]

Slovenia_imports_xts <- (as.xts(Slovenia_imports, order.by=Date))
Slovenia_imports_xts_num<-as.numeric(Slovenia_imports_xts["2015/"],na.rm = TRUE)
Slovenia_sum_import<-data.frame(NA, nrow=length(index(Slovenia_imports_xts["2015/"])))

for (i in 1:length(index(Slovenia_imports_xts["2015/"]))) {
  Slovenia_sum_import[i]<-sum(as.numeric(Slovenia_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Slovenia_sum_import<-as.xts(t(Slovenia_sum_import), order.by = Date)
colnames(Slovenia_sum_import)<-c("Slovenia")



#Slovakia  
Slovakia_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Slovakia") %>% select(-Countries.and.Territories))
colnames(Slovakia_imports) <-Slovakia_imports[1,]
Slovakia_imports<-Slovakia_imports[-c(1),]

Slovakia_imports_xts <- (as.xts(Slovakia_imports, order.by=Date))
Slovakia_imports_xts_num<-as.numeric(Slovakia_imports_xts["2015/"],na.rm = TRUE)
Slovakia_sum_import<-data.frame(NA, nrow=length(index(Slovakia_imports_xts["2015/"])))

for (i in 1:length(index(Slovakia_imports_xts["2015/"]))) {
  Slovakia_sum_import[i]<-sum(as.numeric(Slovakia_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Slovakia_sum_import<-as.xts(t(Slovakia_sum_import), order.by = Date)
colnames(Slovakia_sum_import)<-c("Slovakia")


#Thailand  
Thailand_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Thailand") %>% select(-Countries.and.Territories))
colnames(Thailand_imports) <-Thailand_imports[1,]
Thailand_imports<-Thailand_imports[-c(1),]

Thailand_imports_xts <- (as.xts(Thailand_imports, order.by=Date))
Thailand_imports_xts_num<-as.numeric(Thailand_imports_xts["2015/"],na.rm = TRUE)
Thailand_sum_import<-data.frame(NA, nrow=length(index(Thailand_imports_xts["2015/"])))

for (i in 1:length(index(Thailand_imports_xts["2015/"]))) {
  Thailand_sum_import[i]<-sum(as.numeric(Thailand_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Thailand_sum_import<-as.xts(t(Thailand_sum_import), order.by = Date)
colnames(Thailand_sum_import)<-c("Thailand")


#Turkey  
Turkey_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Turkey") %>% select(-Countries.and.Territories))
colnames(Turkey_imports) <-Turkey_imports[1,]
Turkey_imports<-Turkey_imports[-c(1),]

Turkey_imports_xts <- (as.xts(Turkey_imports, order.by=Date))
Turkey_imports_xts_num<-as.numeric(Turkey_imports_xts["2015/"],na.rm = TRUE)
Turkey_sum_import<-data.frame(NA, nrow=length(index(Turkey_imports_xts["2015/"])))

for (i in 1:length(index(Turkey_imports_xts["2015/"]))) {
  Turkey_sum_import[i]<-sum(as.numeric(Turkey_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Turkey_sum_import<-as.xts(t(Turkey_sum_import), order.by = Date)
colnames(Turkey_sum_import)<-c("Turkey")


#Taiwan  
Taiwan_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Taiwan") %>% select(-Countries.and.Territories))
colnames(Taiwan_imports) <-Taiwan_imports[1,]
Taiwan_imports<-Taiwan_imports[-c(1),]

Taiwan_imports_xts <- (as.xts(Taiwan_imports, order.by=Date))
Taiwan_imports_xts_num<-as.numeric(Taiwan_imports_xts["2015/"],na.rm = TRUE)
Taiwan_sum_import<-data.frame(NA, nrow=length(index(Taiwan_imports_xts["2015/"])))

for (i in 1:length(index(Taiwan_imports_xts["2015/"]))) {
  Taiwan_sum_import[i]<-sum(as.numeric(Taiwan_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

Taiwan_sum_import<-as.xts(t(Taiwan_sum_import), order.by = Date)
colnames(Taiwan_sum_import)<-c("Taiwan")


#USA  
USA_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="USA") %>% select(-Countries.and.Territories))
colnames(USA_imports) <-USA_imports[1,]
USA_imports<-USA_imports[-c(1),]
USA_imports_xts <- (as.xts(USA_imports, order.by=Date))
USA_imports_xts_num<-as.numeric(USA_imports_xts["2015/"],na.rm = TRUE) 


USA_sum_import<-data.frame(NA, length(index(USA_imports_xts["2015/"])))

for (i in 1:length(index(USA_imports_xts["2015/"]))) {
  USA_sum_import[i]<-sum(as.numeric(USA_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

USA_sum_import<-as.xts(t(USA_sum_import), order.by = Date)
colnames(USA_sum_import)<-c("USA")


#Great Britian  
GB_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Great Britain") %>% select(-Countries.and.Territories))
colnames(GB_imports) <-GB_imports[1,]
GB_imports<-GB_imports[-c(1),]

GB_imports_xts <- (as.xts(GB_imports, order.by=Date))
GB_imports_xts_num<-as.numeric(GB_imports_xts["2015/"],na.rm = TRUE)
GB_sum_import<-data.frame(NA, nrow=length(index(GB_imports_xts["2015/"])))

for (i in 1:length(index(GB_imports_xts["2015/"]))) {
  GB_sum_import[i]<-sum(as.numeric(GB_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

GB_sum_import<-as.xts(t(GB_sum_import), order.by = Date)
colnames(GB_sum_import)<-c("GB")



#Northern Ireland 
NI_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Northern Ireland") %>% select(-Countries.and.Territories))
colnames(NI_imports) <-NI_imports[1,]
NI_imports<-NI_imports[-c(1),]

NI_imports_xts <- (as.xts(NI_imports, order.by=Date))
NI_imports_xts_num<-as.numeric(NI_imports_xts["2015/"],na.rm = TRUE)
NI_sum_import<-data.frame(NA, nrow=length(index(NI_imports_xts["2015/"])))

for (i in 1:length(index(NI_imports_xts["2015/"]))) {
  NI_sum_import[i]<-sum(as.numeric(NI_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

NI_sum_import<-as.xts(t(NI_sum_import), order.by = Date)
colnames(NI_sum_import)<-c("NI")



#South Africa 
SA_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="South Africa") %>% select(-Countries.and.Territories))
colnames(SA_imports) <-SA_imports[1,]
SA_imports<-SA_imports[-c(1),]

SA_imports_xts <- (as.xts(SA_imports, order.by=Date))
SA_imports_xts_num<-as.numeric(SA_imports_xts["2015/"],na.rm = TRUE)
SA_sum_import<-data.frame(NA, nrow=length(index(SA_imports_xts["2015/"])))

for (i in 1:length(index(SA_imports_xts["2015/"]))) {
  SA_sum_import[i]<-sum(as.numeric(SA_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

SA_sum_import<-as.xts(t(SA_sum_import), order.by = Date)
colnames(SA_sum_import)<-c("SA")

#EU country not specified 
OTHER_EU_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="EU country not specified") %>% select(-Countries.and.Territories))
colnames(OTHER_EU_imports) <-OTHER_EU_imports[1,]
OTHER_EU_imports<-OTHER_EU_imports[-c(1),]

OTHER_EU_imports_xts <- (as.xts(OTHER_EU_imports, order.by=Date))
OTHER_EU_imports_xts_num<-as.numeric(OTHER_EU_imports_xts["2015/"],na.rm = TRUE)
OTHER_EU_sum_import<-data.frame(NA, nrow=length(index(OTHER_EU_imports_xts["2015/"])))

for (i in 1:length(index(OTHER_EU_imports_xts["2015/"]))) {
  OTHER_EU_sum_import[i]<-sum(as.numeric(OTHER_EU_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

OTHER_EU_sum_import<-as.xts(t(OTHER_EU_sum_import), order.by = Date)
colnames(OTHER_EU_sum_import)<-c("OTHER_EU")

#OTHER 
OTHER_imports<- t(subset(Ireland_imports,Ireland_Imports["2014-12-01"]=="Other countries") %>% select(-Countries.and.Territories))
colnames(OTHER_imports) <-OTHER_imports[1,]
OTHER_imports<-OTHER_imports[-c(1),]

OTHER_imports_xts <- (as.xts(OTHER_imports, order.by=Date))
OTHER_imports_xts_num<-as.numeric(OTHER_imports_xts["2015/"],na.rm = TRUE)
OTHER_sum_import<-data.frame(NA, nrow=length(index(OTHER_imports_xts["2015/"])))

for (i in 1:length(index(OTHER_imports_xts["2015/"]))) {
  OTHER_sum_import[i]<-sum(as.numeric(OTHER_imports_xts[i,2:ncol(Austria_Imports_xts)]),na.rm = TRUE)
}

OTHER_sum_import<-as.xts(t(OTHER_sum_import), order.by = Date)
colnames(OTHER_sum_import)<-c("OTHER")



Import_Country<-merge(Austria_sum_import,Australia_sum_import,Belgium_sum_import,Bulgaria_sum_import,Brazil_sum_import,Canada_sum_import,Switzerland_sum_import,China_sum_import,Cyprus_sum_import,Czech_sum_import,Germany_sum_import,Denmark_sum_import,Estonia_sum_import,Spain_sum_import,Finland_sum_import,France_sum_import,Greece_sum_import,Croatia_sum_import,Hungary_sum_import,India_sum_import,Italy_sum_import,Japan_sum_import,Korea_sum_import,Lithuania_sum_import,Luxembourg_sum_import,Latvia_sum_import,Malta_sum_import,Mexico_sum_import,Malaysia_sum_import,Netherlands_sum_import,Norway_sum_import,Poland_sum_import,Portugal_sum_import,Romania_sum_import,Russia_sum_import,Saudi_sum_import,Sweden_sum_import,Singapore_sum_import,Slovenia_sum_import,Slovakia_sum_import,Thailand_sum_import,Turkey_sum_import,Taiwan_sum_import,USA_sum_import,GB_sum_import,NI_sum_import,SA_sum_import,OTHER_EU_sum_import,OTHER_sum_import)


TOTAL_sum_import<-data.frame(NA, nrow=length(index(Import_Country["2015/"])))

for (i in 1:length(index(Import_Country["2015/"]))) {
  TOTAL_sum_import[i]<-sum(as.numeric(Import_Country[i]),na.rm = TRUE)
}


TOTAL_sum_import<-as.xts(t(TOTAL_sum_import), order.by = Date)
colnames(TOTAL_sum_import)<-c("TOTAL")



Total_Import_Country<-(merge(Austria_sum_import,Australia_sum_import,Belgium_sum_import,Bulgaria_sum_import,Brazil_sum_import,Canada_sum_import,Switzerland_sum_import,China_sum_import,Cyprus_sum_import,Czech_sum_import,Germany_sum_import,Denmark_sum_import,Estonia_sum_import,Spain_sum_import,Finland_sum_import,France_sum_import,Greece_sum_import,Croatia_sum_import,Hungary_sum_import,India_sum_import,Italy_sum_import,Japan_sum_import,Korea_sum_import,Lithuania_sum_import,Luxembourg_sum_import,Latvia_sum_import,Malta_sum_import,Mexico_sum_import,Malaysia_sum_import,Netherlands_sum_import,Norway_sum_import,Poland_sum_import,Portugal_sum_import,Romania_sum_import,Russia_sum_import,Saudi_sum_import,Sweden_sum_import,Singapore_sum_import,Slovenia_sum_import,Slovakia_sum_import,Thailand_sum_import,Turkey_sum_import,Taiwan_sum_import,USA_sum_import,GB_sum_import,NI_sum_import,SA_sum_import,OTHER_EU_sum_import,OTHER_sum_import,TOTAL_sum_import))
Total_Share_Import<-data.frame(100*(Total_Import_Country["2015/"])/as.numeric(Total_Import_Country$TOTAL["2015/"]))
Total_Share_xts_Import<-((Total_Import_Country["2015/"])/as.numeric(Total_Import_Country$TOTAL["2015/"]))




Import_Other<-data.frame(NA, nrow=length(index(Total_Import_Country["2015/"])))

Import_Other<-Total_Import_Country$TOTAL-((Total_Import_Country$USA+Total_Import_Country$Germany+Total_Import_Country$China+Total_Import_Country$GB+Total_Import_Country$NI))

annual_growth_imports<-growth(Total_Import_Country,freq=12)
annual_growth_imports_Others<-growth(Import_Other,freq=12)

month_growth_imports<-growth(Total_Import_Country,1)
month_growth_imports_Others<-growth(Import_Other,freq=1)

monthly_growth_imports_vol<-as.xts(round(growth(Ireland_Imports_SA_vol_xts,freq = 1),2))
monthly_growth_imports_vol<-as.xts(round(growth(Ireland_Imports_SA_vol_xts,freq = 1),2))


Contribution_annual_growth_Import<-round(annual_growth_imports["2016/"]*(lag.xts(Total_Share_xts_Import["2016/"],k=12)),2)
sum_contribution_annual_growth_Import<-sum(Contribution_annual_growth_Import$USA["2016/"],Contribution_annual_growth_Import$GB["2016/"],Contribution_annual_growth_Import$NI["2016/"],Contribution_annual_growth_Import$Germany["2016/"],Contribution_annual_growth_Import$France["2016/"],Contribution_annual_growth_Import$China["2016/"])



Other_contribution_import<-data.frame(NA, nrow=length(index(Contribution_annual_growth_Import["2016/"])))

Other_contribution_import<-Contribution_annual_growth_Import$TOTAL-((Contribution_annual_growth_Import$USA+Contribution_annual_growth_Import$Germany+Contribution_annual_growth_Import$GB+Contribution_annual_growth_Import$NI+Contribution_annual_growth_Import$Switzerland+Contribution_annual_growth_Import$China))


Other_contribution_Imports<-as.xts(Other_contribution_import$TOTAL)
colnames(Other_contribution_Imports)<-c("OTHER")

summary_contribution_Imports<-data.frame(merge(Contribution_annual_growth_Import$USA["2023/"],Contribution_annual_growth_Import$Germany["2023/"],Contribution_annual_growth_Import$GB["2023/"],Contribution_annual_growth_Import$NI["2023/"],Contribution_annual_growth_Import$Switzerland["2023/"],Contribution_annual_growth_Import$China["2023/"],Other_contribution_Imports$OTHER["2023/"]),index(Contribution_annual_growth_Import["2023/"]))
colnames(summary_contribution_Imports)<-c("USA","Germany","Great Britian","Northern Ireland","Switzerland","China","Other","Date")
summary_contribution_melt_Imports<-melt(summary_contribution_Imports,id=c("Date"))


destination_plot_imports<-ggplot(data=summary_contribution_melt_Imports, aes(y=value, x=Date, fill=variable)) + 
  geom_bar(position="stack", stat="identity")+theme(legend.position.inside='bottom',element_text(size=100))+
  labs(x="",
       title="Contribution of Ireland's Main Trading Partners to Import Growth",
       rcaption="Date Source: CSO monthly external trade data",
       y="contribution to annual growth (%)")+
  scale_fill_manual(name = "", values  = c("USA" = DOF_colours[1],"Germany" = DOF_colours[3],"Great Britian"=DOF_colours[2],"Northern Ireland"=DOF_colours[4],"Switzerland"=DOF_colours[5],"China"=DOF_colours[7],"Other"=DOF_colours[6]))+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))
```

```{r country level write-up, include=FALSE}
text_annual_import_USA<-conditional(annual_growth_imports$USA[length(annual_growth_imports$USA)])
text_annual_contribution_import_USA<-conditional(Contribution_annual_growth_Import$USA[length(Contribution_annual_growth_Import$USA)])
text_annual_contribution_import_USA_TOTAL<-paste0(round(100*Contribution_annual_growth_Import$USA[length(Contribution_annual_growth_Import$USA)]/(Contribution_annual_growth_Import$TOTAL[length(Contribution_annual_growth_Import$TOTAL)]),1),sep="%")


text_annual_import_GB<-conditional(annual_growth_imports$GB[length(annual_growth_imports$GB)])
text_annual_contribution_import_GB<-conditional(Contribution_annual_growth_Import$GB[length(Contribution_annual_growth_Import$GB)])
text_annual_contribution_import_GB_TOTAL<-paste0(round(100*Contribution_annual_growth_Import$GB[length(Contribution_annual_growth_Import$GB)]/(Contribution_annual_growth_Import$TOTAL[length(Contribution_annual_growth_Import$TOTAL)]),1),sep="%")


text_annual_import_NI<-conditional(annual_growth_imports$NI[length(annual_growth_imports$NI)])
text_annual_contribution_import_NI<-conditional(Contribution_annual_growth_Import$NI[length(Contribution_annual_growth_Import$NI)])
text_annual_contribution_import_NI_TOTAL<-paste0(round(100*Contribution_annual_growth_Import$NI[length(Contribution_annual_growth_Import$NI)]/(Contribution_annual_growth_Import$TOTAL[length(Contribution_annual_growth_Import$TOTAL)]),1),sep="%")

text_annual_import_Germany<-conditional(annual_growth_imports$Germany[length(annual_growth_imports$Germany)])
text_annual_contribution_import_Germany<-conditional(Contribution_annual_growth_Import$Germany[length(Contribution_annual_growth_Import$Germany)])
text_annual_contribution_import_Germany_TOTAL<-paste0(round(100*Contribution_annual_growth_Import$Germany[length(Contribution_annual_growth_Import$Germany)]/(Contribution_annual_growth_Import$TOTAL[length(Contribution_annual_growth_Import$TOTAL)]),1),sep="%")

text_annual_import_Switzerland<-conditional(annual_growth_imports$Switzerland[length(annual_growth_imports$Switzerland)])
text_annual_contribution_import_Switzerland_TOTAL<-paste0(round(100*Contribution_annual_growth_Import$Switzerland[length(Contribution_annual_growth_Import$Switzerland)]/(Contribution_annual_growth_Import$TOTAL[length(Contribution_annual_growth_Import$TOTAL)]),1),sep="%")


Contribution_annual_growth_Import$Switzerland

text_annual_import_Other<-conditional(annual_growth_imports_Others[length(annual_growth_imports_Others)])
text_annual_contribution_import_Other<-conditional(Other_contribution_import$TOTAL[length(Other_contribution_import$TOTAL)])
text_annual_contribution_import_Other_TOTAL<-paste0(round(100*Other_contribution_import$TOTAL[length(Other_contribution_import$TOTAL)]/(Contribution_annual_growth_Import$TOTAL[length(Contribution_annual_growth_Import$TOTAL)]),1),sep="%")

#annual volume growth
annual_growth_imports_vol<-as.xts(round(growth(Ireland_Imports_vol_xts,freq = 12),2))

#Monthly volume growth
monthly_growth_imports_vol<-as.xts(round(growth(Ireland_Imports_SA_vol_xts,freq = 1),2))

monthly_growth_imports_vol<-na.omit(monthly_growth_imports_vol)

#volume measure text
Vol_monthly_text_Import<-conditional(monthly_growth_imports_vol[length(monthly_growth_imports_vol)])
Vol_annual_Import<-conditional(annual_growth_imports_vol[length(annual_growth_imports_vol)])


```

```{r Import Products, include=FALSE}

#Product level breakdown 
Ireland_imports<- subset(cso_get_data("TSM10"),Statistic=="Value of Imports") %>% select(-Statistic)

Ire_Imports<- t(data.frame(subset(cso_get_data("TSM10"),Statistic=="Value of Imports")))
Date_Import<-seq(as.Date("2014-10-01"), by="month",length.out=NROW(Ire_Imports))

Ireland_Imports<-as.xts(Ire_Imports, order.by = Date_Import)



#Live animals except fish etc. (00)
Live_animals_00<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Live animals except fish etc. (00)") %>% select(-Countries.and.Territories,-Commodity.group))
Live_animals_00_imports_xts <- (as.xts(Live_animals_00, order.by=Date_Import[4:length(Date_Import)]))
Live_animals_00_imports<-data.frame(NA, nrow=length(index(Live_animals_00_imports_xts["2015/"])))

for (i in 1:length(index(Live_animals_00_imports_xts["2015/"]))) {
  Live_animals_00_imports[i]<-sum(as.numeric(Live_animals_00_imports_xts[i]),na.rm = TRUE)
}

Live_animals_00_imports<-as.xts(t(Live_animals_00_imports), order.by = Date_Import[4:length(Date_Import)])
colnames(Live_animals_00_imports)<-c("Live_animals_00")



#Meat and meat preparations (01)
meat_01<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Meat and meat preparations (01)") %>% select(-Countries.and.Territories,-Commodity.group))
meat_01_imports_xts <- (as.xts(meat_01, order.by=Date))
meat_01_imports<-data.frame(NA, nrow=length(index(meat_01_imports_xts["2015/"])))

for (i in 1:length(index(meat_01_imports_xts["2015/"]))) {
  meat_01_imports[i]<-sum(as.numeric(meat_01_imports_xts[i]),na.rm = TRUE)
}

meat_01_imports<-as.xts(t(meat_01_imports), order.by = Date)
colnames(meat_01_imports)<-c("meat_01")



#Dairy products and birds eggs (02)                                       
Dairy_02<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Dairy products and birds eggs (02)") %>% select(-Countries.and.Territories,-Commodity.group))
Dairy_02_imports_xts <- (as.xts(Dairy_02, order.by=Date))
Dairy_02_imports<-data.frame(NA, nrow=length(index(Dairy_02_imports_xts["2015/"])))

for (i in 1:length(index(Dairy_02_imports_xts["2015/"]))) {
  Dairy_02_imports[i]<-sum(as.numeric(Dairy_02_imports_xts[i]),na.rm = TRUE)
}

Dairy_02_imports<-as.xts(t(Dairy_02_imports), order.by = Date)
colnames(Dairy_02_imports)<-c("Dairy_02")


#Fish, crustaceans, molluscs and preparations thereof (03)                                       
                                       
Fish_03<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Fish, crustaceans, molluscs and preparations thereof (03)") %>% select(-Countries.and.Territories,-Commodity.group))
Fish_03_imports_xts <- (as.xts(Fish_03, order.by=Date))
Fish_03_imports<-data.frame(NA, nrow=length(index(Fish_03_imports_xts["2015/"])))

for (i in 1:length(index(Fish_03_imports_xts["2015/"]))) {
  Fish_03_imports[i]<-sum(as.numeric(Fish_03_imports_xts[i]),na.rm = TRUE)
}

Fish_03_imports<-as.xts(t(Fish_03_imports), order.by = Date)
colnames(Fish_03_imports)<-c("Fish_03")



#Cereals and cereal preparations (04)                                       

Cereal_04<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Cereals and cereal preparations (04)") %>% select(-Countries.and.Territories,-Commodity.group))
Cereal_04_imports_xts <- (as.xts(Cereal_04, order.by=Date))
Cereal_04_imports<-data.frame(NA, nrow=length(index(Cereal_04_imports_xts["2015/"])))

for (i in 1:length(index(Cereal_04_imports_xts["2015/"]))) {
  Cereal_04_imports[i]<-sum(as.numeric(Cereal_04_imports_xts[i]),na.rm = TRUE)
}

Cereal_04_imports<-as.xts(t(Cereal_04_imports), order.by = Date)
colnames(Cereal_04_imports)<-c("Cereal_04")




#Vegetables and fruit (05)                                       

Veg_05<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Vegetables and fruit (05)") %>% select(-Countries.and.Territories,-Commodity.group))
Veg_05_imports_xts <- (as.xts(Veg_05, order.by=Date))
Veg_05_imports<-data.frame(NA, nrow=length(index(Veg_05_imports_xts["2015/"])))

for (i in 1:length(index(Veg_05_imports_xts["2015/"]))) {
  Veg_05_imports[i]<-sum(as.numeric(Veg_05_imports_xts[i]),na.rm = TRUE)
}

Veg_05_imports<-as.xts(t(Veg_05_imports), order.by = Date)
colnames(Veg_05_imports)<-c("Veg_05")


#Sugar, sugar preparations and honey (06)      
Sugar_06<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Sugar, sugar preparations and honey (06)") %>% select(-Countries.and.Territories,-Commodity.group))
Sugar_06_imports_xts <- (as.xts(Sugar_06, order.by=Date))
Sugar_06_imports<-data.frame(NA, nrow=length(index(Sugar_06_imports_xts["2015/"])))

for (i in 1:length(index(Sugar_06_imports_xts["2015/"]))) {
  Sugar_06_imports[i]<-sum(as.numeric(Sugar_06_imports_xts[i]),na.rm = TRUE)
}

Sugar_06_imports<-as.xts(t(Sugar_06_imports), order.by = Date)
colnames(Sugar_06_imports)<-c("Sugar_06")

#Coffee, tea, cocoa, spices and manufactures thereof (07)      
Coffee_07<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Coffee, tea, cocoa, spices and manufactures thereof (07)") %>% select(-Countries.and.Territories,-Commodity.group))
Coffee_07_imports_xts <- (as.xts(Coffee_07, order.by=Date))
Coffee_07_imports<-data.frame(NA, nrow=length(index(Coffee_07_imports_xts["2015/"])))

for (i in 1:length(index(Coffee_07_imports_xts["2015/"]))) {
  Coffee_07_imports[i]<-sum(as.numeric(Coffee_07_imports_xts[i]),na.rm = TRUE)
}

Coffee_07_imports<-as.xts(t(Coffee_07_imports), order.by = Date)
colnames(Coffee_07_imports)<-c("Coffee_07")






#Feeding stuffs for animals, excluding unmilled cereals (08)      
animal_feed_08<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Feeding stuffs for animals, excluding unmilled cereals (08)") %>% select(-Countries.and.Territories,-Commodity.group))
animal_feed_08_imports_xts <- (as.xts(animal_feed_08, order.by=Date))
animal_feed_08_imports<-data.frame(NA, nrow=length(index(animal_feed_08_imports_xts["2015/"])))

for (i in 1:length(index(animal_feed_08_imports_xts["2015/"]))) {
  animal_feed_08_imports[i]<-sum(as.numeric(animal_feed_08_imports_xts[i]),na.rm = TRUE)
}

animal_feed_08_imports<-as.xts(t(animal_feed_08_imports), order.by = Date)
colnames(animal_feed_08_imports)<-c("animal_feed_08")



#Feeding stuffs for animals, excluding unmilled cereals (08)      
animal_feed_08<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Feeding stuffs for animals, excluding unmilled cereals (08)") %>% select(-Countries.and.Territories,-Commodity.group))
animal_feed_08_imports_xts <- (as.xts(animal_feed_08, order.by=Date))
animal_feed_08_imports<-data.frame(NA, nrow=length(index(animal_feed_08_imports_xts["2015/"])))

for (i in 1:length(index(animal_feed_08_imports_xts["2015/"]))) {
  animal_feed_08_imports[i]<-sum(as.numeric(animal_feed_08_imports_xts[i]),na.rm = TRUE)
}

animal_feed_08_imports<-as.xts(t(animal_feed_08_imports), order.by = Date)
colnames(animal_feed_08_imports)<-c("animal_feed_08")


#Miscellaneous edible products and preparations (09)     
Miscellaneous_09<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Miscellaneous edible products and preparations (09)") %>% select(-Countries.and.Territories,-Commodity.group))
Miscellaneous_09_imports_xts <- (as.xts(Miscellaneous_09, order.by=Date))

Miscellaneous_09_imports<-data.frame(NA, nrow=length(index(Miscellaneous_09_imports_xts["2015/"])))

for (i in 1:length(index(Miscellaneous_09_imports_xts["2015/"]))) {
  Miscellaneous_09_imports[i]<-sum(as.numeric(Miscellaneous_09_imports_xts[i]),na.rm = TRUE)
}

Miscellaneous_09_imports<-as.xts(t(Miscellaneous_09_imports), order.by = Date)
colnames(Miscellaneous_09_imports)<-c("Miscellaneous_09")


#Beverages (11)                                                      
Beverages_11<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Beverages (11)") %>% select(-Countries.and.Territories,-Commodity.group))
Beverages_11_imports_xts <- (as.xts(Beverages_11, order.by=Date))

Beverages_11_imports<-data.frame(NA, nrow=length(index(Beverages_11_imports_xts["2015/"])))

for (i in 1:length(index(Beverages_11_imports_xts["2015/"]))) {
  Beverages_11_imports[i]<-sum(as.numeric(Beverages_11_imports_xts[i]),na.rm = TRUE)
}

Beverages_11_imports<-as.xts(t(Beverages_11_imports), order.by = Date)
colnames(Beverages_11_imports)<-c("Beverages_11")


#Tobacco and tobacco manufactures (12)                                                      
Tobacco_12<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Tobacco and tobacco manufactures (12)") %>% select(-Countries.and.Territories,-Commodity.group))
Tobacco_12_imports_xts <- (as.xts(Tobacco_12, order.by=Date))

Tobacco_12_imports<-data.frame(NA, nrow=length(index(Tobacco_12_imports_xts["2015/"])))

for (i in 1:length(index(Tobacco_12_imports_xts["2015/"]))) {
  Tobacco_12_imports[i]<-sum(as.numeric(Tobacco_12_imports_xts[i]),na.rm = TRUE)
}

Tobacco_12_imports<-as.xts(t(Tobacco_12_imports), order.by = Date)
colnames(Tobacco_12_imports)<-c("Tobacco_12")



#Hides, skins and furskins, raw (21)                                                      
Hides_21<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Hides, skins and furskins, raw (21)") %>% select(-Countries.and.Territories,-Commodity.group))
Hides_21_imports_xts <- (as.xts(Hides_21, order.by=Date))

Hides_21_imports<-data.frame(NA, nrow=length(index(Hides_21_imports_xts["2015/"])))

for (i in 1:length(index(Hides_21_imports_xts["2015/"]))) {
  Hides_21_imports[i]<-sum(as.numeric(Hides_21_imports_xts[i]),na.rm = TRUE)
}

Hides_21_imports<-as.xts(t(Hides_21_imports), order.by = Date)
colnames(Hides_21_imports)<-c("Hides_21")


#Oilseeds and oleaginous fruit (22)                                                      
oilseeds_22<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Oilseeds and oleaginous fruit (22)") %>% select(-Countries.and.Territories,-Commodity.group))
oilseeds_22_imports_xts <- (as.xts(oilseeds_22, order.by=Date))

oilseeds_22_imports<-data.frame(NA, nrow=length(index(oilseeds_22_imports_xts["2015/"])))

for (i in 1:length(index(oilseeds_22_imports_xts["2015/"]))) {
  oilseeds_22_imports[i]<-sum(as.numeric(oilseeds_22_imports_xts[i]),na.rm = TRUE)
}

oilseeds_22_imports<-as.xts(t(oilseeds_22_imports), order.by = Date)
colnames(oilseeds_22_imports)<-c("oilseeds_22")



# Crude rubber, including synthetic and reclaimed rubber (23)  

Crude_rubber_23<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Crude rubber, including synthetic and reclaimed rubber (23)") %>% select(-Countries.and.Territories,-Commodity.group))
Crude_rubber_23_imports_xts <- (as.xts(Crude_rubber_23, order.by=Date))

Crude_rubber_23_imports<-data.frame(NA, nrow=length(index(Crude_rubber_23_imports_xts["2015/"])))

for (i in 1:length(index(Crude_rubber_23_imports_xts["2015/"]))) {
  Crude_rubber_23_imports[i]<-sum(as.numeric(Crude_rubber_23_imports_xts[i]),na.rm = TRUE)
}

Crude_rubber_23_imports<-as.xts(t(Crude_rubber_23_imports), order.by = Date)
colnames(Crude_rubber_23_imports)<-c("Crude_rubber_23")


# Cork and wood (24)

Cork_24<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Cork and wood (24)") %>% select(-Countries.and.Territories,-Commodity.group))
Cork_24_imports_xts <- (as.xts(Cork_24, order.by=Date))

Cork_24_imports<-data.frame(NA, nrow=length(index(Cork_24_imports_xts["2015/"])))

for (i in 1:length(index(Cork_24_imports_xts["2015/"]))) {
  Cork_24_imports[i]<-sum(as.numeric(Cork_24_imports_xts[i]),na.rm = TRUE)
}

Cork_24_imports<-as.xts(t(Cork_24_imports), order.by = Date)
colnames(Cork_24_imports)<-c("Cork_24")


# Pulp and waste paper (25)" 

Pulp_25<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Pulp and waste paper (25)") %>% select(-Countries.and.Territories,-Commodity.group))
Pulp_25_imports_xts <- (as.xts(Pulp_25, order.by=Date))

Pulp_25_imports<-data.frame(NA, nrow=length(index(Pulp_25_imports_xts["2015/"])))

for (i in 1:length(index(Pulp_25_imports_xts["2015/"]))) {
  Pulp_25_imports[i]<-sum(as.numeric(Pulp_25_imports_xts[i]),na.rm = TRUE)
}

Pulp_25_imports<-as.xts(t(Pulp_25_imports), order.by = Date)
colnames(Pulp_25_imports)<-c("Pulp_25")


# Textile fibres, excluding wool tops, and their wastes (26) 

Textile_fibres_26<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Textile fibres, excluding wool tops, and their wastes (26)") %>% select(-Countries.and.Territories,-Commodity.group))
Textile_fibres_26_imports_xts <- (as.xts(Textile_fibres_26, order.by=Date))

Textile_fibres_26_imports<-data.frame(NA, nrow=length(index(Textile_fibres_26_imports_xts["2015/"])))

for (i in 1:length(index(Textile_fibres_26_imports_xts["2015/"]))) {
  Textile_fibres_26_imports[i]<-sum(as.numeric(Textile_fibres_26_imports_xts[i]),na.rm = TRUE)
}

Textile_fibres_26_imports<-as.xts(t(Textile_fibres_26_imports), order.by = Date)
colnames(Textile_fibres_26_imports)<-c("Textile_fibres_26")



# Crude fertilisers and minerals, excluding coal, petroleum etc. (27)

Crude_fertilisers_27<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Crude fertilisers and minerals, excluding coal, petroleum etc. (27)") %>% select(-Countries.and.Territories,-Commodity.group))
Crude_fertilisers_27_imports_xts <- (as.xts(Crude_fertilisers_27, order.by=Date))

Crude_fertilisers_27_imports<-data.frame(NA, nrow=length(index(Crude_fertilisers_27_imports_xts["2015/"])))

for (i in 1:length(index(Crude_fertilisers_27_imports_xts["2015/"]))) {
  Crude_fertilisers_27_imports[i]<-sum(as.numeric(Crude_fertilisers_27_imports_xts[i]),na.rm = TRUE)
}

Crude_fertilisers_27_imports<-as.xts(t(Crude_fertilisers_27_imports), order.by = Date)
colnames(Crude_fertilisers_27_imports)<-c("Crude_fertilisers_27")




# Metalliferous ores and metal scrap (28)

Metalliferous_ores_28<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Metalliferous ores and metal scrap (28)") %>% select(-Countries.and.Territories,-Commodity.group))
Metalliferous_ores_28_imports_xts <- (as.xts(Metalliferous_ores_28, order.by=Date))

Metalliferous_ores_28_imports<-data.frame(NA, nrow=length(index(Metalliferous_ores_28_imports_xts["2015/"])))

for (i in 1:length(index(Metalliferous_ores_28_imports_xts["2015/"]))) {
  Metalliferous_ores_28_imports[i]<-sum(as.numeric(Metalliferous_ores_28_imports_xts[i]),na.rm = TRUE)
}

Metalliferous_ores_28_imports<-as.xts(t(Metalliferous_ores_28_imports), order.by = Date)
colnames(Metalliferous_ores_28_imports)<-c("Metalliferous_ores_28")

# Crude animal and vegetable materials, n.e.s. (29)

Crude_animal_and_vegetable_materials_29<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Crude animal and vegetable materials, n.e.s. (29)") %>% select(-Countries.and.Territories,-Commodity.group))
Crude_animal_and_vegetable_materials_29_imports_xts <- (as.xts(Crude_animal_and_vegetable_materials_29, order.by=Date))

Crude_animal_and_vegetable_materials_29_imports<-data.frame(NA, nrow=length(index(Crude_animal_and_vegetable_materials_29_imports_xts["2015/"])))

for (i in 1:length(index(Crude_animal_and_vegetable_materials_29_imports_xts["2015/"]))) {
  Crude_animal_and_vegetable_materials_29_imports[i]<-sum(as.numeric(Crude_animal_and_vegetable_materials_29_imports_xts[i]),na.rm = TRUE)
}

Crude_animal_and_vegetable_materials_29_imports<-as.xts(t(Crude_animal_and_vegetable_materials_29_imports), order.by = Date)
colnames(Crude_animal_and_vegetable_materials_29_imports)<-c("Crude_animal_and_vegetable_materials_29")



# Coal, coke and briquettes (32)

Coal_32<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Coal, coke and briquettes (32)") %>% select(-Countries.and.Territories,-Commodity.group))
Coal_32_imports_xts <- (as.xts(Coal_32, order.by=Date))

Coal_32_imports<-data.frame(NA, nrow=length(index(Coal_32_imports_xts["2015/"])))

for (i in 1:length(index(Coal_32_imports_xts["2015/"]))) {
  Coal_32_imports[i]<-sum(as.numeric(Coal_32_imports_xts[i]),na.rm = TRUE)
}

Coal_32_imports<-as.xts(t(Coal_32_imports), order.by = Date)
colnames(Coal_32_imports)<-c("Coal_32_exports")


# Petroleum, petroleum products and related materials (33)

Petroleum_33<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Petroleum, petroleum products and related materials (33)") %>% select(-Countries.and.Territories,-Commodity.group))
Petroleum_33_imports_xts <- (as.xts(Petroleum_33, order.by=Date))

Petroleum_33_imports<-data.frame(NA, nrow=length(index(Petroleum_33_imports_xts["2015/"])))

for (i in 1:length(index(Petroleum_33_imports_xts["2015/"]))) {
  Petroleum_33_imports[i]<-sum(as.numeric(Petroleum_33_imports_xts[i]),na.rm = TRUE)
}

Petroleum_33_imports<-as.xts(t(Petroleum_33_imports), order.by = Date)
colnames(Petroleum_33_imports)<-c("Petroleum_33")

# Gas, natural and manufactured (34)

Gas_34<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Gas, natural and manufactured (34)") %>% select(-Countries.and.Territories,-Commodity.group))
Gas_34_imports_xts <- (as.xts(Gas_34, order.by=Date))

Gas_34_imports<-data.frame(NA, nrow=length(index(Gas_34_imports_xts["2015/"])))

for (i in 1:length(index(Gas_34_imports_xts["2015/"]))) {
  Gas_34_imports[i]<-sum(as.numeric(Gas_34_imports_xts[i]),na.rm = TRUE)
}

Gas_34_imports<-as.xts(t(Gas_34_imports), order.by = Date)
colnames(Gas_34_imports)<-c("Gas_34")


# Electric current (35)

Electric_current_35<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Electric current (35)") %>% select(-Countries.and.Territories,-Commodity.group))
Electric_current_35_imports_xts <- (as.xts(Electric_current_35, order.by=Date))

Electric_current_35_imports<-data.frame(NA, nrow=length(index(Electric_current_35_imports_xts["2015/"])))

for (i in 1:length(index(Electric_current_35_imports_xts["2015/"]))) {
  Electric_current_35_imports[i]<-sum(as.numeric(Electric_current_35_imports_xts[i]),na.rm = TRUE)
}

Electric_current_35_imports<-as.xts(t(Electric_current_35_imports), order.by = Date)
colnames(Electric_current_35_imports)<-c("Electric_current_35")

# Animal oils and fats (41)

Animal_oils_and_fats_41<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Animal oils and fats (41)") %>% select(-Countries.and.Territories,-Commodity.group))
Animal_oils_and_fats_41_imports_xts <- (as.xts(Animal_oils_and_fats_41, order.by=Date))

Animal_oils_and_fats_41_imports<-data.frame(NA, nrow=length(index(Animal_oils_and_fats_41_imports_xts["2015/"])))

for (i in 1:length(index(Animal_oils_and_fats_41_imports_xts["2015/"]))) {
  Animal_oils_and_fats_41_imports[i]<-sum(as.numeric(Animal_oils_and_fats_41_imports_xts[i]),na.rm = TRUE)
}

Animal_oils_and_fats_41_imports<-as.xts(t(Animal_oils_and_fats_41_imports), order.by = Date)
colnames(Animal_oils_and_fats_41_imports)<-c("Animal_oils_and_fats_41")

# Fixed vegetable oils and fats (42)

Fixed_vegetable_oils_and_fats_42<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Fixed vegetable oils and fats (42)") %>% select(-Countries.and.Territories,-Commodity.group))
Fixed_vegetable_oils_and_fats_42_imports_xts <- (as.xts(Fixed_vegetable_oils_and_fats_42, order.by=Date))

Fixed_vegetable_oils_and_fats_42_imports<-data.frame(NA, nrow=length(index(Fixed_vegetable_oils_and_fats_42_imports_xts["2015/"])))

for (i in 1:length(index(Fixed_vegetable_oils_and_fats_42_imports_xts["2015/"]))) {
  Fixed_vegetable_oils_and_fats_42_imports[i]<-sum(as.numeric(Fixed_vegetable_oils_and_fats_42_imports_xts[i]),na.rm = TRUE)
}

Fixed_vegetable_oils_and_fats_42_imports<-as.xts(t(Fixed_vegetable_oils_and_fats_42_imports), order.by = Date)
colnames(Fixed_vegetable_oils_and_fats_42_imports)<-c("Fixed_vegetable_oils_and_fats_42")

# Animal and vegetable oils and fats, processed, and waxes (43)

Animal_and_vegetable_oils_43<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Animal and vegetable oils and fats, processed, and waxes (43)") %>% select(-Countries.and.Territories,-Commodity.group))
Animal_and_vegetable_oils_43_imports_xts <- (as.xts(Animal_and_vegetable_oils_43, order.by=Date))

Animal_and_vegetable_oils_43_imports<-data.frame(NA, nrow=length(index(Animal_and_vegetable_oils_43_imports_xts["2015/"])))

for (i in 1:length(index(Animal_and_vegetable_oils_43_imports_xts["2015/"]))) {
  Animal_and_vegetable_oils_43_imports[i]<-sum(as.numeric(Animal_and_vegetable_oils_43_imports_xts[i]),na.rm = TRUE)
}

Animal_and_vegetable_oils_43_imports<-as.xts(t(Animal_and_vegetable_oils_43_imports), order.by = Date)
colnames(Animal_and_vegetable_oils_43_imports)<-c("Animal_and_vegetable_oils_43")

# Organic chemicals (51)

Organic_chemicals_51<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Organic chemicals (51)") %>% select(-Countries.and.Territories,-Commodity.group))
Organic_chemicals_51_imports_xts <- (as.xts(Organic_chemicals_51, order.by=Date))

Organic_chemicals_51_imports<-data.frame(NA, nrow=length(index(Organic_chemicals_51_imports_xts["2015/"])))

for (i in 1:length(index(Organic_chemicals_51_imports_xts["2015/"]))) {
  Organic_chemicals_51_imports[i]<-sum(as.numeric(Organic_chemicals_51_imports_xts[i]),na.rm = TRUE)
}

Organic_chemicals_51_imports<-as.xts(t(Organic_chemicals_51_imports), order.by = Date)
colnames(Organic_chemicals_51_imports)<-c("Organic_chemicals_51")


# Inorganic chemicals (52)

Inorganic_chemicals_52<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Inorganic chemicals (52)") %>% select(-Countries.and.Territories,-Commodity.group))
Inorganic_chemicals_52_imports_xts <- (as.xts(Inorganic_chemicals_52, order.by=Date))

Inorganic_chemicals_52_imports<-data.frame(NA, nrow=length(index(Inorganic_chemicals_52_imports_xts["2015/"])))

for (i in 1:length(index(Inorganic_chemicals_52_imports_xts["2015/"]))) {
  Inorganic_chemicals_52_imports[i]<-sum(as.numeric(Inorganic_chemicals_52_imports_xts[i]),na.rm = TRUE)
}

Inorganic_chemicals_52_imports<-as.xts(t(Inorganic_chemicals_52_imports), order.by = Date)
colnames(Inorganic_chemicals_52_imports)<-c("Inorganic_chemicals_52")



#Dyeing, tanning and colouring materials (53)

Dyeing_tanning_53<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Dyeing, tanning and colouring materials (53)") %>% select(-Countries.and.Territories,-Commodity.group))
Dyeing_tanning_53_imports_xts <- (as.xts(Dyeing_tanning_53, order.by=Date))

Dyeing_tanning_53_imports<-data.frame(NA, nrow=length(index(Dyeing_tanning_53_imports_xts["2015/"])))

for (i in 1:length(index(Dyeing_tanning_53_imports_xts["2015/"]))) {
  Dyeing_tanning_53_imports[i]<-sum(as.numeric(Dyeing_tanning_53_imports_xts[i]),na.rm = TRUE)
}

Dyeing_tanning_53_imports<-as.xts(t(Dyeing_tanning_53_imports), order.by = Date)
colnames(Dyeing_tanning_53_imports)<-c("Dyeing_tanning_53")



#Medicinal and pharmaceutical products (54)

Medicinal_and_pharma_54<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Medicinal and pharmaceutical products (54)") %>% select(-Countries.and.Territories,-Commodity.group))
Medicinal_and_pharma_54_imports_xts <- (as.xts(Medicinal_and_pharma_54, order.by=Date))

Medicinal_and_pharma_54_imports<-data.frame(NA, nrow=length(index(Medicinal_and_pharma_54_imports_xts["2015/"])))

for (i in 1:length(index(Medicinal_and_pharma_54_imports_xts["2015/"]))) {
  Medicinal_and_pharma_54_imports[i]<-sum(as.numeric(Medicinal_and_pharma_54_imports_xts[i]),na.rm = TRUE)
}

Medicinal_and_pharma_54_imports<-as.xts(t(Medicinal_and_pharma_54_imports), order.by = Date)
colnames(Medicinal_and_pharma_54_imports)<-c("Medicinal_and_pharma_54")




#Essential oils, perfume materials, toilet preparations etc. (55) 

Essential_oils_55<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Essential oils, perfume materials, toilet preparations etc. (55)") %>% select(-Countries.and.Territories,-Commodity.group))
Essential_oils_55_imports_xts <- (as.xts(Essential_oils_55, order.by=Date))

Essential_oils_55_imports<-data.frame(NA, nrow=length(index(Essential_oils_55_imports_xts["2015/"])))

for (i in 1:length(index(Essential_oils_55_imports_xts["2015/"]))) {
  Essential_oils_55_imports[i]<-sum(as.numeric(Essential_oils_55_imports_xts[i]),na.rm = TRUE)
}

Essential_oils_55_imports<-as.xts(t(Essential_oils_55_imports), order.by = Date)
colnames(Essential_oils_55_imports)<-c("Essential_oils_55")


#Fertilisers, manufactured (56)
Fertilisers_56<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Fertilisers, manufactured (56)") %>% select(-Countries.and.Territories,-Commodity.group))
Fertilisers_56_imports_xts <- (as.xts(Fertilisers_56, order.by=Date))

Fertilisers_56_imports<-data.frame(NA, nrow=length(index(Fertilisers_56_imports_xts["2015/"])))

for (i in 1:length(index(Fertilisers_56_imports_xts["2015/"]))) {
  Fertilisers_56_imports[i]<-sum(as.numeric(Fertilisers_56_imports_xts[i]),na.rm = TRUE)
}

Fertilisers_56_imports<-as.xts(t(Fertilisers_56_imports), order.by = Date)
colnames(Fertilisers_56_imports)<-c("Fertilisers_56")



#Plastics in primary forms (57)
Plastics_57<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Plastics in primary forms (57)") %>% select(-Countries.and.Territories,-Commodity.group))
Plastics_57_imports_xts <- (as.xts(Plastics_57, order.by=Date))

Plastics_57_imports<-data.frame(NA, nrow=length(index(Plastics_57_imports_xts["2015/"])))

for (i in 1:length(index(Plastics_57_imports_xts["2015/"]))) {
  Plastics_57_imports[i]<-sum(as.numeric(Plastics_57_imports_xts[i]),na.rm = TRUE)
}

Plastics_57_imports<-as.xts(t(Plastics_57_imports), order.by = Date)
colnames(Plastics_57_imports)<-c("Plastics_57")



#Plastics in non-primary forms (58)
Plastics_non_primary_58<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Plastics in non-primary forms (58)") %>% select(-Countries.and.Territories,-Commodity.group))
Plastics_non_primary_58_imports_xts <- (as.xts(Plastics_non_primary_58, order.by=Date))

Plastics_non_primary_58_imports<-data.frame(NA, nrow=length(index(Plastics_non_primary_58_imports_xts["2015/"])))

for (i in 1:length(index(Plastics_non_primary_58_imports_xts["2015/"]))) {
  Plastics_non_primary_58_imports[i]<-sum(as.numeric(Plastics_non_primary_58_imports_xts[i]),na.rm = TRUE)
}

Plastics_non_primary_58_imports<-as.xts(t(Plastics_non_primary_58_imports), order.by = Date)
colnames(Plastics_non_primary_58_imports)<-c("Plastics_non_primary_58")


#Chemical materials and products, n.e.s. (59)
Chemical_materials_59<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Chemical materials and products, n.e.s. (59)") %>% select(-Countries.and.Territories,-Commodity.group))
Chemical_materials_59_imports_xts <- (as.xts(Chemical_materials_59, order.by=Date))

Chemical_materials_59_imports<-data.frame(NA, nrow=length(index(Chemical_materials_59_imports_xts["2015/"])))

for (i in 1:length(index(Chemical_materials_59_imports_xts["2015/"]))) {
  Chemical_materials_59_imports[i]<-sum(as.numeric(Chemical_materials_59_imports_xts[i]),na.rm = TRUE)
}

Chemical_materials_59_imports<-as.xts(t(Chemical_materials_59_imports), order.by = Date)
colnames(Chemical_materials_59_imports)<-c("Chemical_materials_59")


#Leather, leather manufactures and dressed furskins (61)
Leather_61<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Leather, leather manufactures and dressed furskins (61)") %>% select(-Countries.and.Territories,-Commodity.group))
Leather_61_imports_xts <- (as.xts(Leather_61, order.by=Date))

Leather_61_imports<-data.frame(NA, nrow=length(index(Leather_61_imports_xts["2015/"])))

for (i in 1:length(index(Leather_61_imports_xts["2015/"]))) {
  Leather_61_imports[i]<-sum(as.numeric(Leather_61_imports_xts[i]),na.rm = TRUE)
}

Leather_61_imports<-as.xts(t(Leather_61_imports), order.by = Date)
colnames(Leather_61_imports)<-c("Leather_61")



#Rubber manufactures, n.e.s. (62)
Rubber_manufactures_62<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Rubber manufactures, n.e.s. (62)") %>% select(-Countries.and.Territories,-Commodity.group))
Rubber_manufactures_62_imports_xts <- (as.xts(Rubber_manufactures_62, order.by=Date))

Rubber_manufactures_62_imports<-data.frame(NA, nrow=length(index(Rubber_manufactures_62_imports_xts["2015/"])))

for (i in 1:length(index(Rubber_manufactures_62_imports_xts["2015/"]))) {
  Rubber_manufactures_62_imports[i]<-sum(as.numeric(Rubber_manufactures_62_imports_xts[i]),na.rm = TRUE)
}

Rubber_manufactures_62_imports<-as.xts(t(Rubber_manufactures_62_imports), order.by = Date)
colnames(Rubber_manufactures_62_imports)<-c("Rubber_manufactures_62")




#Cork and wood manufactures, excluding furniture (63)
Cork_and_wood_manufactures_63<-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Cork and wood manufactures, excluding furniture (63)") %>% select(-Countries.and.Territories,-Commodity.group))
Cork_and_wood_manufactures_63_imports_xts <- (as.xts(Cork_and_wood_manufactures_63, order.by=Date))

Cork_and_wood_manufactures_63_imports<-data.frame(NA, nrow=length(index(Cork_and_wood_manufactures_63_imports_xts["2015/"])))

for (i in 1:length(index(Cork_and_wood_manufactures_63_imports_xts["2015/"]))) {
  Cork_and_wood_manufactures_63_imports[i]<-sum(as.numeric(Cork_and_wood_manufactures_63_imports_xts[i]),na.rm = TRUE)
}

Cork_and_wood_manufactures_63_imports<-as.xts(t(Cork_and_wood_manufactures_63_imports), order.by = Date)
colnames(Cork_and_wood_manufactures_63_imports)<-c("Cork_and_wood_manufactures_63")



#Paper, paperboard and articles of paper pulp, paper etc. (64)       
Paper_paperboard_64 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Paper, paperboard and articles of paper pulp, paper etc. (64)") %>% select(-Countries.and.Territories,-Commodity.group))
Paper_paperboard_64_imports_xts <- (as.xts(Paper_paperboard_64, order.by=Date))

Paper_paperboard_64_imports<-data.frame(NA, nrow=length(index(Paper_paperboard_64_imports_xts["2015/"])))

for (i in 1:length(index(Paper_paperboard_64_imports_xts["2015/"]))) {
  Paper_paperboard_64_imports[i]<-sum(as.numeric(Paper_paperboard_64_imports_xts[i]),na.rm = TRUE)
}

Paper_paperboard_64_imports<-as.xts(t(Paper_paperboard_64_imports), order.by = Date)
colnames(Paper_paperboard_64_imports)<-c("Paper_paperboard_64")


#Textile yarn, fabrics, made-up articles and related products (65) 

Textile_yarn_65 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Textile yarn, fabrics, made-up articles and related products (65)") %>% select(-Countries.and.Territories,-Commodity.group))
Textile_yarn_65_imports_xts <- (as.xts(Textile_yarn_65, order.by=Date))

Textile_yarn_65_imports<-data.frame(NA, nrow=length(index(Textile_yarn_65_imports_xts["2015/"])))

for (i in 1:length(index(Textile_yarn_65_imports_xts["2015/"]))) {
  Textile_yarn_65_imports[i]<-sum(as.numeric(Textile_yarn_65_imports_xts[i]),na.rm = TRUE)
}

Textile_yarn_65_imports<-as.xts(t(Textile_yarn_65_imports), order.by = Date)
colnames(Textile_yarn_65_imports)<-c("Textile_yarn_65")




#Non-metallic mineral manufactures, n.e.s. (66)  

Non_metallic_mineral_66 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Non-metallic mineral manufactures, n.e.s. (66)") %>% select(-Countries.and.Territories,-Commodity.group))
Non_metallic_mineral_66_imports_xts <- (as.xts(Non_metallic_mineral_66, order.by=Date))

Non_metallic_mineral_66_imports<-data.frame(NA, nrow=length(index(Non_metallic_mineral_66_imports_xts["2015/"])))

for (i in 1:length(index(Non_metallic_mineral_66_imports_xts["2015/"]))) {
  Non_metallic_mineral_66_imports[i]<-sum(as.numeric(Non_metallic_mineral_66_imports_xts[i]),na.rm = TRUE)
}

Non_metallic_mineral_66_imports<-as.xts(t(Non_metallic_mineral_66_imports), order.by = Date)
colnames(Non_metallic_mineral_66_imports)<-c("Non_metallic_mineral_66")




#Iron and steel (67)
Iron_and_steel_67 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Iron and steel (67)") %>% select(-Countries.and.Territories,-Commodity.group))
Iron_and_steel_67_imports_xts <- (as.xts(Iron_and_steel_67, order.by=Date))

Iron_and_steel_67_imports<-data.frame(NA, nrow=length(index(Iron_and_steel_67_imports_xts["2015/"])))

for (i in 1:length(index(Iron_and_steel_67_imports_xts["2015/"]))) {
  Iron_and_steel_67_imports[i]<-sum(as.numeric(Iron_and_steel_67_imports_xts[i]),na.rm = TRUE)
}

Iron_and_steel_67_imports<-as.xts(t(Iron_and_steel_67_imports), order.by = Date)
colnames(Iron_and_steel_67_imports)<-c("Iron_and_steel_67")

#Non-ferrous metals (68)                                             
Non_ferrous_metals_68 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Non-ferrous metals (68)") %>% select(-Countries.and.Territories,-Commodity.group))
Non_ferrous_metals_68_imports_xts <- (as.xts(Non_ferrous_metals_68, order.by=Date))

Non_ferrous_metals_68_imports<-data.frame(NA, nrow=length(index(Non_ferrous_metals_68_imports_xts["2015/"])))

for (i in 1:length(index(Non_ferrous_metals_68_imports_xts["2015/"]))) {
  Non_ferrous_metals_68_imports[i]<-sum(as.numeric(Non_ferrous_metals_68_imports_xts[i]),na.rm = TRUE)
}

Non_ferrous_metals_68_imports<-as.xts(t(Non_ferrous_metals_68_imports), order.by = Date)
colnames(Non_ferrous_metals_68_imports)<-c("Non_ferrous_metals_68")



#Manufactures of metal, n.e.s. (69)
Manufactures_of_metal_69 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Manufactures of metal, n.e.s. (69)") %>% select(-Countries.and.Territories,-Commodity.group))
Manufactures_of_metal_69_imports_xts <- (as.xts(Manufactures_of_metal_69, order.by=Date))

Manufactures_of_metal_69_imports<-data.frame(NA, nrow=length(index(Manufactures_of_metal_69_imports_xts["2015/"])))

for (i in 1:length(index(Manufactures_of_metal_69_imports_xts["2015/"]))) {
  Manufactures_of_metal_69_imports[i]<-sum(as.numeric(Manufactures_of_metal_69_imports_xts[i]),na.rm = TRUE)
}

Manufactures_of_metal_69_imports<-as.xts(t(Manufactures_of_metal_69_imports), order.by = Date)
colnames(Manufactures_of_metal_69_imports)<-c("Manufactures_of_metal_69")



#Power generating machinery and equipment (71)

Power_generating_machinery_71 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Power generating machinery and equipment (71)") %>% select(-Countries.and.Territories,-Commodity.group))
Power_generating_machinery_71_imports_xts <- (as.xts(Power_generating_machinery_71, order.by=Date))

Power_generating_machinery_71_imports<-data.frame(NA, nrow=length(index(Power_generating_machinery_71_imports_xts["2015/"])))

for (i in 1:length(index(Power_generating_machinery_71_imports_xts["2015/"]))) {
  Power_generating_machinery_71_imports[i]<-sum(as.numeric(Power_generating_machinery_71_imports_xts[i]),na.rm = TRUE)
}

Power_generating_machinery_71_imports<-as.xts(t(Power_generating_machinery_71_imports), order.by = Date)
colnames(Power_generating_machinery_71_imports)<-c("Power_generating_machinery_71")


#Machinery specialised for particular industries (72)

Machinery_specialised_for_particular_industries_72 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Machinery specialised for particular industries (72)") %>% select(-Countries.and.Territories,-Commodity.group))
Machinery_specialised_for_particular_industries_72_imports_xts <- (as.xts(Machinery_specialised_for_particular_industries_72, order.by=Date))

Machinery_specialised_for_particular_industries_72_imports<-data.frame(NA, nrow=length(index(Machinery_specialised_for_particular_industries_72_imports_xts["2015/"])))

for (i in 1:length(index(Machinery_specialised_for_particular_industries_72_imports_xts["2015/"]))) {
  Machinery_specialised_for_particular_industries_72_imports[i]<-sum(as.numeric(Machinery_specialised_for_particular_industries_72_imports_xts[i]),na.rm = TRUE)
}

Machinery_specialised_for_particular_industries_72_imports<-as.xts(t(Machinery_specialised_for_particular_industries_72_imports), order.by = Date)
colnames(Machinery_specialised_for_particular_industries_72_imports)<-c("Machinery_specialised_for_particular_industries_72")


#Metalworking machinery (73)

Metalworking_machinery_73 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Metalworking machinery (73)") %>% select(-Countries.and.Territories,-Commodity.group))
Metalworking_machinery_73_imports_xts <- (as.xts(Metalworking_machinery_73, order.by=Date))

Metalworking_machinery_73_imports<-data.frame(NA, nrow=length(index(Metalworking_machinery_73_imports_xts["2015/"])))

for (i in 1:length(index(Metalworking_machinery_73_imports_xts["2015/"]))) {
  Metalworking_machinery_73_imports[i]<-sum(as.numeric(Metalworking_machinery_73_imports_xts[i]),na.rm = TRUE)
}

Metalworking_machinery_73_imports<-as.xts(t(Metalworking_machinery_73_imports), order.by = Date)
colnames(Metalworking_machinery_73_imports)<-c("Metalworking_machinery_73")


#General industrial machinery and parts, n.e.s. (74)


General_industrial_machinery_74 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="General industrial machinery and parts, n.e.s. (74)") %>% select(-Countries.and.Territories,-Commodity.group))
General_industrial_machinery_74_imports_xts <- (as.xts(General_industrial_machinery_74, order.by=Date))

General_industrial_machinery_74_imports<-data.frame(NA, nrow=length(index(General_industrial_machinery_74_imports_xts["2015/"])))

for (i in 1:length(index(General_industrial_machinery_74_imports_xts["2015/"]))) {
  General_industrial_machinery_74_imports[i]<-sum(as.numeric(General_industrial_machinery_74_imports_xts[i]),na.rm = TRUE)
}

General_industrial_machinery_74_imports<-as.xts(t(General_industrial_machinery_74_imports), order.by = Date)
colnames(General_industrial_machinery_74_imports)<-c("General_industrial_machinery_74")




#Office machines and automatic data processing equipment (75)


Office_machines_and_automatic_data_processing_equipment_75 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Office machines and automatic data processing equipment (75)") %>% select(-Countries.and.Territories,-Commodity.group))
Office_machines_and_automatic_data_processing_equipment_75_imports_xts <- (as.xts(Office_machines_and_automatic_data_processing_equipment_75, order.by=Date))

Office_machines_and_automatic_data_processing_equipment_75_imports<-data.frame(NA, nrow=length(index(Office_machines_and_automatic_data_processing_equipment_75_imports_xts["2015/"])))

for (i in 1:length(index(Office_machines_and_automatic_data_processing_equipment_75_imports_xts["2015/"]))) {
  Office_machines_and_automatic_data_processing_equipment_75_imports[i]<-sum(as.numeric(Office_machines_and_automatic_data_processing_equipment_75_imports_xts[i]),na.rm = TRUE)
}

Office_machines_and_automatic_data_processing_equipment_75_imports<-as.xts(t(Office_machines_and_automatic_data_processing_equipment_75_imports), order.by = Date)
colnames(Office_machines_and_automatic_data_processing_equipment_75_imports)<-c("Office_machines_and_automatic_data_processing_equipment_75")


#Telecommunications and sound recording, reproducing equipment (76)


Telecommunications_and_sound_recording_76 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Telecommunications and sound recording, reproducing equipment (76)") %>% select(-Countries.and.Territories,-Commodity.group))
Telecommunications_and_sound_recording_76_imports_xts <- (as.xts(Telecommunications_and_sound_recording_76, order.by=Date))

Telecommunications_and_sound_recording_76_imports<-data.frame(NA, nrow=length(index(Telecommunications_and_sound_recording_76_imports_xts["2015/"])))

for (i in 1:length(index(Telecommunications_and_sound_recording_76_imports_xts["2015/"]))) {
  Telecommunications_and_sound_recording_76_imports[i]<-sum(as.numeric(Telecommunications_and_sound_recording_76_imports_xts[i]),na.rm = TRUE)
}

Telecommunications_and_sound_recording_76_imports<-as.xts(t(Telecommunications_and_sound_recording_76_imports), order.by = Date)
colnames(Telecommunications_and_sound_recording_76_imports)<-c("Telecommunications_and_sound_recording_76")



#Electrical machinery, appliances etc., n.e.s. (77)                  


Electrical_machinery_77 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Electrical machinery, appliances etc., n.e.s. (77)") %>% select(-Countries.and.Territories,-Commodity.group))
Electrical_machinery_77_imports_xts <- (as.xts(Electrical_machinery_77, order.by=Date))

Electrical_machinery_77_imports<-data.frame(NA, nrow=length(index(Electrical_machinery_77_imports_xts["2015/"])))

for (i in 1:length(index(Electrical_machinery_77_imports_xts["2015/"]))) {
  Electrical_machinery_77_imports[i]<-sum(as.numeric(Electrical_machinery_77_imports_xts[i]),na.rm = TRUE)
}

Electrical_machinery_77_imports<-as.xts(t(Electrical_machinery_77_imports), order.by = Date)
colnames(Electrical_machinery_77_imports)<-c("Electrical_machinery_77")





#Road vehicles (78)


Road_vehicles_78 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Road vehicles (78)") %>% select(-Countries.and.Territories,-Commodity.group))
Road_vehicles_78_imports_xts <- (as.xts(Road_vehicles_78, order.by=Date))

Road_vehicles_78_imports<-data.frame(NA, nrow=length(index(Road_vehicles_78_imports_xts["2015/"])))

for (i in 1:length(index(Road_vehicles_78_imports_xts["2015/"]))) {
  Road_vehicles_78_imports[i]<-sum(as.numeric(Road_vehicles_78_imports_xts[i]),na.rm = TRUE)
}

Road_vehicles_78_imports<-as.xts(t(Road_vehicles_78_imports), order.by = Date)
colnames(Road_vehicles_78_imports)<-c("Road_vehicles_78")





#Other transport equipment (79)      

Other_transport_equipment_79 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Other transport equipment (79)") %>% select(-Countries.and.Territories,-Commodity.group))
Other_transport_equipment_79_imports_xts <- (as.xts(Other_transport_equipment_79, order.by=Date))

Other_transport_equipment_79_imports<-data.frame(NA, nrow=length(index(Other_transport_equipment_79_imports_xts["2015/"])))

for (i in 1:length(index(Other_transport_equipment_79_imports_xts["2015/"]))) {
  Other_transport_equipment_79_imports[i]<-sum(as.numeric(Other_transport_equipment_79_imports_xts[i]),na.rm = TRUE)
}

Other_transport_equipment_79_imports<-as.xts(t(Other_transport_equipment_79_imports), order.by = Date)
colnames(Other_transport_equipment_79_imports)<-c("Other_transport_equipment_79")


#Prefab buildings; plumbing and electrical fixtures and fittings (81)

Prefab_buildings_plumbing_and_electrical_81 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Prefab buildings; plumbing and electrical fixtures and fittings (81)") %>% select(-Countries.and.Territories,-Commodity.group))
Prefab_buildings_plumbing_and_electrical_81_imports_xts <- (as.xts(Prefab_buildings_plumbing_and_electrical_81, order.by=Date))

Prefab_buildings_plumbing_and_electrical_81_imports<-data.frame(NA, nrow=length(index(Prefab_buildings_plumbing_and_electrical_81_imports_xts["2015/"])))

for (i in 1:length(index(Prefab_buildings_plumbing_and_electrical_81_imports_xts["2015/"]))) {
  Prefab_buildings_plumbing_and_electrical_81_imports[i]<-sum(as.numeric(Prefab_buildings_plumbing_and_electrical_81_imports_xts[i]),na.rm = TRUE)
}

Prefab_buildings_plumbing_and_electrical_81_imports<-as.xts(t(Prefab_buildings_plumbing_and_electrical_81_imports), order.by = Date)
colnames(Prefab_buildings_plumbing_and_electrical_81_imports)<-c("Prefab_buildings_plumbing_and_electrical_81")



#Furniture and parts thereof (82)
Furniture_and_parts_thereof_82 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Furniture and parts thereof (82)") %>% select(-Countries.and.Territories,-Commodity.group))
Furniture_and_parts_thereof_82_imports_xts <- (as.xts(Furniture_and_parts_thereof_82, order.by=Date))

Furniture_and_parts_thereof_82_imports<-data.frame(NA, nrow=length(index(Furniture_and_parts_thereof_82_imports_xts["2015/"])))

for (i in 1:length(index(Furniture_and_parts_thereof_82_imports_xts["2015/"]))) {
  Furniture_and_parts_thereof_82_imports[i]<-sum(as.numeric(Furniture_and_parts_thereof_82_imports_xts[i]),na.rm = TRUE)
}

Furniture_and_parts_thereof_82_imports<-as.xts(t(Furniture_and_parts_thereof_82_imports), order.by = Date)
colnames(Furniture_and_parts_thereof_82_imports)<-c("Furniture_and_parts_thereof_82")




#Travel goods, handbags and similar containers (83)
Travel_goods_handbags_and_similar_containers_83 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Travel goods, handbags and similar containers (83)") %>% select(-Countries.and.Territories,-Commodity.group))
Travel_goods_handbags_and_similar_containers_83_imports_xts <- (as.xts(Travel_goods_handbags_and_similar_containers_83, order.by=Date))

Travel_goods_handbags_and_similar_containers_83_imports<-data.frame(NA, nrow=length(index(Travel_goods_handbags_and_similar_containers_83_imports_xts["2015/"])))

for (i in 1:length(index(Travel_goods_handbags_and_similar_containers_83_imports_xts["2015/"]))) {
  Travel_goods_handbags_and_similar_containers_83_imports[i]<-sum(as.numeric(Travel_goods_handbags_and_similar_containers_83_imports_xts[i]),na.rm = TRUE)
}

Travel_goods_handbags_and_similar_containers_83_imports<-as.xts(t(Travel_goods_handbags_and_similar_containers_83_imports), order.by = Date)
colnames(Travel_goods_handbags_and_similar_containers_83_imports)<-c("Travel_goods_handbags_and_similar_containers_83")



#Articles of apparel and clothing accessories (84)
Articles_of_apparel_84 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Articles of apparel and clothing accessories (84)") %>% select(-Countries.and.Territories,-Commodity.group))
Articles_of_apparel_84_imports_xts <- (as.xts(Articles_of_apparel_84, order.by=Date))

Articles_of_apparel_84_imports<-data.frame(NA, nrow=length(index(Articles_of_apparel_84_imports_xts["2015/"])))

for (i in 1:length(index(Articles_of_apparel_84_imports_xts["2015/"]))) {
  Articles_of_apparel_84_imports[i]<-sum(as.numeric(Articles_of_apparel_84_imports_xts[i]),na.rm = TRUE)
}

Articles_of_apparel_84_imports<-as.xts(t(Articles_of_apparel_84_imports), order.by = Date)
colnames(Articles_of_apparel_84_imports)<-c("Articles_of_apparel_84")




#Footwear (85)

Footwear_85 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Footwear (85)") %>% select(-Countries.and.Territories,-Commodity.group))
Footwear_85_imports_xts <- (as.xts(Footwear_85, order.by=Date))

Footwear_85_imports<-data.frame(NA, nrow=length(index(Footwear_85_imports_xts["2015/"])))

for (i in 1:length(index(Footwear_85_imports_xts["2015/"]))) {
  Footwear_85_imports[i]<-sum(as.numeric(Footwear_85_imports_xts[i]),na.rm = TRUE)
}

Footwear_85_imports<-as.xts(t(Footwear_85_imports), order.by = Date)
colnames(Footwear_85_imports)<-c("Footwear_85")



#Professional, scientific and controlling apparatus (87)

Professional_scientific_and_controlling_apparatus_87 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Professional, scientific and controlling apparatus (87)") %>% select(-Countries.and.Territories,-Commodity.group))
Professional_scientific_and_controlling_apparatus_87_imports_xts <- (as.xts(Professional_scientific_and_controlling_apparatus_87, order.by=Date))

Professional_scientific_and_controlling_apparatus_87_imports<-data.frame(NA, nrow=length(index(Professional_scientific_and_controlling_apparatus_87_imports_xts["2015/"])))

for (i in 1:length(index(Professional_scientific_and_controlling_apparatus_87_imports_xts["2015/"]))) {
  Professional_scientific_and_controlling_apparatus_87_imports[i]<-sum(as.numeric(Professional_scientific_and_controlling_apparatus_87_imports_xts[i]),na.rm = TRUE)
}

Professional_scientific_and_controlling_apparatus_87_imports<-as.xts(t(Professional_scientific_and_controlling_apparatus_87_imports), order.by = Date)
colnames(Professional_scientific_and_controlling_apparatus_87_imports)<-c("Professional_scientific_and_controlling_apparatus_87")



#Photographic apparatus, optical goods, watches and clocks (88)

Photographic_apparatus_88 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Photographic apparatus, optical goods, watches and clocks (88)") %>% select(-Countries.and.Territories,-Commodity.group))
Photographic_apparatus_88_imports_xts <- (as.xts(Photographic_apparatus_88, order.by=Date))

Photographic_apparatus_88_imports<-data.frame(NA, nrow=length(index(Photographic_apparatus_88_imports_xts["2015/"])))

for (i in 1:length(index(Photographic_apparatus_88_imports_xts["2015/"]))) {
  Photographic_apparatus_88_imports[i]<-sum(as.numeric(Photographic_apparatus_88_imports_xts[i]),na.rm = TRUE)
}

Photographic_apparatus_88_imports<-as.xts(t(Photographic_apparatus_88_imports), order.by = Date)
colnames(Photographic_apparatus_88_imports)<-c("Photographic_apparatus_88")


#Miscellaneous manufactured articles, n.e.s. (89)

Miscellaneous_manufactured_articles_89 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Miscellaneous manufactured articles, n.e.s. (89)") %>% select(-Countries.and.Territories,-Commodity.group))
Miscellaneous_manufactured_articles_89_imports_xts <- (as.xts(Miscellaneous_manufactured_articles_89, order.by=Date))

Miscellaneous_manufactured_articles_89_imports<-data.frame(NA, nrow=length(index(Miscellaneous_manufactured_articles_89_imports_xts["2015/"])))

for (i in 1:length(index(Miscellaneous_manufactured_articles_89_imports_xts["2015/"]))) {
  Miscellaneous_manufactured_articles_89_imports[i]<-sum(as.numeric(Miscellaneous_manufactured_articles_89_imports_xts[i]),na.rm = TRUE)
}

Miscellaneous_manufactured_articles_89_imports<-as.xts(t(Miscellaneous_manufactured_articles_89_imports), order.by = Date)
colnames(Miscellaneous_manufactured_articles_89_imports)<-c("Miscellaneous_manufactured_articles_89")

#Commodities and transactions n.e.s. (9)

Commodities_and_transactions_9 <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Commodities and transactions n.e.s. (9)") %>% select(-Countries.and.Territories,-Commodity.group))
Commodities_and_transactions_9_imports_xts <- (as.xts(Commodities_and_transactions_9, order.by=Date))

Commodities_and_transactions_9_imports<-data.frame(NA, nrow=length(index(Commodities_and_transactions_9_imports_xts["2015/"])))

for (i in 1:length(index(Commodities_and_transactions_9_imports_xts["2015/"]))) {
  Commodities_and_transactions_9_imports[i]<-sum(as.numeric(Commodities_and_transactions_9_imports_xts[i]),na.rm = TRUE)
}

Commodities_and_transactions_9_imports<-as.xts(t(Commodities_and_transactions_9_imports), order.by = Date)
colnames(Commodities_and_transactions_9_imports)<-c("Commodities_and_transactions_9")

#Unclassified estimates 


Unclassified_estimates <-t(subset(Ireland_imports,Ireland_Imports["2014-11-01"]=="Unclassified estimates") %>% select(-Countries.and.Territories,-Commodity.group))
Unclassified_estimates_imports_xts <- (as.xts(Unclassified_estimates, order.by=Date))

Unclassified_estimates_imports<-data.frame(NA, nrow=length(index(Unclassified_estimates_imports_xts["2015/"])))

for (i in 1:length(index(Unclassified_estimates_imports_xts["2015/"]))) {
  Unclassified_estimates_imports[i]<-sum(as.numeric(Unclassified_estimates_imports_xts[i]),na.rm = TRUE)
}

Unclassified_estimates_imports<-as.xts(t(Unclassified_estimates_imports), order.by = Date)
colnames(Unclassified_estimates_imports)<-c("Unclassified_estimates")

Import_Product<-merge.xts(Live_animals_00_imports,meat_01_imports,Dairy_02_imports,Fish_03_imports,Cereal_04_imports,Veg_05_imports,Sugar_06_imports,Coffee_07_imports,
                      animal_feed_08_imports,Miscellaneous_09_imports,Beverages_11_imports,Tobacco_12_imports,Hides_21_imports,oilseeds_22_imports,Crude_rubber_23_imports,                      
                      Cork_24_imports,Pulp_25_imports,Textile_fibres_26_imports,Crude_fertilisers_27_imports,Metalliferous_ores_28_imports,Crude_animal_and_vegetable_materials_29_imports,
                      Coal_32_imports,Petroleum_33_imports,Gas_34_imports,Electric_current_35_imports,Animal_oils_and_fats_41_imports,Fixed_vegetable_oils_and_fats_42_imports,
                      Animal_and_vegetable_oils_43_imports,Organic_chemicals_51_imports,Inorganic_chemicals_52_imports,Dyeing_tanning_53_imports,Medicinal_and_pharma_54_imports, 
                      Essential_oils_55_imports,Fertilisers_56_imports,Plastics_57_imports,Plastics_non_primary_58_imports,Chemical_materials_59_imports,Leather_61_imports,Rubber_manufactures_62_imports,
                      Cork_and_wood_manufactures_63_imports,Paper_paperboard_64_imports,Textile_yarn_65_imports,Non_metallic_mineral_66_imports,
                      Iron_and_steel_67_imports,Non_ferrous_metals_68_imports,Manufactures_of_metal_69_imports,Power_generating_machinery_71_imports,Machinery_specialised_for_particular_industries_72_imports,
                      Metalworking_machinery_73_imports,General_industrial_machinery_74_imports,Office_machines_and_automatic_data_processing_equipment_75_imports,Telecommunications_and_sound_recording_76_imports,
                      Electrical_machinery_77_imports,Road_vehicles_78_imports,Other_transport_equipment_79_imports,Prefab_buildings_plumbing_and_electrical_81_imports,
                      Furniture_and_parts_thereof_82_imports,Travel_goods_handbags_and_similar_containers_83_imports,Articles_of_apparel_84_imports,Footwear_85_imports,
                      Professional_scientific_and_controlling_apparatus_87_imports,Photographic_apparatus_88_imports,Miscellaneous_manufactured_articles_89_imports,Commodities_and_transactions_9_imports,Unclassified_estimates_imports)
                      
                      
TOTAL_sum_import_product<-data.frame(NA, nrow=length(index(Import_Product["2015/"])))

for (i in 1:length(index(Import_Product["2015/"]))) {
  TOTAL_sum_import_product[i]<-sum(as.numeric(Import_Product[i]),na.rm = TRUE)
}


TOTAL_sum_import_product<-as.xts(t(TOTAL_sum_import_product), order.by = Date)
colnames(TOTAL_sum_import_product)<-c("TOTAL")






Food_and_live_animals_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))

for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  Food_and_live_animals_IMPORTS[i]<-sum(Import_Product$Live_animals_00[i],Import_Product$meat_01[i],Import_Product$Dairy_02[i],Import_Product$Fish_03[i],Import_Product$Cereal_04[i],Import_Product$Veg_05[i],Import_Product$Sugar_06[i],Import_Product$Coffee_07[i],
                                Import_Product$animal_feed_08[i],Import_Product$Miscellaneous_09[i])
}

Food_and_live_animals_IMPORTS<-as.xts(t(Food_and_live_animals_IMPORTS), order.by = Date)
colnames(Food_and_live_animals_IMPORTS)<-c("Food_and_live_animals")




Beverages_and_tobacco_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Beverages_11["2015/"])))
for (i in 1:length(index(Import_Product$Beverages_11["2015/"]))) {
  Beverages_and_tobacco_IMPORTS[i]<-sum(Import_Product$Beverages_11[i],Import_Product$Tobacco_12[i])
}

Beverages_and_tobacco_IMPORTS<-as.xts(t(Beverages_and_tobacco_IMPORTS), order.by = Date)
colnames(Beverages_and_tobacco_IMPORTS)<-c("Beverages_and_tobacco")





Crude_materials_inedible_except_fuels_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  Crude_materials_inedible_except_fuels_IMPORTS[i]<-sum(Import_Product$Hides_21[i],Import_Product$oilseeds_22[i],Import_Product$Crude_rubber_23[i],Import_Product$Cork_24[i],Import_Product$Pulp_25[i],Import_Product$Textile_fibres_26[i],Import_Product$Crude_fertilisers_27[i],Import_Product$Metalliferous_ores_28[i],Import_Product$Crude_animal_and_vegetable_materials_29[i])
}



          
Crude_materials_inedible_except_fuels_IMPORTS<-as.xts(t(Crude_materials_inedible_except_fuels_IMPORTS), order.by = Date)
colnames(Crude_materials_inedible_except_fuels_IMPORTS)<-c("Crude_materials_inedible_except_fuels")




Mineral_fuels_lubricants_and_related_materials_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))	
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  Mineral_fuels_lubricants_and_related_materials_IMPORTS[i]<-sum(Import_Product$Coal_32_exports[i],Import_Product$Petroleum_33[i],Import_Product$Gas_34[i],Import_Product$Electric_current_35[i])
                                                         }

Mineral_fuels_lubricants_and_related_materials_IMPORTS<-as.xts(t(Mineral_fuels_lubricants_and_related_materials_IMPORTS), order.by = Date)
colnames(Mineral_fuels_lubricants_and_related_materials_IMPORTS)<-c("Mineral_fuels_lubricants_and_related_materials")








Animal_and_vegetable_oils_fats_and_waxes_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  Animal_and_vegetable_oils_fats_and_waxes_IMPORTS[i]<-sum(Import_Product$Animal_oils_and_fats_41[i],Import_Product$Fixed_vegetable_oils_and_fats_42[i],Import_Product$Animal_and_vegetable_oils_43_exports[i])
}

Animal_and_vegetable_oils_fats_and_waxes_IMPORTS<-as.xts(t(Animal_and_vegetable_oils_fats_and_waxes_IMPORTS), order.by = Date)
colnames(Animal_and_vegetable_oils_fats_and_waxes_IMPORTS)<-c("Animal_and_vegetable_oils_fats_and_waxes")


Chemicals_and_related_products_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  Chemicals_and_related_products_IMPORTS[i]<-sum(Import_Product$Organic_chemicals_51[i],Import_Product$Inorganic_chemicals_52[i],Import_Product$Dyeing_tanning_53[i],Import_Product$Medicinal_and_pharma_54[i],Import_Product$Essential_oils_55[i],Import_Product$Fertilisers_56[i],Import_Product$Plastics_57[i],Import_Product$Plastics_non_primary_58[i],Import_Product$Chemical_materials_59[i])
}


Chemicals_and_related_products_IMPORTS<-as.xts(t(Chemicals_and_related_products_IMPORTS), order.by = Date)
colnames(Chemicals_and_related_products_IMPORTS)<-c("Chemicals_and_related_products")


Manufactured_goods_classified_chiefly_by_material_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  Manufactured_goods_classified_chiefly_by_material_IMPORTS[i]<-sum(Import_Product$Leather_61[i],Import_Product$Rubber_manufactures_62[i],Import_Product$Cork_and_wood_manufactures_63[i],Import_Product$Paper_paperboard_64[i],Import_Product$Textile_yarn_65[i],Import_Product$Non_metallic_mineral_66[i],Import_Product$Iron_and_steel_67[i],Import_Product$Non_ferrous_metals_68[i],Import_Product$Manufactures_of_metal_69[i])
}

Manufactured_goods_classified_chiefly_by_material_IMPORTS<-as.xts(t(Manufactured_goods_classified_chiefly_by_material_IMPORTS), order.by = Date)
colnames(Manufactured_goods_classified_chiefly_by_material_IMPORTS)<-c("Manufactured_goods_classified_chiefly_by_material")


Machinery_and_transport_equipment_IMPORT<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  Machinery_and_transport_equipment_IMPORT[i]<-sum(Import_Product$Power_generating_machinery_71[i],Import_Product$Machinery_specialised_for_particular_industries_72[i],Import_Product$Metalworking_machinery_73[i],Import_Product$General_industrial_machinery_74[i],Import_Product$Office_machines_and_automatic_data_processing_equipment_75[i],Import_Product$Telecommunications_and_sound_recording_76[i],Import_Product$Electrical_machinery_77[i],Import_Product$Road_vehicles_78[i],Import_Product$Other_transport_equipment_79[i])
}

Machinery_and_transport_equipment_IMPORT<-as.xts(t(Machinery_and_transport_equipment_IMPORT), order.by = Date)
colnames(Machinery_and_transport_equipment_IMPORT)<-c("Machinery_and_transport_equipment")






Miscellaneous_manufactured_articles_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  Miscellaneous_manufactured_articles_IMPORTS[i]<-sum(Import_Product$Prefab_buildings_plumbing_and_electrical_81[i],Import_Product$Furniture_and_parts_thereof_82[i],Import_Product$Travel_goods_handbags_and_similar_containers_83[i],Import_Product$Articles_of_apparel_84[i],Import_Product$Footwear_85[i],Import_Product$Professional_scientific_and_controlling_apparatus_87[i],Import_Product$Photographic_apparatus_88[i],Import_Product$Miscellaneous_manufactured_articles_89[i])
}

Miscellaneous_manufactured_articles_IMPORTS<-as.xts(t(Miscellaneous_manufactured_articles_IMPORTS), order.by = Date)
colnames(Miscellaneous_manufactured_articles_IMPORTS)<-c("Miscellaneous_manufactured_articles")






Other_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  Other_IMPORTS[i]<-sum(Import_Product$Commodities_and_transactions_9[i],Import_Product$Unclassified_estimates[i])
}

Other_IMPORTS<-as.xts(t(Other_IMPORTS), order.by = Date)
colnames(Other_IMPORTS)<-c("Other")



TOTAL_PRODUCT_AGG_IMPORTS<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
TOTAL_PRODUCT_AGG_IMPORTS[i]<-sum(Food_and_live_animals_IMPORTS[i],Beverages_and_tobacco_IMPORTS[i],Crude_materials_inedible_except_fuels_IMPORTS[i],Mineral_fuels_lubricants_and_related_materials_IMPORTS[i],Animal_and_vegetable_oils_fats_and_waxes_IMPORTS[i],Chemicals_and_related_products_IMPORTS[i],Manufactured_goods_classified_chiefly_by_material_IMPORTS[i],Machinery_and_transport_equipment_IMPORT[i],Miscellaneous_manufactured_articles_IMPORTS[i],Other_IMPORTS[i])
}


TOTAL_PRODUCT_AGG_IMPORTS<-as.xts(t(TOTAL_PRODUCT_AGG_IMPORTS), order.by = Date)
colnames(TOTAL_PRODUCT_AGG_IMPORTS)<-c("TOTAL_PRODUCT_AGG")



#headline adjusted idicators

Headline_Imports<-TOTAL_PRODUCT_AGG_IMPORTS$TOTAL_PRODUCT_AGG$TOTAL_PRODUCT_AGG
Headline_Imports_growth<-growth(Headline_Imports$TOTAL_PRODUCT_AGG,12)
colnames(Headline_Imports_growth)<-c("Imports")


Imports_excl_Mineral_fuels<-TOTAL_PRODUCT_AGG_IMPORTS$TOTAL_PRODUCT_AGG-Mineral_fuels_lubricants_and_related_materials_IMPORTS$Mineral_fuels_lubricants_and_related_materials
colnames(Imports_excl_Mineral_fuels)<-c("Imports_excl_Energy")
Imports_excl_Mineral_fuels_growth<-growth(Imports_excl_Mineral_fuels,12)


Imports_excl_aircraft<-TOTAL_PRODUCT_AGG_IMPORTS$TOTAL_PRODUCT_AGG-Import_Product$Other_transport_equipment_79
colnames(Imports_excl_aircraft)<-c("Imports_excl_Aircraft")
Imports_excl_aircraft_growth<-growth(Imports_excl_aircraft,12)




headline_indicator<-merge(Headline_Imports_growth["2023/"],Imports_excl_Mineral_fuels_growth["2023/"],Imports_excl_aircraft_growth["2023/"])

headline_indicator<-merge(headline_indicator,index(headline_indicator))

text_headline_excl_energy<-conditional(round(headline_indicator$Imports_excl_Energy[length(headline_indicator$Imports_excl_Energy)],1))


text_headline_excl_aircraft<-conditional(round(headline_indicator$Imports_excl_Aircraft[length(headline_indicator$Imports_excl_Aircraft)],1))





Imports_graph<-ggplot(data=headline_indicator,aes(x=index(headline_indicator)))+
      geom_line(aes(y=Imports, color="Imports"),size=1)+
      geom_line(aes(y=Imports_excl_Energy, color="Imports Excl. Energy"),size=1)+
      geom_line(aes(y=Imports_excl_Aircraft, color="Imports Excl. Aircraft"),size=1)+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+
  theme(legend.position.inside="none",plot.caption = element_text(hjust=0))+
  labs(x="",
       title="Decomposition of Goods Import Trends",
       caption="Date Source: CSO monthly external trade data",
       y="annual percentage change (%)")+
    scale_color_manual(name = "", values = c("Imports" = DOF_colours[1],"Imports Excl. Energy" = DOF_colours[2],"Imports Excl. Aircraft" = DOF_colours[3]))+
  theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))

Imports_graph<-Imports_graph+ theme(legend.position.inside=c(0.5, 0.2))



#Energy products trend
Energy_Import<-Mineral_fuels_lubricants_and_related_materials_IMPORTS$Mineral_fuels_lubricants_and_related_materials

Energy_Import_Share<-Energy_Import/TOTAL_PRODUCT_AGG_IMPORTS$TOTAL_PRODUCT_AGG



Energy_Import_Growth<-growth(Energy_Import,12)
text_annual_import_energy_growth<-conditional(Energy_Import_Growth$Mineral_fuels_lubricants_and_related_materials[length(Energy_Import_Growth$Mineral_fuels_lubricants_and_related_materials)])



Energy_Contribution_annual_growth_product<-round(Energy_Import_Growth["2016/"]*(lag.xts(Energy_Import_Share["2015/"],k=12)),2)


#aircraft imports
Aircraft_Import<-Other_transport_equipment_79_imports

Aircraft_Import_Share<-Other_transport_equipment_79_imports/TOTAL_PRODUCT_AGG_IMPORTS$TOTAL_PRODUCT_AGG




Aircraft_Import_Growth<-growth(Aircraft_Import,12)
text_annual_import_Aircraft_growth<-conditional(Aircraft_Import_Growth$Other_transport_equipment_79[length(Aircraft_Import_Growth$Other_transport_equipment_79)])



Aircraft_Contribution_annual_growth_product<-round(Aircraft_Import_Growth["2016/"]*(lag.xts(Aircraft_Import_Share["2015/"],k=12)),2)






text_annual_contribution_import_USA_TOTAL<-paste0(round(100*Energy_Contribution_annual_growth_product$Mineral_fuels_lubricants_and_related_materials[length(Contribution_annual_growth_Import$USA)]/(Contribution_annual_growth_Import$TOTAL[length(Contribution_annual_growth_Import$TOTAL)]),1),sep="%")





#Core M&E defined as M&E less other transport equip, to avoid aircraft Imports. 
CORE_M_E_Imports<-data.frame(NA, nrow=length(index(Import_Product$Live_animals_00["2015/"])))
for (i in 1:length(index(Import_Product$Live_animals_00["2015/"]))) {
  CORE_M_E_Imports[i]<-(Machinery_and_transport_equipment_IMPORT[i]-Import_Product$Other_transport_equipment_79[i])
}

CORE_M_E_Imports<-as.xts(t(CORE_M_E_Imports), order.by = Date)
colnames(CORE_M_E_Imports)<-c("CORE_M_E")



#semi conductors
semi_conductors<-Export_Product$Electrical_machinery_77
100*semi_conductors/CORE_M_E

OTHER_CORE_M_E<-CORE_M_E-semi_conductors

#FOOD & Beverage 
FOOD_and_Beverage<-(Food_and_live_animals+Beverages_and_tobacco)
100*FOOD_and_Beverage/TOTAL_sum_export$TOTAL

annual_growth_FB<-growth(FOOD_and_Beverage,12)
monthly_growth_FB<-growth(FOOD_and_Beverage,1)

text_monthly_growth_FB<-conditional(monthly_growth_FB[length(monthly_growth_FB)])
text_annual_growth_FB<-conditional(annual_growth_FB[length(annual_growth_FB)])

YTD_Food_Beverage<- 100*(sum(FOOD_and_Beverage["2024"])-sum(FOOD_and_Beverage["2023/"][1:length(FOOD_and_Beverage["2024/"])]))/sum(FOOD_and_Beverage["2023/"][1:length(FOOD_and_Beverage["2024/"])])
YTD_Food_Beverage_text<-conditional(YTD_Food_Beverage)

length_current_year<-length(FOOD_and_Beverage["2024/"])



#Pharma
Pharma_Share<-paste0(round(100*Chemicals_and_related_products/TOTAL_sum_export$TOTAL,1),sep="%")



annual_growth_Pharma<-growth(Chemicals_and_related_products,12)
monthly_growth_Pharma<-growth(Chemicals_and_related_products,1)

annual_growth_Pharma_text<-conditional(annual_growth_Pharma$Chemicals_and_related_products[length(annual_growth_Pharma)])
monthly_growth_Pharma_text<-conditional(monthly_growth_Pharma$Chemicals_and_related_products[length(monthly_growth_Pharma)])


YTD_Pharma<- 100*(sum(Chemicals_and_related_products["2024"])-sum(Chemicals_and_related_products["2023/"][1:length(Chemicals_and_related_products["2023/"])]))/sum(Chemicals_and_related_products["2023/"][1:length(Chemicals_and_related_products["2024/"])])
YTD_Pharma_text<-conditional(YTD_Pharma)



Pharma_Share_2020<- sum(Chemicals_and_related_products["2023"][1:length(Total_Export_Country$TOTAL["2024"])])/(sum(Total_Export_Country$TOTAL["2023"][1:length(Total_Export_Country$TOTAL["2024"])]))

YTD_Contribution_Pharma_Growth<-YTD_Pharma*Pharma_Share_2020
                                                              
Pharma_Contribution_Overall_YTD<-conditional_alt5(YTD_Contribution_Pharma_Growth)







Miscellaneous_Medical_Devices<-Export_Product$Miscellaneous_manufactured_articles_89

OTHER_PRODUCT<-(TOTAL_sum_export$TOTAL-(FOOD_and_Beverage+semi_conductors+Chemicals_and_related_products+OTHER_CORE_M_E+Miscellaneous_Medical_Devices))

PRODUCT_AGG<-merge(FOOD_and_Beverage,semi_conductors,Chemicals_and_related_products,OTHER_CORE_M_E,Miscellaneous_Medical_Devices,OTHER_PRODUCT)
colnames(PRODUCT_AGG)<-c("Food & Beverage","semi Conductors","Pharma","Other Core M&E","Miscellaneous Medical Devices","Other")


PRODUCT_AGG_SHARE<-merge((PRODUCT_AGG$`Food & Beverage`/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$`semi Conductors`/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$Pharma/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$`Other Core M&E`/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$`Miscellaneous Medical Devices`/TOTAL_sum_export$TOTAL),(PRODUCT_AGG$Other/TOTAL_sum_export$TOTAL))
colnames(PRODUCT_AGG_SHARE)<-c("Food & Beverage","semi Conductors","Pharma","Other Core M&E","Miscellaneous Medical Devices","Other")

  
annual_growth_Products<-growth(PRODUCT_AGG,freq=12)
month_growth_Products<-growth(PRODUCT_AGG,1)


Contribution_annual_growth_product<-round(annual_growth_Products["2016/"]*(lag.xts(PRODUCT_AGG_SHARE["2015/"],k=12)),2)
colnames(Contribution_annual_growth_product)<-c("Food & Beverage","semi Conductors","Pharma","Other Core M&E","Miscellaneous Medical Devices","Other")




#create summary graph of products below
summary_contribution_Product<-data.frame(merge(Contribution_annual_growth_product$`Food & Beverage`["2023/"],Contribution_annual_growth_product$`semi Conductors`["2023/"],Contribution_annual_growth_product$Pharma["2023/"],Contribution_annual_growth_product$`Other Core M&E`["2023/"],Contribution_annual_growth_product$`Miscellaneous Medical Devices`["2023/"],Contribution_annual_growth_product$Other["2023/"]),index(Contribution_annual_growth_product["2023/"]))
colnames(summary_contribution_Product)<-c("Food & Beverage","Semi Conductors","Pharma","Other Core M&E","Miscellaneous Medical Devices","Other","Date")
summary_contribution_melt_Product<-melt(summary_contribution_Product,id=c("Date"))


product_contribution<-ggplot(data=summary_contribution_melt_Product, aes(y=value, x=Date, fill=variable)) + 
  geom_bar(position="stack", stat="identity")+theme(legend.position.inside='bottom',plot.caption = element_text(hjust=0))+
  labs(x="",
       title="Ireland Export Contribution to Growth",
       caption="Date Source: CSO monthly external trade data from 2020",
       y="Percentage Share (%)")+
  scale_fill_manual(name = "", values  = c("Food & Beverage" = DOF_colours[3],"Semi Conductors" = DOF_colours[2],"Pharma" = DOF_colours[1],"Other Core M&E"=DOF_colours[4],"Miscellaneous Medical Devices"=DOF_colours[5],"Other"=DOF_colours[6]))+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))







```

<span class="text-center" style="color:#A3915E">

<center><font size="4"> **Goods Imports -Detailed Breakdown** </font></center>

</span>

```{r import plot, echo=FALSE}

Imports_graph

```

#### **Goods Import Trends**

-   Energy imports `r text_annual_import_energy_growth` on an annual basis in `r current_date` and contributed `r round(Energy_Contribution_annual_growth_product[length(Energy_Contribution_annual_growth_product)],1)` percentage points to overall import growth.Excluding energy, imports `r  text_headline_excl_energy` on an annual basis. <br> <br>
-   Aircraft imports `r text_annual_import_Aircraft_growth` on an annual basis in `r current_date` and contributed `r round(Aircraft_Contribution_annual_growth_product[length(Aircraft_Contribution_annual_growth_product)],1)` percentage points to overall import growth.Excluding aircrafts, imports `r  text_headline_excl_aircraft` on an annual basis. <br> <br>

------------------------------------------------------------------------

```{r Imports Plot, echo=FALSE}
destination_plot_imports+theme(legend.position.inside =c(0.2,0.8))
```

#### **Country Level Breakdown**

-   Imports from the USA, `r text_annual_import_USA` on an annual basis and contributed `r round(Contribution_annual_growth_Import$USA[length(Contribution_annual_growth_Import$USA)],1)` percentage points (representing `r text_annual_contribution_import_USA_TOTAL` of the total) in `r current_date`. <br> <br>
-   Imports from Great Britian, `r text_annual_import_GB` on an annual basis and contributed `r round(Contribution_annual_growth_Import$GB[length(Contribution_annual_growth_Import$GB)],1)` percentage points (representing `r text_annual_contribution_import_GB_TOTAL` of the total) in `r current_date`. <br> <br>
-   Imports from Northern Ireland, `r text_annual_import_NI` on an annual basis and contributed `r round(Contribution_annual_growth_Import$NI[length(Contribution_annual_growth_Import$NI)],1)` percentage points (representing `r text_annual_contribution_import_NI_TOTAL` of the total) in `r current_date`. <br> <br>
-   Imports from Germany, `r text_annual_import_Germany` on an annual basis and contributed `r round(Contribution_annual_growth_Import$Germany[length(Contribution_annual_growth_Import$Germany)],1)` percentage points (representing `r text_annual_contribution_import_Germany_TOTAL` of the total) in `r current_date`. <br> <br>
-   Imports from Switzerland, `r text_annual_import_Switzerland` on an annual basis and contributed `r round(Contribution_annual_growth_Import$Switzerland[length(Contribution_annual_growth_Import$Switzerland)],1)` percentage points (representing `r text_annual_contribution_import_Switzerland_TOTAL` of the total) in `r current_date`. <br> <br>
-   Outside of our main trading partners,imports `r text_annual_import_Other` on an annual basis and contributed `r round(Other_contribution_import$TOTAL[length(Other_contribution_import$TOTAL)],1)` percentage points (representing `r text_annual_contribution_import_Other_TOTAL` of the total) in `r current_date`.

```{r excel export, echo=FALSE}

Contribution_annual_growth_DF<-data.frame(index(Contribution_annual_growth),Contribution_annual_growth)
colnames(Contribution_annual_growth_DF)<-c("Date",colnames(Contribution_annual_growth))

Contribution_annual__IMPORT_growth_DF<-data.frame(index(Contribution_annual_growth_Import),Contribution_annual_growth_Import)
colnames(Contribution_annual__IMPORT_growth_DF)<-colnames(Contribution_annual_growth_DF)

Contribution_Prod_CON_DF<-data.frame(index(prod_con_excel),prod_con_excel)
colnames(Contribution_Prod_CON_DF)<-c("Date",colnames(Contribution_Prod_CON_DF[2:length(Contribution_Prod_CON_DF)]))




dataset_names <- list('Annual Export -Countries'=Contribution_annual_growth_DF,' Annual Export -Product' =Contribution_Prod_CON_DF,'Annual Import -Countries'=Contribution_annual__IMPORT_growth_DF)

write.xlsx(dataset_names, file = 'external_trade_excel2.xlsx')





```

```{r net import semiconductors, warning=FALSE, include=FALSE}



Ireland_72821 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.72821.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")

Ireland_72821_EXPORT<-t(data.frame(Ireland_72821[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_72821[1,])))) 

Ireland_72821_IMPORT<-t(data.frame(Ireland_72821[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_72821[2,])))) 

Ireland_72821_NET_TRADE<-Ireland_72821_EXPORT-Ireland_72821_IMPORT



Ireland_72822 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.72822.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")

Ireland_72822_EXPORT<-t(data.frame(Ireland_72822[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_72822[1,])))) 

Ireland_72822_IMPORT<-t(data.frame(Ireland_72822[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_72822[2,])))) 

Ireland_72822_NET_TRADE<-Ireland_72822_EXPORT-Ireland_72822_IMPORT


#72829

Ireland_72829 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.72829.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")

Ireland_72829_EXPORT<-t(data.frame(Ireland_72829[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_72829[1,])))) 

Ireland_72829_IMPORT<-t(data.frame(Ireland_72829[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_72829[2,])))) 

Ireland_72829_NET_TRADE<-Ireland_72829_EXPORT-Ireland_72829_IMPORT


#Commercial Vehicles 
#782
Ireland_782 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.782.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_782_EXPORT<-t(data.frame(Ireland_782[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_782[1,])))) 

Ireland_782_IMPORT<-t(data.frame(Ireland_782[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_782[2,])))) 

Ireland_782_NET_TRADE<-Ireland_782_EXPORT-Ireland_782_IMPORT

#Road Vehicles NES
Ireland_783 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.783.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_783_EXPORT<-t(data.frame(Ireland_783[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_783[1,])))) 

Ireland_783_IMPORT<-t(data.frame(Ireland_783[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_783[2,])))) 

Ireland_783_NET_TRADE<-Ireland_783_EXPORT-Ireland_783_IMPORT


#Railway Vehicles NES
#791
Ireland_791 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.791.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_791_EXPORT<-t(data.frame(Ireland_791[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_791[1,])))) 

Ireland_791_IMPORT<-t(data.frame(Ireland_791[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_791[2,])))) 

Ireland_791_NET_TRADE<-Ireland_791_EXPORT-Ireland_791_IMPORT



#SHIPS/BOATS
Ireland_793 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.793.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_793_EXPORT<-t(data.frame(Ireland_793[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_793[1,])))) 

Ireland_793_IMPORT<-t(data.frame(Ireland_793[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_793[2,])))) 

Ireland_793_NET_TRADE<-Ireland_793_EXPORT-Ireland_793_IMPORT




#TELECOMS, Sound Recording 
Ireland_76 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.76.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_76_EXPORT<-t(data.frame(Ireland_76[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_76[1,])))) 

Ireland_76_IMPORT<-t(data.frame(Ireland_76[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_76[2,])))) 

Ireland_76_NET_TRADE<-Ireland_76_EXPORT-Ireland_76_IMPORT


#LAPTOP 
#7522
Ireland_7522 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.7522.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_7522_EXPORT<-t(data.frame(Ireland_7522[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_7522[1,])))) 

Ireland_7522_IMPORT<-t(data.frame(Ireland_7522[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_7522[2,])))) 

Ireland_7522_NET_TRADE<-Ireland_7522_EXPORT-Ireland_7522_IMPORT






#AGRI Machinery 
Ireland_721 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.721.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_721_EXPORT<-t(data.frame(Ireland_721[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_721[1,])))) 

Ireland_721_IMPORT<-t(data.frame(Ireland_721[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_721[2,])))) 

Ireland_721_NET_TRADE<-Ireland_721_EXPORT-Ireland_721_IMPORT





#TRACTORS 
Ireland_722 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.722.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_722_EXPORT<-t(data.frame(Ireland_722[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_722[1,])))) 

Ireland_722_IMPORT<-t(data.frame(Ireland_722[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_722[2,])))) 

Ireland_722_NET_TRADE<-Ireland_722_EXPORT-Ireland_722_IMPORT



#FOOD PROCESSING MACHINES 
Ireland_727 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.727.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_727_EXPORT<-t(data.frame(Ireland_727[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_727[1,])))) 

Ireland_727_IMPORT<-t(data.frame(Ireland_727[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_727[2,])))) 

Ireland_727_NET_TRADE<-Ireland_727_EXPORT-Ireland_727_IMPORT



#METALWORKING MACHINERY 
Ireland_73 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.73.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_73_EXPORT<-t(data.frame(Ireland_73[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_73[1,])))) 

Ireland_73_IMPORT<-t(data.frame(Ireland_73[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_73[2,])))) 

Ireland_73_NET_TRADE<-Ireland_73_EXPORT-Ireland_73_IMPORT



#POWER GENERATING M&E 
Ireland_71 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.71.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_71_EXPORT<-t(data.frame(Ireland_71[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_71[1,])))) 

Ireland_71_IMPORT<-t(data.frame(Ireland_71[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_71[2,])))) 

Ireland_71_NET_TRADE<-Ireland_71_EXPORT-Ireland_71_IMPORT


#TURBOJET  ETC
#7144
Ireland_7144 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.7144.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_7144_EXPORT<-t(data.frame(Ireland_7144[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_7144[1,])))) 

Ireland_7144_IMPORT<-t(data.frame(Ireland_7144[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_7144[2,])))) 

Ireland_7144_NET_TRADE<-Ireland_7144_EXPORT-Ireland_7144_IMPORT


#PARTS OF ENGINES  
#7149
Ireland_7149 <-read_table2("https://ec.europa.eu/eurostat/api/comext/dissemination/sdmx/2.1/data/ds-059331/M.IE.WORLD.7149.1+2.VALUE_EUR?format=TSV&startPeriod=2002-01&endPeriod=2024-12")


Ireland_7149_EXPORT<-t(data.frame(Ireland_7149[2,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_7149[1,])))) 

Ireland_7149_IMPORT<-t(data.frame(Ireland_7149[1,])) %>% as.numeric() %>% as.xts(order.by=as.Date(seq(as.Date("2001-12-01"), by="month",length.out=length(Ireland_7149[2,])))) 

Ireland_7149_NET_TRADE<-Ireland_7149_EXPORT-Ireland_7149_IMPORT



####AGGREGATES 
Ireland_COMMERCIAL_V_NET_TRADE<-Ireland_782_NET_TRADE+Ireland_783_NET_TRADE+Ireland_791_NET_TRADE+Ireland_793_NET_TRADE
Ireland_PHONES_MONITORS_NET_TRADE<-Ireland_76_NET_TRADE+Ireland_7522_NET_TRADE
Ireland_AGRI_MACHINES<-Ireland_721_NET_TRADE+Ireland_722_NET_TRADE
Ireland_OTHER_MACHINES<-Ireland_727_NET_TRADE+Ireland_73_NET_TRADE+Ireland_71_NET_TRADE-(Ireland_7144_NET_TRADE+Ireland_7149_NET_TRADE)

DOMESTIC_ME_IMPORTS<-data.frame(index(Ireland_COMMERCIAL_V_NET_TRADE),(data.frame(Ireland_COMMERCIAL_V_NET_TRADE,Ireland_PHONES_MONITORS_NET_TRADE,Ireland_AGRI_MACHINES,Ireland_OTHER_MACHINES)*-1)/1000000)
colnames(DOMESTIC_ME_IMPORTS)<-c("Date","Commercial vehicles", "Phones, monitors, laptops", "Agricultural machines", "Other machines")

DOMESTIC_ME_IMPORTS_SHORT<-DOMESTIC_ME_IMPORTS[230:nrow((DOMESTIC_ME_IMPORTS)),]

######




SEMI_NET_IMPORTS<-data.frame((Ireland_72821_NET_TRADE+Ireland_72822_NET_TRADE+Ireland_72829_NET_TRADE)*-1,index(Ireland_72829_NET_TRADE))
colnames(SEMI_NET_IMPORTS)<-c("SEMI_NET_IMPORTS","Date")

SEMICON_NET_IMPORT_GRAPH<-ggplot(SEMI_NET_IMPORTS[230:nrow(SEMI_NET_IMPORTS),],aes(Date,SEMI_NET_IMPORTS/1000000)) + 
  geom_col(fill=DOF_colours[2],colour=DOF_colours[2])+theme(legend.position.inside='bottom',element_text(size=100))+
  labs(x="",
       title="Monthly net trade in machinery to develop semiconductors",
       caption="Date Source: Eurostat 
       Note: SITC categories 72821, 72822, 72829 are used define machinery used to develop semiconductors", 
       y="Millions")+
  scale_fill_manual(name = "")+
  scale_y_continuous(labels=function(x) paste0(x))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))


SEMI_TEXT_MONTH<-last(na.omit(SEMI_NET_IMPORTS)) %>% .$Date %>% format("%B %Y")
SEMI_TEXT_VALUE<-last(na.omit(SEMI_NET_IMPORTS)) %>% .$SEMI_NET_IMPORTS/1000000
SEMI_TEXT_VALUE<-round(SEMI_TEXT_VALUE,1)

SEMI_TEXT_GROWTH<- growth(na.omit(SEMI_NET_IMPORTS$SEMI_NET_IMPORTS),freq=12)  %>% last() %>% round(2)

SEMI_TEXT_GROWTH_PEAK<-((last(na.omit(SEMI_NET_IMPORTS$SEMI_NET_IMPORTS))-max(na.omit(SEMI_NET_IMPORTS$SEMI_NET_IMPORTS)))/1000000) %>% round(1)
                                       
SEMI_NET_IMPORTS<-data.frame(SEMI_NET_IMPORTS$Date,SEMI_NET_IMPORTS$SEMI_NET_IMPORTS,Ireland_72821_NET_TRADE,Ireland_72822_NET_TRADE,Ireland_72829_NET_TRADE)                                       
                                       

SEMI_NET_IMPORTS_XTS<-as.xts(SEMI_NET_IMPORTS)




YTD_SEMI_NET_IMPORTS<- 100*((sum(as.numeric(na.omit(SEMI_NET_IMPORTS_XTS$SEMI_NET_IMPORTS.SEMI_NET_IMPORTS["2024"])))-(sum(as.numeric(SEMI_NET_IMPORTS_XTS$SEMI_NET_IMPORTS.SEMI_NET_IMPORTS["2023"])[1:length(na.omit(SEMI_NET_IMPORTS_XTS$SEMI_NET_IMPORTS.SEMI_NET_IMPORTS["2024"]))])))/(sum(as.numeric(SEMI_NET_IMPORTS_XTS$SEMI_NET_IMPORTS.SEMI_NET_IMPORTS["2023"])[1:length(na.omit(SEMI_NET_IMPORTS_XTS$SEMI_NET_IMPORTS.SEMI_NET_IMPORTS["2024"]))]))) 
                            
                            
                            
                            
YTD_NET_SEMI_TEXT<-conditional(YTD_SEMI_NET_IMPORTS)                            





DOMESTIC_ME_IMPORTS_GRAPH<-ggplot(DOMESTIC_ME_IMPORTS[260:nrow(SEMI_NET_IMPORTS),],aes(Date,SEMI_NET_IMPORTS/1000000)) + 
  geom_col(fill=DOF_colours[2],colour=DOF_colours[2])+theme(legend.position.inside='bottom',element_text(size=100))+
  labs(x="",
       title="Monthly net trade in machinery to develop semiconductors",
       caption="Date Source: Eurostat 
       Note: SITC categories 72821, 72822, 72829 are used define machinery used to develop semiconductors", 
       y="Millions")+
  scale_fill_manual(name = "")+
  scale_y_continuous(labels=function(x) paste0(x))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))



DOMESTIC_ME_IMPORTS_SHORT<-melt(DOMESTIC_ME_IMPORTS_SHORT,id=c("Date"))


DOMESTIC_ME_IMPORTS_plot<-ggplot(data=DOMESTIC_ME_IMPORTS_SHORT, aes(y=value, x=Date, fill=variable)) + 
  geom_bar(position="stack", stat="identity")+theme(legend.position.inside='bottom',element_text(size=100))+
  labs(x="",
       title="Net imports domestic machinery & equipment",
       caption="Date Source: Eurostat",
       y="Millions")+
  scale_fill_manual(name = "", values  = c("Commercial vehicles" = DOF_colours[1],"Phones, monitors, laptops" = DOF_colours[2],"Agricultural machines" = DOF_colours[3],"Other machines"=DOF_colours[4]))+
  scale_y_continuous(labels=function(x) paste0("€",x))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))
  




DOMESTIC_ME_IMPORTS_SUM<-rowSums((na.omit(DOMESTIC_ME_IMPORTS[2:ncol(DOMESTIC_ME_IMPORTS)]))) %>% data.frame() %>% round(2)
DOMESTIC_ME_IMPORTS_GROWTH<-growth(DOMESTIC_ME_IMPORTS_SUM$.,freq=12)

TEXT_DOMESTIC_ME_IMPORTS<-conditional(DOMESTIC_ME_IMPORTS_GROWTH[length(DOMESTIC_ME_IMPORTS_GROWTH)])
DOMESTIC_ME_IMPORTS[length(DOMESTIC_ME_IMPORTS)]


DOMESTIC_ME_IMPORTS_SUM_XTS<-as.xts(DOMESTIC_ME_IMPORTS_SUM)

YTD_DOMESTIC_ME_NET_IMPORTS<- 100*((sum(as.numeric(na.omit(DOMESTIC_ME_IMPORTS_SUM_XTS$.["2024"])))-(sum(as.numeric(DOMESTIC_ME_IMPORTS_SUM_XTS$.["2023"])[1:length(na.omit(DOMESTIC_ME_IMPORTS_SUM_XTS$.["2024"]))])))/(sum(as.numeric(DOMESTIC_ME_IMPORTS_SUM_XTS$.["2023"])[1:length(na.omit(DOMESTIC_ME_IMPORTS_SUM_XTS$.["2024"]))]))) 
                            
                            
                            
                            
DOMESTIC_ME_NET_IMPORTS_YTD_TEXT<-conditional(YTD_DOMESTIC_ME_NET_IMPORTS)                            






```

------------------------------------------------------------------------

```{r echo=FALSE, warning=FALSE}


SEMICON_NET_IMPORT_GRAPH


```

#### **Semiconductor Imports**

-   The net import of machinery used to develop semiconductors `r conditional(SEMI_TEXT_GROWTH)` on an annual basis in `r SEMI_TEXT_MONTH`, with net imports of `r SEMI_TEXT_VALUE` million. <br> <br>
-   In year to date terms, the net import of machinery used to develop semiconductors `r YTD_NET_SEMI_TEXT`.\
    <br> <br>
-   Compared to the previous peak, the net import of machinery used to develop semiconductors has fallen by `r SEMI_TEXT_GROWTH_PEAK` million.

```{r echo=FALSE, warning=FALSE}


DOMESTIC_ME_IMPORTS_plot+ theme(legend.position.inside=c(0.2, 0.8))


```

#### **Domestic M&E Imports**

-   The net imports of domestic M&E provides an indication of domestic investment by looking at a select grouping of imports.\
    <br> <br>
-   In `r SEMI_TEXT_MONTH`, domestic net M&E imports `r TEXT_DOMESTIC_ME_IMPORTS` on an annual basis. In year to date terms, net imports have `r DOMESTIC_ME_NET_IMPORTS_YTD_TEXT` compared to the same period in 2022.

```{r include=FALSE}

Export_Product_GROWTH<-growth(Export_Product, 12) %>% round(2) 
Contribution_annual_growth_product

EXPORT_DATA_DOWNLOAD_ALL <- list('Annual Export Growth' =data.frame(index(annual_growth_exports),annual_growth_exports),'Contribution Annual  Export'=data.frame(index(Contribution_annual_growth),Contribution_annual_growth),'Product Growth' =data.frame(index(Export_Product_GROWTH),Export_Product_GROWTH),'Contribution Product Growth' =data.frame(index(Contribution_annual_growth_product),Contribution_annual_growth_product))


colnames(EXPORT_DATA_DOWNLOAD_ALL$`Contribution Annual  Export`)<-c("Date",names(Contribution_annual_growth))
colnames(EXPORT_DATA_DOWNLOAD_ALL$`Annual Export Growth`)<-c("Date",names(annual_growth_exports))
colnames(EXPORT_DATA_DOWNLOAD_ALL$`Product Growth`)<-c("Date","Live animals except fish etc.",
"Meat and meat preparations",
"Dairy products and birds eggs",
"Fish, crustaceans, molluscs",
"Cereals and cereal preparations",
"Vegetables and fruit	"
,"Sugar, sugar preparations and honey	"
,"Coffee, tea, cocoa, spices and manufactures thereof	"
,"Feeding stuffs for animals, excluding unmilled cereals	"
,"Miscellaneous edible products and preparations	"
,"Beverages	"
,"Tobacco and tobacco manufactures	"
,"Hides, skins and furskins, raw	"
,"Oilseeds and oleaginous fruit	"
,"Crude rubber, including synthetic and reclaimed rubber	"
,"Cork and wood	"
,"Pulp and waste paper	"
,"Textile fibres, excluding wool tops, and their wastes	"
,"Crude fertilisers and minerals, excluding coal, petroleum etc.	"
,"Metalliferous ores and metal scrap	"
,"Crude animal and vegetable materials, n.e.s. 	"
,"Coal, coke and briquettes	"
,"Petroleum, petroleum products and related materials	"
,"Gas, natural and manufactured	"
,"Electric current	"
,"Animal oils and fats	"
,"Fixed vegetable oils and fats	"
,"Animal and vegetable oils and fats, processed, and waxes	"
,"Organic chemicals	"
,"Inorganic chemicals	"
,"Dyeing, tanning and colouring materials	"
,"Medicinal and pharmaceutical products	"
,"Essential oils, perfume materials, toilet preparations etc.	"
,"Fertilisers, manufactured	"
,"Plastics in primary forms	"
,"Plastics in non-primary forms	"
,"Chemical materials and products, n.e.s.	"
,"Leather, leather manufactures and dressed furskins	"
,"Rubber manufactures, n.e.s.	"
,"Cork and wood manufactures, excluding furniture	"
,"Paper, paperboard and articles of paper pulp, paper etc.	"
,"Textile yarn, fabrics, made-up articles and related products	"
,"Non-metallic mineral manufactures, n.e.s.	"
,"Iron and steel	"
,"Non-ferrous metals	"
,"Manufactures of metal, n.e.s.	"
,"Power generating machinery and equipment	"
,"Machinery specialised for particular industries	"
,"Metalworking machinery	"
,"General industrial machinery and parts, n.e.s.	"
,"Office machines and automatic data processing equipment	"
,"Telecommunications and sound recording, reproducing equipment 	"
,"Electrical machinery, appliances etc., n.e.s.	"
,"Road vehicles	"
,"Other transport equipment	"
,"Prefab buildings; plumbing and electrical fixtures and fittings	"
,"Furniture and parts thereof	"
,"Travel goods, handbags and similar containers	"
,"Articles of apparel and clothing accessories	"
,"Footwear	"
,"Professional, scientific and controlling apparatus	"
,"Photographic apparatus, optical goods, watches and clocks	"
,"Miscellaneous manufactured articles, n.e.s.","Commodities_and_transactions_9","Unclassified_estimates")

colnames(EXPORT_DATA_DOWNLOAD_ALL$`Contribution Product Growth`)<-c("Date","Food and Beverage","Semi Conductors","Pharma","Other M&E","Miscellaneous Medical Devices","Other")














write.xlsx(EXPORT_DATA_DOWNLOAD_ALL, file = 'EXPORT_DATA_DOWNLOAD_ALL.xlsx')


```
<span class="text-center" style="color:#A3915E"> <center> <font size="4"> The answer to life the universe and everything...[Download Everything! ](https://github.com/mflanagan201/gcal_auto/raw/main/EXPORT_DATA_DOWNLOAD_ALL.xlsx) </font> </center>
