Set up

library(tidyverse) library(xts) library(openxlsx) library(rdbnomics) library(csodata) library(units) library(lubridate) library(magrittr) library(ggplot2) library(reshape2) library(formattable) library(knitr) library(kableExtra) library(eurostat) library(webshot) library(httr) library(rvest) library(readxl) library(htmlwidgets) library(tframePlus) library(zoo) library(emayili)

webshot::install_phantomjs()

Helper Functions

growth <- function(x, freq){ (x / lag.xts(x, k = freq) - 1) * 100 }

monthStart <- function(x) { x <- as.POSIXlt(x) x$mday <- 1 as.Date(x) }

CARRYOVER <- function(x){ CURRENTYEAR <- x[paste0("", index(last(x)) %>% year(), "")] LASTYEAR <- x[paste0("", index(last(x)) %>% year() - 1, "")] FY_CURRENTYEAR <- CURRENTYEAR * (1 + (length(LASTYEAR) - length(CURRENTYEAR))) FY_LASTYEAR <- sum(LASTYEAR) ((FY_CURRENTYEAR / FY_LASTYEAR) - 1) * 100 }

YTD <- function(x){ CURRENTYEAR_YTD <- x[paste0("", index(last(x)) %>% year(), "")] LASTYEAR <- x[paste0("", (index(CURRENTYEAR_YTD) - years(1)), "")] %>% data.frame() CURRENTYEAR_YTD <- CURRENTYEAR_YTD %>% data.frame() YTD_CURRENTYEAR <- CURRENTYEAR_YTD for(i in 1:nrow(CURRENTYEAR_YTD)){ YTD_CURRENTYEAR[i,] <- ((as.numeric(sum(as.numeric(CURRENTYEAR_YTD[1:i,]))) / as.numeric(sum(as.numeric(LASTYEAR[1:i,])))) - 1) * 100 } return(YTD_CURRENTYEAR) }

CSO Cache Clear

cso_clear_cache()

Example data block fix (apply similar logic to others)

QNA <- data.frame(subset(cso_get_data("NAQ04"), Statistic == "Expenditure on GNP at Constant Market Prices")) %>% select(-Statistic) if (nrow(QNA) > 1) { Date_95_QNA <- seq(as.Date("1995/01/01"), length.out = (nrow(QNA) - 1), by = "quarters") } else { stop("QNA data is empty or invalid") }

Consumption_Q <- data.frame(subset(QNA, Sector == "Personal Expenditure on Consumer Goods and Services")) %>% select(-Sector) %>% t() %>% as.xts(order.by = Date_95_QNA) colnames(Consumption_Q) <- c("Consumption")

Fix for CSO_HICP_INDEX date sequence

CSO_HICP_INDEX <- subset(cso_get_data("CPM15"), Statistic == "EU HICP") num_periods <- length(unique(colnames(CSO_HICP_INDEX))) - 2 if (num_periods > 0) { Date <- seq(as.Date("1996-01-01"), length.out = num_periods, by = "month") } else { stop("Invalid number of periods in HICP index") }

Add more blocks and guards here as needed...

