---
title: <span class="text-center" style="color:#A3915E"> <center> <font size="6">  **Inflation Chartpack**  </font> </center> </span>
output: 
  
  html_document: default
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    cache       = TRUE,     # if TRUE knitr will cache the results to reuse in future knits
    fig.width   = 10,       # the width for plots created by code chunk
    fig.height  = 5,       # the height for plots created by code chunk
    fig.align   = 'center', # how to align graphics in the final doc. 'left', 'right', 'center'
tidy.opts=list(width.cutoff=10))



#inflation weight
library('tidyverse')
library(reshape)
library('xts')
library('openxlsx')
library("dplyr")
library(xts)
library(rdbnomics)
library(csodata)
library(units)
library(lubridate)
library(readxl)
library(waterfalls)
library(stringr)




DOF_colours <- c("#01A685", "#A3915E", "#0190D4","#4473c4","#afb6bd","#dbac00")

growth <- function(x, freq){(x/lag.xts(x, k = freq)-1)*100}


Chainlinking <- function(x){
  as.numeric(x["2016/"][,1])/as.numeric(x[paste0(year(x["2016/"])-1, "-12-01")]) %>% as.xts(order.by=index(x["2016/"]))
}


RE_Chainlinking <- function(x){
  ((as.numeric(x[,1]))/100)*as.numeric(x[paste0(year(x)-1, "-12-01")]) 
}


cso_clear_cache()


#COMPONENTS BREAKDOWN OF INDEX 


#GOODS 

CP01111_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM16"),Statistic=="Consumer Price Index"),Detailed.Sub.Indices =="Rice"))) %>% as.numeric()  %>% na.omit() 
Date_index_Goods<-seq(as.Date("2003-01-01"), by="month",length.out=NROW(CP01111_INDEX))
CP01111_INDEX<-as.xts(CP01111_INDEX,order.by=Date_index_Goods)

CP0111_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Bread and cereals (COICOP 01.1.1)"))) %>% as.numeric()  %>% na.omit() 
Date_index_Goods<-seq(as.Date("1996-01-01"), by="month",length.out=NROW(CP0111_INDEX))
CP0111_INDEX<-as.xts(CP0111_INDEX,order.by=Date_index_Goods)


CP0112_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Meat (COICOP 01.1.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0113_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Fish and seafood (COICOP 01.1.3)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0114_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Milk, cheese and eggs (COICOP 01.1.4)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0115_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Oils and fats (COICOP 01.1.5)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0116_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Fruit (COICOP 01.1.6)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0117_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Vegetables (COICOP 01.1.7)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0118_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Sugar, jam, honey, chocolate and confectionery (COICOP 01.1.8)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0119_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Food products n.e.c. (COICOP 01.1.9)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0121_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Coffee, tea and cocoa (COICOP 01.2.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0122_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Mineral waters, soft drinks, fruit and vegetable juices (COICOP 01.2.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0211_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Spirits (COICOP 02.1.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0212_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Wine (COICOP 02.1.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0213_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Beer (COICOP 02.1.3)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0220_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Tobacco (COICOP 02.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0311_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Clothing materials (COICOP 03.1.1)"))) %>% as.numeric() 
CP0311_INDEX[is.na(CP0311_INDEX)]<-0 
CP0311_INDEX <- as.xts(CP0311_INDEX[3:length(CP0311_INDEX)],order.by=Date_index_Goods)

CP0312_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Garments (COICOP 03.1.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0313_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Other articles of clothing and clothing accessories (COICOP 03.1.3)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP032_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Footwear (COICOP 03.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0431_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Materials for the maintenance and repair of the dwelling (COICOP 04.3.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0441_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Water supply (COICOP 04.4.1)"))) %>% as.numeric()  
CP0441_INDEX[is.na(CP0441_INDEX)]<-0 
CP0441_INDEX <- as.xts(CP0441_INDEX[3:length(CP0441_INDEX)],order.by=Date_index_Goods)


CP0451_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Electricity (COICOP 04.5.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0452_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Gas (COICOP 04.5.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0453_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Liquid fuels (COICOP 04.5.3)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0454_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Solid fuels (COICOP 04.5.4)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0455_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Heat energy (COICOP 04.5.5)"))) %>% as.numeric()  
CP0455_INDEX[is.na(CP0455_INDEX)]<-0 
CP0455_INDEX <- as.xts(CP0455_INDEX[3:length(CP0455_INDEX)],order.by=Date_index_Goods)

CP0511_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Furniture and furnishings (COICOP 05.1.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0512_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Carpets and other floor coverings (COICOP 05.1.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0520_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Household textiles (COICOP 05.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0531_2_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Major household appliances whether electric or not and small electric household appliances (COICOP 05.3.1_2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0540_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Glassware, tableware and household utensils (COICOP 05.4)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP055_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Tools and equipment for house and garden (COICOP 05.5)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0561_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Non-durable household goods (COICOP 05.6.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0611_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Pharmaceutical products (COICOP 06.1.1)"))) %>% as.numeric()  %>% na.omit() 


Date_index_Goods_99<-seq(as.Date("1999-01-01"), by="month",length.out=NROW(CP0611_INDEX))
CP0611_INDEX<-as.xts(CP0611_INDEX,order.by=Date_index_Goods_99)

CP0612_3_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Other medical products, therapeutic appliances and equipment (COICOP 06.1.2_3)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods_99)
CP0711_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Motor cars (COICOP 07.1.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0712_3_4_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Motor cycles, bicycles and animal drawn vehicles (COICOP 07.1.2_3_4)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0721_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Spare parts and accessories for personal transport equipment (COICOP 07.2.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0722_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Fuels and lubricants for personal transport equipment (COICOP 07.2.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0911_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Equipment for the reception, recording and reproduction of sound and picture (COICOP 09.1.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0912_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Photographic and cinematographic equipment and optical instruments (COICOP 09.1.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0913_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Information processing equipment (COICOP 09.1.3)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0914_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Recording media (COICOP 09.1.4)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0921_2_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Major durables for indoor and outdoor recreation including musical instruments (COICOP 09.2.1_2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0931_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Games, toys and hobbies (COICOP 09.3.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0932_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Equipment for sport, camping and open-air recreation (COICOP 09.3.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0933_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Gardens, plants and flowers (COICOP 09.3.3)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0934_5_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Pets and related products; veterinary and other services for pets (COICOP 09.3.4_5)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0951_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Books (COICOP 09.5.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0952_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Newspapers and periodicals (COICOP 09.5.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP0953_4_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Miscellaneous printed matter; stationery and drawing materials (COICOP 09.5.3_4)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP1212_3_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Electrical appliances for personal care; other appliances, articles and products for personal care (COICOP 12.1.2_3)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP1231_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Jewellery, clocks and watches (COICOP 12.3.1)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)
CP1232_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Other personal effects (COICOP 12.3.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_Goods)

```


```{r include=FALSE}


#Services

CP0411_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Actual rentals for housing (COICOP 04.1)"))) %>% as.numeric()  %>% na.omit() 
Date_index<-seq(as.Date("1996-01-01"), by="month",length.out=NROW(CP0411_INDEX))
CP0411_INDEX<-as.xts(CP0411_INDEX,order.by=Date_index)
CP0432_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Services for the maintenance and repair of the dwelling (COICOP 04.3.2)"))) %>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP044_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Water supply and miscellaneous services relating to the dwelling (COICOP 04.4)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0533_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Repair of household appliances (COICOP 05.3.3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0562_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Domestic services and household services (COICOP 05.6.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP1252_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Insurance connected with the dwelling (COICOP 12.5.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0314_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Cleaning, repair and hire of clothing (COICOP 03.1.4)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0915_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Repair of audio-visual, photographic and information processing equipment (COICOP 09.1.5)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0941_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Recreational and sporting services (COICOP 09.4.1)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0942_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Cultural services (COICOP 09.4.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP1111_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Restaurants, cafes and the like (COICOP 11.1.1)")))%>% as.numeric()  %>% na.omit() %>% as.xts(order.by=Date_index)
CP1112_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Canteens (COICOP 11.1.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP1211_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Hairdressing salons and personal grooming establishments (COICOP 12.1.1)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0723_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Maintenance and repair of personal transport equipment (COICOP 07.2.3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0724_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Other services in respect of personal transport equipment (COICOP 07.2.4)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0731_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Passenger transport by railway (COICOP 07.3.1)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0732_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Passenger transport by road (COICOP 07.3.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0733_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Passenger transport by air (COICOP 07.3.3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0734_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Passenger transport by sea and inland waterway (COICOP 07.3.4)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0735_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Combined passenger transport (COICOP 07.3.5)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0736_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Other purchased transport services (COICOP 07.3.6)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP096_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Package holidays (COICOP 09.6)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP112_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Accommodation services (COICOP 11.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP0621_3_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Medical services and paramedical services (COICOP 06.2.1_3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index[37:length(Date_index)]) 
CP0622_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Dental services (COICOP 06.2.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index[37:length(Date_index)])
CP063_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Hospital services (COICOP 06.3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index[60:length(Date_index)])
CP10_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Education (COICOP 10)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP101_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Pre-primary and primary education")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP102_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Secondary education")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP104_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Tertiary education")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP105_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Education not definable by level")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP124_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Social protection (COICOP 12.4)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index[37:length(Date_index)])
CP1253_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Insurance connected with health (COICOP 12.5.3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index[37:length(Date_index)])
CP1254_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Insurance connected with transport (COICOP 12.5.4)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP126_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Financial services n.e.c. (COICOP 12.6)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP127_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Other services n.e.c. (COICOP 12.7)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP081_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Postal services (COICOP 08.1)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)
CP082_3_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Telephone and telefax equipment and services (COICOP 08.2_3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)

#Second data source for HICP specifically
CP0442_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Refuse collection (COICOP 04.4.2)")))%>% as.numeric()  %>% na.omit() 
Date_index_ALT<-seq(as.Date("1999-12-01"), by="month",length.out=NROW(CP0442_INDEX))

CP0442_INDEX<-CP0442_INDEX %>% as.xts(order.by=Date_index_ALT)

CP0443_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Sewerage collection (COICOP 04.4.3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT)
CP0444_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Other services relating to the dwelling n.e.c. (COICOP 04.4.4)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT)

#the repair furniture appears to be discontinued 

CP0112_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Meat (COICOP 01.1.2)")))%>% as.numeric()  %>% na.omit() 
Date_index_ALT2<-seq(as.Date("1996-01-01"), by="month",length.out=NROW(CP0112_INDEX))

CP0112_INDEX<-CP0112_INDEX %>% as.xts(order.by=Date_index_ALT2)

CP0113_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Fish and seafood (COICOP 01.1.3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0116_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Fruit (COICOP 01.1.6)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0117_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Vegetables (COICOP 01.1.7)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)


FLASH_OVERALL_HICP_INDEX<-rdb("Eurostat/prc_hicp_fp/M.I15.CP00.FLS.IE")%>% .$value %>% as.numeric()
FLASH_OVERALL_HICP_DATE<-rdb("Eurostat/prc_hicp_fp/M.I15.CP00.FLS.IE") %>% .$period %>% as.Date()
FLASH_OVERALL_XTS<-as.xts(FLASH_OVERALL_HICP_INDEX,order.by=FLASH_OVERALL_HICP_DATE)
GROWTH_FLASH_OVERALL_XTS<-growth(FLASH_OVERALL_XTS,12)





#CSO HICP INDEX for release 
CSO_HICP_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="All-items HICP (COICOP 00)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index)






OVERALL_HICP_INDEX<-rdb("Eurostat/prc_hicp_midx/M.I15.CP00.IE")%>% .$value %>% as.numeric()
OVERALL_HICP_DATE<-rdb("Eurostat/prc_hicp_midx/M.I15.CP00.IE") %>% .$period %>% as.Date()
OVERALL_HICP_XTS_ONE<-as.xts(OVERALL_HICP_INDEX,order.by=OVERALL_HICP_DATE)


if(length(CSO_HICP_INDEX)>=length(OVERALL_HICP_XTS_ONE)){
  OVERALL_HICP_XTS<-CSO_HICP_INDEX
} else {
  OVERALL_HICP_XTS<-OVERALL_HICP_XTS_ONE
}

GROWTH_OVERALL_XTS<-growth(OVERALL_HICP_XTS,12)



#CSO CORE HICP INDEX for release 
CSO_HICP_CORE_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="HICP All items excluding energy and unprocessed food"))) %>% as.numeric() 
Date_CORE_HICP<-seq(as.Date("1996-01-01"), length.out=length(CSO_HICP_CORE_INDEX[3:length(CSO_HICP_CORE_INDEX)]), by="month")


CSO_HICP_CORE_INDEX <- CSO_HICP_CORE_INDEX[3:length(CSO_HICP_CORE_INDEX)] %>% as.xts (order.by=Date_CORE_HICP)


CORE_HICP_INDEX<-rdb("Eurostat/prc_hicp_midx/M.I15.TOT_X_NRG_FOOD_NP.IE")%>% .$value %>% as.numeric()
CORE_HICP_DATE<-rdb("Eurostat/prc_hicp_midx/M.I15.TOT_X_NRG_FOOD_NP.IE") %>% .$period %>% as.Date()
CORE_HICP_XTS_ONE<-as.xts(CORE_HICP_INDEX,order.by=CORE_HICP_DATE)


if(length(CSO_HICP_CORE_INDEX)>=length(CORE_HICP_XTS_ONE)){
  CORE_HICP_XTS<-CSO_HICP_CORE_INDEX
} else {
  CORE_HICP_XTS<-CORE_HICP_XTS_ONE
}

GROWTH_CORE_XTS<-growth(CORE_HICP_XTS,12)



FOOD_NP_INDEX<-rdb("Eurostat/prc_hicp_midx/M.I15.FOOD_NP.IE") %>% .$value %>% as.numeric()
FOOD_NP_DATE<-rdb("Eurostat/prc_hicp_midx/M.I15.FOOD_NP.IE") %>% .$period %>% as.Date()

FOOD_NP_INDEX_XTS<-as.xts(FOOD_NP_INDEX,order.by=FOOD_NP_DATE)




SERVICES_INDEX<-rdb("Eurostat/prc_hicp_midx/M.I15.SERV.IE") %>% .$value %>% as.numeric()
SERVICES_DATE<-rdb("Eurostat/prc_hicp_midx/M.I15.SERV.IE") %>% .$period %>% as.Date()

SERVICES_INDEX_XTS<-as.xts(SERVICES_INDEX,order.by=SERVICES_DATE)


Core_SERVICES_INDEX_DEC_2016<-c(101.5,101.5,101.5,101.5,101.5,101.5,101.5,101.5,101.5,101.5,101.5,101.5,101.2,101.8,103.0,104.1,103.5,104.3,105.8,105.9,104.0,103.4,102.9,103.3,102.6,103.7,104.6,104.0,104.7,105.0,106.4,106.3,105.1,104.6,103.7,104.4,104.2,105.4,106.6,107.0,106.3,107.3,108.0,108.1,107.4,106.8,106.3,107.0,106.0,107.0,108.1,108.5,107.7,109.0,108.2,108.2,107.9,106.8,107.3,108.9,108.5,108.9,109.0,109.4,109.4,110.0,110.6,111.3,110.7,111.1,111.1,112.2,110.8,111.3,112.6,114.5,113.9,114.8) %>% as.numeric() 

CORE_SERVICES_DATE<-seq(as.Date("2016-01-01"),as.Date("2022-06-01") , by="month")


#CORE_SERVICES_DATE<- SERVICES_DATE[194:(length(SERVICES_DATE)-7)]

CORE_SERVICES_INDEX_XTS<-as.xts(Core_SERVICES_INDEX_DEC_2016,order.by=CORE_SERVICES_DATE)




#Processed Food including alchol and tobacco

CP0111_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Bread and cereals (COICOP 01.1.1)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0114_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Milk, cheese and eggs (COICOP 01.1.4)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0115_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Oils and fats (COICOP 01.1.5)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0118_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Sugar, jam, honey, chocolate and confectionery (COICOP 01.1.8)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0119_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Food products n.e.c. (COICOP 01.1.9)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0121_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Coffee, tea and cocoa (COICOP 01.2.1)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0122_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Mineral waters, soft drinks, fruit and vegetable juices (COICOP 01.2.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0211_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Spirits (COICOP 02.1.1)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0212_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Wine (COICOP 02.1.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0213_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Beer (COICOP 02.1.3)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)
CP0220_INDEX<- t(data.frame(subset(subset(cso_get_data("CPM15"),Statistic=="EU HICP"),Commodity.Group =="Tobacco (COICOP 02.2)")))%>% as.numeric()  %>% na.omit() %>% as.xts (order.by=Date_index_ALT2)

HICP_SUB_PROC_FOOD_INDICATORS<-merge(CP0111_INDEX,CP0114_INDEX,CP0115_INDEX,CP0118_INDEX,CP0119_INDEX,CP0121_INDEX,CP0122_INDEX,CP0211_INDEX,CP0212_INDEX,CP0213_INDEX,CP0220_INDEX)

FOOD_P_INDEX<-rdb("Eurostat/prc_hicp_midx/M.I15.FOOD_P.IE") %>% .$value %>% as.numeric()
FOOD_P_DATE<-rdb("Eurostat/prc_hicp_midx/M.I15.FOOD_P.IE") %>% .$period %>% as.Date()

FOOD_P_INDEX_XTS<-as.xts(FOOD_P_INDEX,order.by=FOOD_P_DATE)

  Goods_INDEX<-merge(CP0111_INDEX,CP0112_INDEX,
  CP0113_INDEX,
  CP0114_INDEX,
  CP0115_INDEX,
  CP0116_INDEX,
  CP0117_INDEX,
  CP0118_INDEX,
  CP0119_INDEX,
  CP0121_INDEX,
  CP0122_INDEX,
  CP0211_INDEX,
  CP0212_INDEX,
  CP0213_INDEX,
  CP0220_INDEX,
  CP0311_INDEX,
  CP0312_INDEX,
  CP0313_INDEX,
  CP032_INDEX,
  CP0431_INDEX,
  CP0441_INDEX,
  CP0451_INDEX,
  CP0452_INDEX,
  CP0453_INDEX,
  CP0454_INDEX,
  CP0455_INDEX,
  CP0511_INDEX,
  CP0512_INDEX,
  CP0520_INDEX,
  CP0531_2_INDEX,
  CP0540_INDEX,
  CP055_INDEX,
  CP0561_INDEX,
  CP0611_INDEX,
  CP0612_3_INDEX,
  CP0711_INDEX,
  CP0712_3_4_INDEX,
  CP0721_INDEX,
  CP0722_INDEX,
  CP0911_INDEX,
  CP0912_INDEX,
  CP0913_INDEX,
  CP0914_INDEX,
  CP0921_2_INDEX,
  CP0931_INDEX,
  CP0932_INDEX,
  CP0933_INDEX,
  CP0934_5_INDEX,
  CP0951_INDEX,
  CP0952_INDEX,
  CP0953_4_INDEX,
  CP1212_3_INDEX,
  CP1231_INDEX,
  CP1232_INDEX)





Services_INDEX<-merge(CP0411_INDEX,CP0432_INDEX,
                      CP0442_INDEX,
                      CP0443_INDEX,
                      CP0444_INDEX,
                      CP0533_INDEX,
                      CP0562_INDEX,
                      CP1252_INDEX,
                      CP0314_INDEX,
                      CP0915_INDEX,
                      CP0941_INDEX,
                      CP0942_INDEX,
                      CP1111_INDEX,
                      CP1112_INDEX,
                      CP1211_INDEX,
                      CP0723_INDEX,
                      CP0724_INDEX,
                      CP0731_INDEX,
                      CP0732_INDEX,
                      CP0733_INDEX,
                      CP0734_INDEX,
                      CP0735_INDEX,
                      CP0736_INDEX,
                      CP096_INDEX,
                      CP112_INDEX,
                      CP0621_3_INDEX,
                      CP0622_INDEX,
                      CP063_INDEX,
                      CP10_INDEX,
                      CP124_INDEX,
                      CP1253_INDEX,
                      CP1254_INDEX,
                      CP126_INDEX,
                      CP127_INDEX,
                      CP081_INDEX,
                      CP082_3_INDEX)



UNPROCESSED_FOOD_INDEX<-merge(CP0112_INDEX,
                              CP0113_INDEX,
                              CP0116_INDEX,
                              CP0117_INDEX)



PROCESSED_FOOD_INDEX<-merge(CP0111_INDEX,
                            CP0114_INDEX,
                            CP0115_INDEX,
                            CP0118_INDEX,
                            CP0119_INDEX,
                            CP0121_INDEX,
                            CP0122_INDEX,
                            CP0211_INDEX,
                            CP0212_INDEX,
                            CP0213_INDEX,
                            CP0220_INDEX
)



#WEIGHTS 

Date<-rdb("Eurostat/prc_hicp_inw/A.CP01.IE") %>% .$period %>% as.Date()


#Goods weight 
CP0111_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0111.IE") %>% .$value %>% as.numeric()
  CP0112_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0112.IE") %>% .$value %>% as.numeric()
  CP0113_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0113.IE") %>% .$value %>% as.numeric()
  CP0114_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0114.IE") %>% .$value %>% as.numeric()
  CP0115_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0115.IE") %>% .$value %>% as.numeric()
  CP0116_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0116.IE") %>% .$value %>% as.numeric()
  CP0117_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0117.IE") %>% .$value %>% as.numeric()
  CP0118_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0118.IE") %>% .$value %>% as.numeric()
  CP0119_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0119.IE") %>% .$value %>% as.numeric()
  CP0121_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0121.IE") %>% .$value %>% as.numeric()
  CP0122_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0122.IE") %>% .$value %>% as.numeric()
  CP0211_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0211.IE") %>% .$value %>% as.numeric()
  CP0212_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0212.IE") %>% .$value %>% as.numeric()
  CP0213_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0213.IE") %>% .$value %>% as.numeric()
  CP0220_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP022.IE") %>% .$value %>% as.numeric()
  CP0311_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0311.IE") %>% .$value %>% as.numeric()
  CP0312_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0312.IE") %>% .$value %>% as.numeric()
  CP0313_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0313.IE") %>% .$value %>% as.numeric()
  CP032_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP032.IE") %>% .$value %>% as.numeric()
  CP0431_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0431.IE") %>% .$value %>% as.numeric()
  CP0441_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0441.IE") %>% .$value %>% as.numeric()
  CP0451_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0451.IE") %>% .$value %>% as.numeric()
  CP0452_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0452.IE") %>% .$value %>% as.numeric()
  CP0453_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0453.IE") %>% .$value %>% as.numeric()
  CP0454_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0454.IE") %>% .$value %>% as.numeric()
  CP0455_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0455.IE") %>% .$value %>% as.numeric()
  CP0511_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0511.IE") %>% .$value %>% as.numeric()
  CP0512_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0512.IE") %>% .$value %>% as.numeric()
  CP0520_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP052.IE") %>% .$value %>% as.numeric()
  CP0531_2_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0531_0532.IE") %>% .$value %>% as.numeric()
  CP0540_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP054.IE") %>% .$value %>% as.numeric()
  CP055_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP055.IE") %>% .$value %>% as.numeric()
  CP0561_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0561.IE") %>% .$value %>% as.numeric()
  CP0611_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0611.IE") %>% .$value %>% as.numeric()
  CP0612_3_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0612_0613.IE") %>% .$value %>% as.numeric()
  CP0711_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0711.IE") %>% .$value %>% as.numeric()
  CP0712_3_4_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0712-0714.IE") %>% .$value %>% as.numeric()
  CP0721_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0721.IE") %>% .$value %>% as.numeric()
  CP0722_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0722.IE") %>% .$value %>% as.numeric()
  CP0911_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0911.IE") %>% .$value %>% as.numeric()
  CP0912_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0912.IE") %>% .$value %>% as.numeric()
  CP0913_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0913.IE") %>% .$value %>% as.numeric()
  CP0914_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0914.IE") %>% .$value %>% as.numeric()
  CP0921_2_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0921_0922.IE") %>% .$value %>% as.numeric()
  CP0931_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0931.IE") %>% .$value %>% as.numeric()
  CP0932_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0932.IE") %>% .$value %>% as.numeric()
  CP0933_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0933.IE") %>% .$value %>% as.numeric()
  CP0934_5_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0934_0935.IE") %>% .$value %>% as.numeric()
  CP0951_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0951.IE") %>% .$value %>% as.numeric()
  CP0952_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0952.IE") %>% .$value %>% as.numeric()
  CP0953_4_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0953_0954.IE") %>% .$value %>% as.numeric()
  CP1212_3_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1212_1213.IE") %>% .$value %>% as.numeric()
  CP1231_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1231.IE") %>% .$value %>% as.numeric()
  CP1232_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1232.IE") %>% .$value %>% as.numeric()










#PROCESSED_FOOD weight 
CP0111_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0111.IE") %>% .$value %>% as.numeric()
CP0114_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0114.IE") %>% .$value %>% as.numeric()
CP0115_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0115.IE") %>% .$value %>% as.numeric()
CP0118_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0118.IE") %>% .$value %>% as.numeric()
CP0119_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0119.IE") %>% .$value %>% as.numeric()
CP0121_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0121.IE") %>% .$value %>% as.numeric()
CP0122_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0122.IE") %>% .$value %>% as.numeric()
CP0211_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0211.IE") %>% .$value %>% as.numeric()
CP0212_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0212.IE") %>% .$value %>% as.numeric()
CP0213_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0213.IE") %>% .$value %>% as.numeric()
CP0220_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP022.IE") %>% .$value %>% as.numeric()


#UNPROCESSED_FOOD weight 
CP01112_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0112.IE") %>% .$value %>% as.numeric()
CP01113_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0113.IE") %>% .$value %>% as.numeric()
CP01116_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0116.IE") %>% .$value %>% as.numeric()
CP01117_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0117.IE") %>% .$value %>% as.numeric()

#Services
CP0111_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0111.IE") %>% .$value %>% as.numeric()
CP0112_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0112.IE") %>% .$value %>% as.numeric()
CP0113_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0113.IE") %>% .$value %>% as.numeric()
CP0114_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0114.IE") %>% .$value %>% as.numeric()
CP0115_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0115.IE") %>% .$value %>% as.numeric()
CP0116_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0116.IE") %>% .$value %>% as.numeric()
CP0117_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0117.IE") %>% .$value %>% as.numeric()
CP0118_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0118.IE") %>% .$value %>% as.numeric()
CP0119_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0119.IE") %>% .$value %>% as.numeric()
CP0121_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0121.IE") %>% .$value %>% as.numeric()
CP0122_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0122.IE") %>% .$value %>% as.numeric()
CP0211_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0211.IE") %>% .$value %>% as.numeric()
CP0212_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0212.IE") %>% .$value %>% as.numeric()
CP0213_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0213.IE") %>% .$value %>% as.numeric()
CP022_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP022.IE")   %>% .$value %>% as.numeric()
CP0311_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0311.IE") %>% .$value %>% as.numeric()
CP0312_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0312.IE") %>% .$value %>% as.numeric()
CP0313_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0313.IE") %>% .$value %>% as.numeric()
CP0314_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0314.IE") %>% .$value %>% as.numeric()
CP0321_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0321.IE") %>% .$value %>% as.numeric()
CP0322_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0322.IE") %>% .$value %>% as.numeric()
CP0411_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0411.IE") %>% .$value %>% as.numeric()
CP0431_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0431.IE") %>% .$value %>% as.numeric()
CP0432_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0432.IE") %>% .$value %>% as.numeric()
CP0441_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0441.IE") %>% .$value %>% as.numeric()
CP0442_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0442.IE") %>% .$value %>% as.numeric()
CP0443_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0443.IE") %>% .$value %>% as.numeric()
CP0444_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0444.IE") %>% .$value %>% as.numeric()
CP0451_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0451.IE") %>% .$value %>% as.numeric()
CP0452_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0452.IE") %>% .$value %>% as.numeric()
CP0453_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0453.IE") %>% .$value %>% as.numeric()
CP0454_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0454.IE") %>% .$value %>% as.numeric()
CP0511_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0511.IE") %>% .$value %>% as.numeric()
CP0512_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0512.IE") %>% .$value %>% as.numeric()
CP052_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP052.IE") %>% .$value %>% as.numeric()
CP0531_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0531.IE") %>% .$value %>% as.numeric()
CP0532_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0532.IE") %>% .$value %>% as.numeric()
CP0533_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0533.IE") %>% .$value %>% as.numeric()
CP54_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP054.IE") %>% .$value %>% as.numeric()
CP0551_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0551.IE") %>% .$value %>% as.numeric()
CP0552_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0552.IE") %>% .$value %>% as.numeric()
CP0561_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0561.IE") %>% .$value %>% as.numeric()
CP0562_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0562.IE") %>% .$value %>% as.numeric()
CP0611_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0611.IE") %>% .$value %>% as.numeric()
CP0612_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0612.IE") %>% .$value %>% as.numeric()
CP0613_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0613.IE") %>% .$value %>% as.numeric()
CP0621_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0621.IE") %>% .$value %>% as.numeric()
CP0622_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0622.IE") %>% .$value %>% as.numeric()
CP0623_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0623.IE") %>% .$value %>% as.numeric()
CP063_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP063.IE") %>% .$value %>% as.numeric()
CP0711_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0711.IE") %>% .$value %>% as.numeric()
CP0712_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0712.IE") %>% .$value %>% as.numeric()
CP0713_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0713.IE") %>% .$value %>% as.numeric()
CP0721_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0721.IE") %>% .$value %>% as.numeric()
CP0722_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0722.IE") %>% .$value %>% as.numeric()
CP0723_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0723.IE") %>% .$value %>% as.numeric()
CP0724_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0724.IE") %>% .$value %>% as.numeric()
CP0731_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0731.IE") %>% .$value %>% as.numeric()
CP0732_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0732.IE") %>% .$value %>% as.numeric()
CP0733_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0733.IE") %>% .$value %>% as.numeric()
CP0734_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0734.IE") %>% .$value %>% as.numeric()
CP0735_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0735.IE") %>% .$value %>% as.numeric()
CP0736_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0736.IE") %>% .$value %>% as.numeric()
CP081_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP081.IE") %>% .$value %>% as.numeric()


CP082_3_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP082_083.IE") %>% .$value %>% as.numeric()

CP0820_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0820.IE") %>% .$value %>% as.numeric()
CP0830_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0830.IE") %>% .$value %>% as.numeric()
CP0911_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0911.IE") %>% .$value %>% as.numeric()
CP0912_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0912.IE") %>% .$value %>% as.numeric()
CP0913_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0913.IE") %>% .$value %>% as.numeric()
CP0914_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0914.IE") %>% .$value %>% as.numeric()
CP0915_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0915.IE") %>% .$value %>% as.numeric()
CP0921_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0921.IE") %>% .$value %>% as.numeric()
CP0922_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0922.IE") %>% .$value %>% as.numeric()
CP0931_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0931.IE") %>% .$value %>% as.numeric()
CP0932_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0932.IE") %>% .$value %>% as.numeric()
CP0933_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0933.IE") %>% .$value %>% as.numeric()
CP0934_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0934.IE") %>% .$value %>% as.numeric()
CP0935_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0935.IE") %>% .$value %>% as.numeric()
CP0941_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0941.IE") %>% .$value %>% as.numeric()
CP0942_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0942.IE") %>% .$value %>% as.numeric()
CP0951_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0951.IE") %>% .$value %>% as.numeric()
CP0952_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0952.IE") %>% .$value %>% as.numeric()
CP0953_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0953.IE") %>% .$value %>% as.numeric()
CP0954_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP0954.IE") %>% .$value %>% as.numeric()
CP096_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP096.IE") %>% .$value %>% as.numeric()
CP10_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP10.IE") %>% .$value %>% as.numeric()
CP1111_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1111.IE") %>% .$value %>% as.numeric()
CP1112_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1112.IE") %>% .$value %>% as.numeric()
CP112_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP112.IE") %>% .$value %>% as.numeric()
CP1211_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1211.IE") %>% .$value %>% as.numeric()
CP1212_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1212.IE") %>% .$value %>% as.numeric()
CP1213_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1213.IE") %>% .$value %>% as.numeric()
CP1231_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1231.IE") %>% .$value %>% as.numeric()
CP1232_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1232.IE") %>% .$value %>% as.numeric()
CP124_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP124.IE") %>% .$value %>% as.numeric()
CP1252_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1252.IE") %>% .$value %>% as.numeric()
CP1253_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1253.IE") %>% .$value %>% as.numeric()
CP1254_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP1254.IE") %>% .$value %>% as.numeric()
CP126_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP126.IE") %>% .$value %>% as.numeric()
CP127_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.CP127.IE") %>% .$value %>% as.numeric()

OVERALL_SERVICES_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.SERV.IE") %>% .$value %>% as.numeric()
OVERALL_FOOD_NP_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.FOOD_NP.IE") %>% .$value %>% as.numeric()
OVERALL_GOODS_WEIGHT<-rdb("Eurostat/prc_hicp_inw/A.GD.IE")%>% .$value %>% as.numeric()



#goods date 

CP0111_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0111.IE") %>% .$period %>% as.Date()

CP0112_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0112.IE") %>% .$period %>% as.Date()
CP0113_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0113.IE") %>% .$period %>% as.Date()
CP0114_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0114.IE") %>% .$period %>% as.Date()
CP0115_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0115.IE") %>% .$period %>% as.Date()
CP0116_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0116.IE") %>% .$period %>% as.Date()
CP0117_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0117.IE") %>% .$period %>% as.Date()
CP0118_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0118.IE") %>% .$period %>% as.Date()
CP0119_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0119.IE") %>% .$period %>% as.Date()
CP0121_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0121.IE") %>% .$period %>% as.Date()
CP0122_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0122.IE") %>% .$period %>% as.Date()
CP0211_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0211.IE") %>% .$period %>% as.Date()
CP0212_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0212.IE") %>% .$period %>% as.Date()
CP0213_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0213.IE") %>% .$period %>% as.Date()
CP0220_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP022.IE") %>% .$period %>% as.Date()
CP0311_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0311.IE") %>% .$period %>% as.Date()
CP0312_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0312.IE") %>% .$period %>% as.Date()
CP0313_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0313.IE") %>% .$period %>% as.Date()
CP032_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP032.IE") %>% .$period %>% as.Date()
CP0431_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0431.IE") %>% .$period %>% as.Date()
CP0441_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0441.IE") %>% .$period %>% as.Date()
CP0451_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0451.IE") %>% .$period %>% as.Date()
CP0452_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0452.IE") %>% .$period %>% as.Date()
CP0453_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0453.IE") %>% .$period %>% as.Date()
CP0454_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0454.IE") %>% .$period %>% as.Date()
CP0455_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0455.IE") %>% .$period %>% as.Date()
CP0511_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0511.IE") %>% .$period %>% as.Date()
CP0512_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0512.IE") %>% .$period %>% as.Date()
CP0520_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP052.IE") %>% .$period %>% as.Date()
CP0531_2_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0531_0532.IE") %>% .$period %>% as.Date()
CP0540_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP054.IE") %>% .$period %>% as.Date()
CP055_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP055.IE") %>% .$period %>% as.Date()
CP0561_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0561.IE") %>% .$period %>% as.Date()
CP0611_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0611.IE") %>% .$period %>% as.Date()
CP0612_3_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0612_0613.IE") %>% .$period %>% as.Date()
CP0711_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0711.IE") %>% .$period %>% as.Date()
CP0712_3_4_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0712-0714.IE") %>% .$period %>% as.Date()
CP0721_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0721.IE") %>% .$period %>% as.Date()
CP0722_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0722.IE") %>% .$period %>% as.Date()
CP0911_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0911.IE") %>% .$period %>% as.Date()
CP0912_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0912.IE") %>% .$period %>% as.Date()
CP0913_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0913.IE") %>% .$period %>% as.Date()
CP0914_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0914.IE") %>% .$period %>% as.Date()
CP0921_2_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0921_0922.IE") %>% .$period %>% as.Date()
CP0931_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0931.IE") %>% .$period %>% as.Date()
CP0932_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0932.IE") %>% .$period %>% as.Date()
CP0933_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0933.IE") %>% .$period %>% as.Date()
CP0934_5_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0934_0935.IE") %>% .$period %>% as.Date()
CP0951_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0951.IE") %>% .$period %>% as.Date()
CP0952_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0952.IE") %>% .$period %>% as.Date()
CP0953_4_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP0953_0954.IE") %>% .$period %>% as.Date()
CP1212_3_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP1212_1213.IE") %>% .$period %>% as.Date()
CP1231_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP1231.IE") %>% .$period %>% as.Date()
CP1232_WEIGHT_DATE<-rdb("Eurostat/prc_hicp_inw/A.CP1232.IE") %>% .$period %>% as.Date()




#processed food date 

CP0111_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0111.IE") %>% .$period %>% as.Date()
CP0114_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0114.IE")  %>% .$period %>% as.Date()
CP0115_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0115.IE")  %>% .$period %>% as.Date()
CP0118_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0118.IE")  %>% .$period %>% as.Date()
CP0119_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0119.IE")  %>% .$period %>% as.Date()
CP0121_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0121.IE")  %>% .$period %>% as.Date()
CP0122_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0122.IE")  %>% .$period %>% as.Date()
CP0211_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0211.IE")  %>% .$period %>% as.Date()
CP0212_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0212.IE")  %>% .$period %>% as.Date()
CP0213_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0213.IE")  %>% .$period %>% as.Date()
CP0220_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP022.IE")  %>% .$period %>% as.Date()


#Unprocessed food date
CP0112_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0112.IE") %>% .$period %>% as.Date()
CP0113_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0113.IE") %>% .$period %>% as.Date()
CP0116_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0116.IE") %>% .$period %>% as.Date()
CP0117_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0117.IE") %>% .$period %>% as.Date()


CP0111_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0111.IE") %>% .$period %>% as.Date()
CP0112_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0112.IE") %>% .$period %>% as.Date()
CP0113_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0113.IE") %>% .$period %>% as.Date()
CP0114_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0114.IE") %>% .$period %>% as.Date()
CP0115_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0115.IE") %>% .$period %>% as.Date()
CP0116_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0116.IE") %>% .$period %>% as.Date()
CP0117_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0117.IE") %>% .$period %>% as.Date()
CP0118_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0118.IE") %>% .$period %>% as.Date()
CP0119_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0119.IE")%>% .$period %>% as.Date()
CP0121_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0121.IE")%>% .$period %>% as.Date()
CP0122_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0122.IE")%>% .$period %>% as.Date()
CP0211_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0211.IE")%>% .$period %>% as.Date()
CP0212_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0212.IE")%>% .$period %>% as.Date()
CP0213_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0213.IE")%>% .$period %>% as.Date()
CP022_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP022.IE")%>% .$period %>% as.Date()
CP0311_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0311.IE")%>% .$period %>% as.Date()
CP0312_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0312.IE")%>% .$period %>% as.Date()
CP0313_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0313.IE")%>% .$period %>% as.Date()
CP0314_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0314.IE")%>% .$period %>% as.Date()
CP0321_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0321.IE")%>% .$period %>% as.Date()
CP0322_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0322.IE")%>% .$period %>% as.Date()
CP0411_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0411.IE")%>% .$period %>% as.Date()
CP0431_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0431.IE")%>% .$period %>% as.Date()
CP0432_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0432.IE")%>% .$period %>% as.Date()
CP0441_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0441.IE")%>% .$period %>% as.Date()
CP0442_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0442.IE")%>% .$period %>% as.Date()
CP0443_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0443.IE")%>% .$period %>% as.Date()
CP0444_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0444.IE")%>% .$period %>% as.Date()
CP0451_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0451.IE")%>% .$period %>% as.Date()
CP0452_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0452.IE")%>% .$period %>% as.Date()
CP0453_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0453.IE")%>% .$period %>% as.Date()
CP0454_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0454.IE")%>% .$period %>% as.Date()
CP0511_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0511.IE")%>% .$period %>% as.Date()
CP0512_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0512.IE")%>% .$period %>% as.Date()

##MISSING Repair of furniture, furnishings and floor coverings 05.1.3


CP052_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP052.IE")%>% .$period %>% as.Date()
CP0531_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0531.IE")%>% .$period %>% as.Date()
CP0532_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0532.IE")%>% .$period %>% as.Date()
CP0533_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0533.IE")%>% .$period %>% as.Date()
CP54_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP054.IE")%>% .$period %>% as.Date()
CP0551_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0551.IE")%>% .$period %>% as.Date()
CP0552_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0552.IE")%>% .$period %>% as.Date()
CP0561_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0561.IE")%>% .$period %>% as.Date()
CP0562_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0562.IE")%>% .$period %>% as.Date()
CP0611_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0611.IE")%>% .$period %>% as.Date()
CP0612_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0612.IE")%>% .$period %>% as.Date()
CP0613_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0613.IE")%>% .$period %>% as.Date()
CP0621_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0621.IE")%>% .$period %>% as.Date()
CP0622_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0622.IE")%>% .$period %>% as.Date()
CP0623_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0623.IE")%>% .$period %>% as.Date()
CP063_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP063.IE")%>% .$period %>% as.Date()
CP0711_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0711.IE")%>% .$period %>% as.Date()
CP0712_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0712.IE")%>% .$period %>% as.Date()
CP0713_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0713.IE")%>% .$period %>% as.Date()
CP0721_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0721.IE")%>% .$period %>% as.Date()
CP0722_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0722.IE")%>% .$period %>% as.Date()
CP0723_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0723.IE")%>% .$period %>% as.Date()
CP0724_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0724.IE")%>% .$period %>% as.Date()
CP0731_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0731.IE")%>% .$period %>% as.Date()
CP0732_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0732.IE")%>% .$period %>% as.Date()
CP0733_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0733.IE")%>% .$period %>% as.Date()
CP0734_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0734.IE")%>% .$period %>% as.Date()
CP0735_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0735.IE")%>% .$period %>% as.Date()
CP0736_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0736.IE")%>% .$period %>% as.Date()
CP081_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP081.IE")%>% .$period %>% as.Date()

CP082_3_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP082_083.IE")%>% .$period %>% as.Date()

CP0820_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0820.IE")%>% .$period %>% as.Date()
CP0830_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0830.IE")%>% .$period %>% as.Date()
CP0911_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0911.IE")%>% .$period %>% as.Date()
CP0912_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0912.IE")%>% .$period %>% as.Date()
CP0913_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0913.IE")%>% .$period %>% as.Date()
CP0914_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0914.IE")%>% .$period %>% as.Date()
CP0915_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0915.IE")%>% .$period %>% as.Date()
CP0921_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0921.IE")%>% .$period %>% as.Date()
CP0922_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0922.IE")%>% .$period %>% as.Date()
CP0931_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0931.IE")%>% .$period %>% as.Date()
CP0932_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0932.IE")%>% .$period %>% as.Date()
CP0933_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0933.IE")%>% .$period %>% as.Date()
CP0934_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0934.IE")%>% .$period %>% as.Date()
CP0935_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0935.IE")%>% .$period %>% as.Date()
CP0941_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0941.IE")%>% .$period %>% as.Date()
CP0942_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0942.IE")%>% .$period %>% as.Date()
CP0951_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0951.IE")%>% .$period %>% as.Date()
CP0952_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0952.IE")%>% .$period %>% as.Date()
CP0953_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0953.IE")%>% .$period %>% as.Date()
CP0954_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP0954.IE")%>% .$period %>% as.Date()
CP096_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP096.IE")%>% .$period %>% as.Date()
CP10_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP10.IE")%>% .$period %>% as.Date()
CP1111_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1111.IE")%>% .$period %>% as.Date()
CP1112_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1112.IE")%>% .$period %>% as.Date()
CP112_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP112.IE")%>% .$period %>% as.Date()
CP1211_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1211.IE")%>% .$period %>% as.Date()
CP1212_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1212.IE")%>% .$period %>% as.Date()
CP1213_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1213.IE")%>% .$period %>% as.Date()
CP1231_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1231.IE")%>% .$period %>% as.Date()
CP1232_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1232.IE")%>% .$period %>% as.Date()
CP124_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP124.IE")%>% .$period %>% as.Date()
CP1252_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1252.IE")%>% .$period %>% as.Date()
CP1253_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1253.IE")%>% .$period %>% as.Date()
CP1254_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP1254.IE")%>% .$period %>% as.Date()
CP126_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP126.IE")%>% .$period %>% as.Date()
CP127_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.CP127.IE")%>% .$period %>% as.Date()


#Aggregate Weight 
OVERALL_GOODS_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.GD.IE")%>% .$period %>% as.Date()

OVERALL_SERVICES_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.SERV.IE")%>% .$period %>% as.Date()
OVERALL_UNPROCESSED_FOOD_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.FOOD_NP.IE")%>% .$period %>% as.Date()
OVERALL_PROCESSED_FOOD_WEIGHT_Date<-rdb("Eurostat/prc_hicp_inw/A.FOOD_P.IE")%>% .$period %>% as.Date()




#Goods XTS
CP0111_XTS<-	as.xts(CP0111_WEIGHT	,order.by=CP0111_WEIGHT_DATE)  
CP0112_XTS<-	as.xts(CP0112_WEIGHT	,order.by=CP0112_WEIGHT_DATE)

CP0113_XTS<-	as.xts(CP0113_WEIGHT	,order.by=CP0113_WEIGHT_DATE)
CP0114_XTS<-	as.xts(CP0114_WEIGHT	,order.by=CP0114_WEIGHT_DATE)
CP0115_XTS<-	as.xts(CP0115_WEIGHT	,order.by=CP0115_WEIGHT_DATE)
CP0116_XTS<-	as.xts(CP0116_WEIGHT	,order.by=CP0116_WEIGHT_DATE)
CP0117_XTS<-	as.xts(CP0117_WEIGHT	,order.by=CP0117_WEIGHT_DATE)
CP0118_XTS<-	as.xts(CP0118_WEIGHT	,order.by=CP0118_WEIGHT_DATE)
CP0119_XTS<-	as.xts(CP0119_WEIGHT	,order.by=CP0119_WEIGHT_DATE)
CP0121_XTS<-	as.xts(CP0121_WEIGHT	,order.by=CP0121_WEIGHT_DATE)
CP0122_XTS<-	as.xts(CP0122_WEIGHT	,order.by=CP0122_WEIGHT_DATE)
CP0211_XTS<-	as.xts(CP0211_WEIGHT	,order.by=CP0211_WEIGHT_DATE)
CP0212_XTS<-	as.xts(CP0212_WEIGHT	,order.by=CP0212_WEIGHT_DATE)
CP0213_XTS<-	as.xts(CP0213_WEIGHT	,order.by=CP0213_WEIGHT_DATE)
CP0220_XTS<-	as.xts(CP0220_WEIGHT	,order.by=CP0220_WEIGHT_DATE)
CP0311_XTS<-	as.xts(CP0311_WEIGHT	,order.by=CP0311_WEIGHT_DATE)
CP0312_XTS<-	as.xts(CP0312_WEIGHT	,order.by=CP0312_WEIGHT_DATE)
CP0313_XTS<-	as.xts(CP0313_WEIGHT	,order.by=CP0313_WEIGHT_DATE)
CP032_XTS<-	as.xts(CP032_WEIGHT	,order.by=CP032_WEIGHT_DATE)
CP0431_XTS<-	as.xts(CP0431_WEIGHT	,order.by=CP0431_WEIGHT_DATE)
CP0441_XTS<-	as.xts(CP0441_WEIGHT	,order.by=CP0441_WEIGHT_DATE)
CP0451_XTS<-	as.xts(CP0451_WEIGHT	,order.by=CP0451_WEIGHT_DATE)
CP0452_XTS<-	as.xts(CP0452_WEIGHT	,order.by=CP0452_WEIGHT_DATE)
CP0453_XTS<-	as.xts(CP0453_WEIGHT	,order.by=CP0453_WEIGHT_DATE)
CP0454_XTS<-	as.xts(CP0454_WEIGHT	,order.by=CP0454_WEIGHT_DATE)
CP0455_XTS<-	as.xts(CP0455_WEIGHT	,order.by=CP0455_WEIGHT_DATE)
CP0511_XTS<-	as.xts(CP0511_WEIGHT	,order.by=CP0511_WEIGHT_DATE)
CP0512_XTS<-	as.xts(CP0512_WEIGHT	,order.by=CP0512_WEIGHT_DATE)
CP0520_XTS<-	as.xts(CP0520_WEIGHT	,order.by=CP0520_WEIGHT_DATE)
CP0531_2_XTS<-	as.xts(CP0531_2_WEIGHT	,order.by=CP0531_2_WEIGHT_DATE)
CP0540_XTS<-	as.xts(CP0540_WEIGHT	,order.by=CP0540_WEIGHT_DATE)
CP055_XTS<-	as.xts(CP055_WEIGHT	,order.by=CP055_WEIGHT_DATE)
CP0561_XTS<-	as.xts(CP0561_WEIGHT	,order.by=CP0561_WEIGHT_DATE)
CP0611_XTS<-	as.xts(CP0611_WEIGHT	,order.by=CP0611_WEIGHT_DATE)
CP0612_3_XTS<-	as.xts(CP0612_3_WEIGHT	,order.by=CP0612_3_WEIGHT_DATE)
CP0711_XTS<-	as.xts(CP0711_WEIGHT	,order.by=CP0711_WEIGHT_DATE)
CP0712_3_4_XTS<-	as.xts(CP0712_3_4_WEIGHT	,order.by=CP0712_3_4_WEIGHT_DATE)
CP0721_XTS<-	as.xts(CP0721_WEIGHT	,order.by=CP0721_WEIGHT_DATE)
CP0722_XTS<-	as.xts(CP0722_WEIGHT	,order.by=CP0722_WEIGHT_DATE)
CP0911_XTS<-	as.xts(CP0911_WEIGHT	,order.by=CP0911_WEIGHT_DATE)
CP0912_XTS<-	as.xts(CP0912_WEIGHT	,order.by=CP0912_WEIGHT_DATE)
CP0913_XTS<-	as.xts(CP0913_WEIGHT	,order.by=CP0913_WEIGHT_DATE)
CP0914_XTS<-	as.xts(CP0914_WEIGHT	,order.by=CP0914_WEIGHT_DATE)
CP0921_2_XTS<-	as.xts(CP0921_2_WEIGHT	,order.by=CP0921_2_WEIGHT_DATE)
CP0931_XTS<-	as.xts(CP0931_WEIGHT	,order.by=CP0931_WEIGHT_DATE)
CP0932_XTS<-	as.xts(CP0932_WEIGHT	,order.by=CP0932_WEIGHT_DATE)
CP0933_XTS<-	as.xts(CP0933_WEIGHT	,order.by=CP0933_WEIGHT_DATE)
CP0934_5_XTS<-	as.xts(CP0934_5_WEIGHT	,order.by=CP0934_5_WEIGHT_DATE)
CP0951_XTS<-	as.xts(CP0951_WEIGHT	,order.by=CP0951_WEIGHT_DATE)
CP0952_XTS<-	as.xts(CP0952_WEIGHT	,order.by=CP0952_WEIGHT_DATE)
CP0953_4_XTS<-	as.xts(CP0953_4_WEIGHT	,order.by=CP0953_4_WEIGHT_DATE)
CP1212_3_XTS<-	as.xts(CP1212_3_WEIGHT	,order.by=CP1212_3_WEIGHT_DATE)
CP1231_XTS<-	as.xts(CP1231_WEIGHT	,order.by=CP1231_WEIGHT_DATE)
CP1232_XTS<-	as.xts(CP1232_WEIGHT	,order.by=CP1232_WEIGHT_DATE)


GOODS_XTS_WEIGHT<-merge(CP0111_XTS,
                        CP0112_XTS,
                        CP0113_XTS,
                        CP0114_XTS,
                        CP0115_XTS,
                        CP0116_XTS,
                        CP0117_XTS,
                        CP0118_XTS,
                        CP0119_XTS,
                        CP0121_XTS,
                        CP0122_XTS,
                        CP0211_XTS,
                        CP0212_XTS,
                        CP0213_XTS,
                        CP0220_XTS,
                        CP0311_XTS,
                        CP0312_XTS,
                        CP0313_XTS,
                        CP032_XTS,
                        CP0431_XTS,
                        CP0441_XTS,
                        CP0451_XTS,
                        CP0452_XTS,
                        CP0453_XTS,
                        CP0454_XTS,
                        CP0455_XTS,
                        CP0511_XTS,
                        CP0512_XTS,
                        CP0520_XTS,
                        CP0531_2_XTS,
                        CP0540_XTS,
                        CP055_XTS,
                        CP0561_XTS,
                        CP0611_XTS,
                        CP0612_3_XTS,
                        CP0711_XTS,
                        CP0712_3_4_XTS,
                        CP0721_XTS,
                        CP0722_XTS,
                        CP0911_XTS,
                        CP0912_XTS,
                        CP0913_XTS,
                        CP0914_XTS,
                        CP0921_2_XTS,
                        CP0931_XTS,
                        CP0932_XTS,
                        CP0933_XTS,
                        CP0934_5_XTS,
                        CP0951_XTS,
                        CP0952_XTS,
                        CP0953_4_XTS,
                        CP1212_3_XTS,
                        CP1231_XTS,
                        CP1232_XTS)


#TOTAL WEIGHTS CHECK - GOODS


TOTAL_sum_weight_GOODS<-data.frame(NA, nrow=length(index(GOODS_XTS_WEIGHT["1996/"])))

for (i in 1:length(index(GOODS_XTS_WEIGHT["1996/"]))) {
  TOTAL_sum_weight_GOODS[i]<-sum(as.numeric(GOODS_XTS_WEIGHT[i])/1000,na.rm = TRUE)
}


TOTAL_sum_weight_GOODS<-as.xts(t(TOTAL_sum_weight_GOODS), order.by = index(GOODS_XTS_WEIGHT))
colnames(TOTAL_sum_weight_GOODS)<-c("GOODS TOTAL")

TOTAL_sum_weight_GOODS<-TOTAL_sum_weight_GOODS*1000

#FOCUS ON GOODS WEIGHT 
OVERALL_GOODS_XTS_WEIGHT<-as.xts(as.numeric(TOTAL_sum_weight_GOODS$`GOODS TOTAL`["2000/"]),order.by=OVERALL_GOODS_WEIGHT_Date) -40


colnames(OVERALL_GOODS_XTS_WEIGHT)<- c("Goods")


ADJUSTED_GOODS_XTS_WEIGHT<-merge(CP0111_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0112_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0113_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0114_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0115_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0116_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0117_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0118_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0119_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0121_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0122_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0211_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0212_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0213_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0220_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0311_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0312_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0313_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP032_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0431_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0441_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0451_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0452_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0453_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0454_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0455_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0511_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0512_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0520_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0531_2_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0540_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP055_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0561_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0611_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0612_3_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0711_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0712_3_4_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0721_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0722_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0911_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0912_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0913_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0914_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0921_2_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0931_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0932_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0933_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0934_5_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0951_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0952_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP0953_4_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP1212_3_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP1231_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods,
                                 CP1232_XTS/OVERALL_GOODS_XTS_WEIGHT$Goods)




TOTAL_sum_weight_GOODS_ADJusted<-data.frame(NA, nrow=length(index(GOODS_XTS_WEIGHT["1996/"])))

for (i in 1:length(index(ADJUSTED_GOODS_XTS_WEIGHT["1996/"]))) {
  TOTAL_sum_weight_GOODS_ADJusted[i]<-sum(as.numeric(ADJUSTED_GOODS_XTS_WEIGHT[i]),na.rm = TRUE)
}


TOTAL_sum_weight_GOODS_ADJusted<-as.xts(t(TOTAL_sum_weight_GOODS_ADJusted), order.by = index(ADJUSTED_GOODS_XTS_WEIGHT))
colnames(TOTAL_sum_weight_GOODS_ADJusted)<-c("GOODS TOTAL")


colnames(ADJUSTED_GOODS_XTS_WEIGHT)<-c("CP0111",
"CP0112",
"CP0113",
"CP0114",
"CP0115",
"CP0116",
"CP0117",
"CP0118",
"CP0119",
"CP0121",
"CP0122",
"CP0211",
"CP0212",
"CP0213",
"CP0220",
"CP0311",
"CP0312",
"CP0313",
"CP032",
"CP0431",
"CP0441",
"CP0451",
"CP0452",
"CP0453",
"CP0454",
"CP0455",
"CP0511",
"CP0512",
"CP0520",
"CP0531_2",
"CP0540",
"CP055",
"CP0561",
"CP0611",
"CP0612_3",
"CP0711",
"CP0712_3_4",
"CP0721",
"CP0722",
"CP0911",
"CP0912",
"CP0913",
"CP0914",
"CP0921_2",
"CP0931",
"CP0932",
"CP0933",
"CP0934_5",
"CP0951",
"CP0952",
"CP0953_4",
"CP1212_3",
"CP1231",
"CP1232")




weight_monthly_Goods_ONLY<-merge(ADJUSTED_GOODS_XTS_WEIGHT["2017/"],index(Goods_INDEX["2017/"]))




for (i in 1:length(Goods_INDEX$CP0112_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0111["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0111["2017/"][i]<-weight_monthly_Goods_ONLY$CP0111["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0111["2017/"][i]<-weight_monthly_Goods_ONLY$CP0111["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0112_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0112["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0112["2017/"][i]<-weight_monthly_Goods_ONLY$CP0112["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0112["2017/"][i]<-weight_monthly_Goods_ONLY$CP0112["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0113["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0113["2017/"][i]<-weight_monthly_Goods_ONLY$CP0113["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0113["2017/"][i]<-weight_monthly_Goods_ONLY$CP0113["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0114["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0114["2017/"][i]<-weight_monthly_Goods_ONLY$CP0114["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0114["2017/"][i]<-weight_monthly_Goods_ONLY$CP0114["2017/"][i]
  }
}



for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0115["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0115["2017/"][i]<-weight_monthly_Goods_ONLY$CP0115["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0115["2017/"][i]<-weight_monthly_Goods_ONLY$CP0115["2017/"][i]
  }
}



for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0116["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0116["2017/"][i]<-weight_monthly_Goods_ONLY$CP0116["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0116["2017/"][i]<-weight_monthly_Goods_ONLY$CP0116["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0117["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0117["2017/"][i]<-weight_monthly_Goods_ONLY$CP0117["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0117["2017/"][i]<-weight_monthly_Goods_ONLY$CP0117["2017/"][i]
  }
}



for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0118["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0118["2017/"][i]<-weight_monthly_Goods_ONLY$CP0118["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0118["2017/"][i]<-weight_monthly_Goods_ONLY$CP0118["2017/"][i]
  }
}



for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0119["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0119["2017/"][i]<-weight_monthly_Goods_ONLY$CP0119["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0119["2017/"][i]<-weight_monthly_Goods_ONLY$CP0119["2017/"][i]
  }
}




for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0121["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0121["2017/"][i]<-weight_monthly_Goods_ONLY$CP0121["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0121["2017/"][i]<-weight_monthly_Goods_ONLY$CP0121["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0122["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0122["2017/"][i]<-weight_monthly_Goods_ONLY$CP0122["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0122["2017/"][i]<-weight_monthly_Goods_ONLY$CP0122["2017/"][i]
  }
}



for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0211["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0211["2017/"][i]<-weight_monthly_Goods_ONLY$CP0211["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0211["2017/"][i]<-weight_monthly_Goods_ONLY$CP0211["2017/"][i]
  }
}





for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0212["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0212["2017/"][i]<-weight_monthly_Goods_ONLY$CP0212["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0212["2017/"][i]<-weight_monthly_Goods_ONLY$CP0212["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0213["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0213["2017/"][i]<-weight_monthly_Goods_ONLY$CP0213["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0213["2017/"][i]<-weight_monthly_Goods_ONLY$CP0213["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0220["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0220["2017/"][i]<-weight_monthly_Goods_ONLY$CP0220["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0220["2017/"][i]<-weight_monthly_Goods_ONLY$CP0220["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0311["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0311["2017/"][i]<-weight_monthly_Goods_ONLY$CP0311["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0311["2017/"][i]<-weight_monthly_Goods_ONLY$CP0311["2017/"][i]
  }
}





for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0312["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0312["2017/"][i]<-weight_monthly_Goods_ONLY$CP0312["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0312["2017/"][i]<-weight_monthly_Goods_ONLY$CP0312["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0313["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0313["2017/"][i]<-weight_monthly_Goods_ONLY$CP0313["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0313["2017/"][i]<-weight_monthly_Goods_ONLY$CP0313["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0113_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP032["2017/"][i])){
    weight_monthly_Goods_ONLY$CP032["2017/"][i]<-weight_monthly_Goods_ONLY$CP032["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP032["2017/"][i]<-weight_monthly_Goods_ONLY$CP032["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0431["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0431["2017/"][i]<-weight_monthly_Goods_ONLY$CP0431["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0431["2017/"][i]<-weight_monthly_Goods_ONLY$CP0431["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0441["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0441["2017/"][i]<-weight_monthly_Goods_ONLY$CP0441["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0441["2017/"][i]<-weight_monthly_Goods_ONLY$CP0441["2017/"][i]
  }
}











for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0451["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0451["2017/"][i]<-weight_monthly_Goods_ONLY$CP0451["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0451["2017/"][i]<-weight_monthly_Goods_ONLY$CP0451["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0452["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0452["2017/"][i]<-weight_monthly_Goods_ONLY$CP0452["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0452["2017/"][i]<-weight_monthly_Goods_ONLY$CP0452["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0453["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0453["2017/"][i]<-weight_monthly_Goods_ONLY$CP0453["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0453["2017/"][i]<-weight_monthly_Goods_ONLY$CP0453["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0454["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0454["2017/"][i]<-weight_monthly_Goods_ONLY$CP0454["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0454["2017/"][i]<-weight_monthly_Goods_ONLY$CP0454["2017/"][i]
  }
}



for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0455["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0455["2017/"][i]<-weight_monthly_Goods_ONLY$CP0455["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0455["2017/"][i]<-weight_monthly_Goods_ONLY$CP0455["2017/"][i]
  }
}








for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0511["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0511["2017/"][i]<-weight_monthly_Goods_ONLY$CP0511["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0511["2017/"][i]<-weight_monthly_Goods_ONLY$CP0511["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0512["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0512["2017/"][i]<-weight_monthly_Goods_ONLY$CP0512["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0512["2017/"][i]<-weight_monthly_Goods_ONLY$CP0512["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0520["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0520["2017/"][i]<-weight_monthly_Goods_ONLY$CP0520["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0520["2017/"][i]<-weight_monthly_Goods_ONLY$CP0520["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0531_2["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0531_2["2017/"][i]<-weight_monthly_Goods_ONLY$CP0531_2["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0531_2["2017/"][i]<-weight_monthly_Goods_ONLY$CP0531_2["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0540["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0540["2017/"][i]<-weight_monthly_Goods_ONLY$CP0540["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0540["2017/"][i]<-weight_monthly_Goods_ONLY$CP0540["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP055["2017/"][i])){
    weight_monthly_Goods_ONLY$CP055["2017/"][i]<-weight_monthly_Goods_ONLY$CP055["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP055["2017/"][i]<-weight_monthly_Goods_ONLY$CP055["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0561["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0561["2017/"][i]<-weight_monthly_Goods_ONLY$CP0561["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0561["2017/"][i]<-weight_monthly_Goods_ONLY$CP0561["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0611["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0611["2017/"][i]<-weight_monthly_Goods_ONLY$CP0611["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0611["2017/"][i]<-weight_monthly_Goods_ONLY$CP0611["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0612_3["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0612_3["2017/"][i]<-weight_monthly_Goods_ONLY$CP0612_3["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0612_3["2017/"][i]<-weight_monthly_Goods_ONLY$CP0612_3["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0711["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0711["2017/"][i]<-weight_monthly_Goods_ONLY$CP0711["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0711["2017/"][i]<-weight_monthly_Goods_ONLY$CP0711["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0712_3_4["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0712_3_4["2017/"][i]<-weight_monthly_Goods_ONLY$CP0712_3_4["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0712_3_4["2017/"][i]<-weight_monthly_Goods_ONLY$CP0712_3_4["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0721["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0721["2017/"][i]<-weight_monthly_Goods_ONLY$CP0721["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0721["2017/"][i]<-weight_monthly_Goods_ONLY$CP0721["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0722["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0722["2017/"][i]<-weight_monthly_Goods_ONLY$CP0722["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0722["2017/"][i]<-weight_monthly_Goods_ONLY$CP0722["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0911["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0911["2017/"][i]<-weight_monthly_Goods_ONLY$CP0911["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0911["2017/"][i]<-weight_monthly_Goods_ONLY$CP0911["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0912["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0912["2017/"][i]<-weight_monthly_Goods_ONLY$CP0912["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0912["2017/"][i]<-weight_monthly_Goods_ONLY$CP0912["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0913["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0913["2017/"][i]<-weight_monthly_Goods_ONLY$CP0913["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0913["2017/"][i]<-weight_monthly_Goods_ONLY$CP0913["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0914["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0914["2017/"][i]<-weight_monthly_Goods_ONLY$CP0914["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0914["2017/"][i]<-weight_monthly_Goods_ONLY$CP0914["2017/"][i]
  }
}



for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0921_2["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0921_2["2017/"][i]<-weight_monthly_Goods_ONLY$CP0921_2["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0921_2["2017/"][i]<-weight_monthly_Goods_ONLY$CP0921_2["2017/"][i]
  }
}



for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0931["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0931["2017/"][i]<-weight_monthly_Goods_ONLY$CP0931["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0931["2017/"][i]<-weight_monthly_Goods_ONLY$CP0931["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0932["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0932["2017/"][i]<-weight_monthly_Goods_ONLY$CP0932["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0932["2017/"][i]<-weight_monthly_Goods_ONLY$CP0932["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0933["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0933["2017/"][i]<-weight_monthly_Goods_ONLY$CP0933["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0933["2017/"][i]<-weight_monthly_Goods_ONLY$CP0933["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0934_5["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0934_5["2017/"][i]<-weight_monthly_Goods_ONLY$CP0934_5["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0934_5["2017/"][i]<-weight_monthly_Goods_ONLY$CP0934_5["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0951["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0951["2017/"][i]<-weight_monthly_Goods_ONLY$CP0951["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0951["2017/"][i]<-weight_monthly_Goods_ONLY$CP0951["2017/"][i]
  }
}

for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0952["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0952["2017/"][i]<-weight_monthly_Goods_ONLY$CP0952["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0952["2017/"][i]<-weight_monthly_Goods_ONLY$CP0952["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP0953_4["2017/"][i])){
    weight_monthly_Goods_ONLY$CP0953_4["2017/"][i]<-weight_monthly_Goods_ONLY$CP0953_4["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP0953_4["2017/"][i]<-weight_monthly_Goods_ONLY$CP0953_4["2017/"][i]
  }
}


for (i in 1:length(weight_monthly_Goods_ONLY$CP1212_3["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP1212_3["2017/"][i])){
    weight_monthly_Goods_ONLY$CP1212_3["2017/"][i]<-weight_monthly_Goods_ONLY$CP1212_3["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP1212_3["2017/"][i]<-weight_monthly_Goods_ONLY$CP1212_3["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP1231["2017/"][i])){
    weight_monthly_Goods_ONLY$CP1231["2017/"][i]<-weight_monthly_Goods_ONLY$CP1231["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP1231["2017/"][i]<-weight_monthly_Goods_ONLY$CP1231["2017/"][i]
  }
}


for (i in 1:length(Goods_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Goods_ONLY$CP1232["2017/"][i])){
    weight_monthly_Goods_ONLY$CP1232["2017/"][i]<-weight_monthly_Goods_ONLY$CP1232["2017/"][i-1]
  } else {
    weight_monthly_Goods_ONLY$CP1232["2017/"][i]<-weight_monthly_Goods_ONLY$CP1232["2017/"][i]
  }
}


weight_monthly_Goods_ONLY<-(weight_monthly_Goods_ONLY)










#update the below code to reflect goods instead of services 
CONTR_GOODS_CP0111<-Chainlinking(Goods_INDEX$CP0111_INDEX)*	weight_monthly_Goods_ONLY$CP0111
CONTR_GOODS_CP0112<-Chainlinking(Goods_INDEX$CP0112_INDEX)*	weight_monthly_Goods_ONLY$CP0112
CONTR_GOODS_CP0113<-Chainlinking(Goods_INDEX$CP0113_INDEX)*	weight_monthly_Goods_ONLY$CP0113
CONTR_GOODS_CP0114<-Chainlinking(Goods_INDEX$CP0114_INDEX)*	weight_monthly_Goods_ONLY$CP0114
CONTR_GOODS_CP0115<-Chainlinking(Goods_INDEX$CP0115_INDEX)*	weight_monthly_Goods_ONLY$CP0115
CONTR_GOODS_CP0116<-Chainlinking(Goods_INDEX$CP0116_INDEX)*	weight_monthly_Goods_ONLY$CP0116
CONTR_GOODS_CP0117<-Chainlinking(Goods_INDEX$CP0117_INDEX)*	weight_monthly_Goods_ONLY$CP0117
CONTR_GOODS_CP0118<-Chainlinking(Goods_INDEX$CP0118_INDEX)*	weight_monthly_Goods_ONLY$CP0118
CONTR_GOODS_CP0119<-Chainlinking(Goods_INDEX$CP0119_INDEX)*	weight_monthly_Goods_ONLY$CP0119
CONTR_GOODS_CP0121<-Chainlinking(Goods_INDEX$CP0121_INDEX)*	weight_monthly_Goods_ONLY$CP0121
CONTR_GOODS_CP0122<-Chainlinking(Goods_INDEX$CP0122_INDEX)*	weight_monthly_Goods_ONLY$CP0122
CONTR_GOODS_CP0211<-Chainlinking(Goods_INDEX$CP0211_INDEX)*	weight_monthly_Goods_ONLY$CP0211
CONTR_GOODS_CP0212<-Chainlinking(Goods_INDEX$CP0212_INDEX)*	weight_monthly_Goods_ONLY$CP0212
CONTR_GOODS_CP0213<-Chainlinking(Goods_INDEX$CP0213_INDEX)*	weight_monthly_Goods_ONLY$CP0213
CONTR_GOODS_CP0220<-Chainlinking(Goods_INDEX$CP0220_INDEX)*	weight_monthly_Goods_ONLY$CP0220
CONTR_GOODS_CP0311<-Chainlinking(Goods_INDEX$CP0311_INDEX)*	weight_monthly_Goods_ONLY$CP0311
CONTR_GOODS_CP0312<-Chainlinking(Goods_INDEX$CP0312_INDEX)*	weight_monthly_Goods_ONLY$CP0312
CONTR_GOODS_CP0313<-Chainlinking(Goods_INDEX$CP0313_INDEX)*	weight_monthly_Goods_ONLY$CP0313
CONTR_GOODS_CP032<-Chainlinking(Goods_INDEX$CP032_INDEX)*	weight_monthly_Goods_ONLY$CP032
CONTR_GOODS_CP0431<-Chainlinking(Goods_INDEX$CP0431_INDEX)*	weight_monthly_Goods_ONLY$CP0431
CONTR_GOODS_CP0441<-Chainlinking(Goods_INDEX$CP0441_INDEX)*	weight_monthly_Goods_ONLY$CP0441
CONTR_GOODS_CP0451<-Chainlinking(Goods_INDEX$CP0451_INDEX)*	weight_monthly_Goods_ONLY$CP0451
CONTR_GOODS_CP0452<-Chainlinking(Goods_INDEX$CP0452_INDEX)*	weight_monthly_Goods_ONLY$CP0452
CONTR_GOODS_CP0453<-Chainlinking(Goods_INDEX$CP0453_INDEX)*	weight_monthly_Goods_ONLY$CP0453
CONTR_GOODS_CP0454<-Chainlinking(Goods_INDEX$CP0454_INDEX)*	weight_monthly_Goods_ONLY$CP0454
CONTR_GOODS_CP0455<-Chainlinking(Goods_INDEX$CP0455_INDEX)*	weight_monthly_Goods_ONLY$CP0455
CONTR_GOODS_CP0511<-Chainlinking(Goods_INDEX$CP0511_INDEX)*	weight_monthly_Goods_ONLY$CP0511
CONTR_GOODS_CP0512<-Chainlinking(Goods_INDEX$CP0512_INDEX)*	weight_monthly_Goods_ONLY$CP0512
CONTR_GOODS_CP0520<-Chainlinking(Goods_INDEX$CP0520_INDEX)*	weight_monthly_Goods_ONLY$CP0520
CONTR_GOODS_CP0531_2<-Chainlinking(Goods_INDEX$CP0531_2_INDEX)*	weight_monthly_Goods_ONLY$CP0531_2
CONTR_GOODS_CP0540<-Chainlinking(Goods_INDEX$CP0540_INDEX)*	weight_monthly_Goods_ONLY$CP0540
CONTR_GOODS_CP055<-Chainlinking(Goods_INDEX$CP055_INDEX)*	weight_monthly_Goods_ONLY$CP055
CONTR_GOODS_CP0561<-Chainlinking(Goods_INDEX$CP0561_INDEX)*	weight_monthly_Goods_ONLY$CP0561
CONTR_GOODS_CP0611<-Chainlinking(Goods_INDEX$CP0611_INDEX)*	weight_monthly_Goods_ONLY$CP0611
CONTR_GOODS_CP0612_3<-Chainlinking(Goods_INDEX$CP0612_3_INDEX)*	weight_monthly_Goods_ONLY$CP0612_3
CONTR_GOODS_CP0711<-Chainlinking(Goods_INDEX$CP0711_INDEX)*	weight_monthly_Goods_ONLY$CP0711
CONTR_GOODS_CP0712_3_4<-Chainlinking(Goods_INDEX$CP0712_3_4_INDEX)*	weight_monthly_Goods_ONLY$CP0712_3_4
CONTR_GOODS_CP07721<-Chainlinking(Goods_INDEX$CP0721_INDEX)*	weight_monthly_Goods_ONLY$CP0721
CONTR_GOODS_CP0911<-Chainlinking(Goods_INDEX$CP0911_INDEX)*	weight_monthly_Goods_ONLY$CP0911
CONTR_GOODS_CP0912<-Chainlinking(Goods_INDEX$CP0912_INDEX)*	weight_monthly_Goods_ONLY$CP0912
CONTR_GOODS_CP0913<-Chainlinking(Goods_INDEX$CP0913_INDEX)*	weight_monthly_Goods_ONLY$CP0913
CONTR_GOODS_CP0914<-Chainlinking(Goods_INDEX$CP0914_INDEX)*	weight_monthly_Goods_ONLY$CP0914
CONTR_GOODS_CP0921_2<-Chainlinking(Goods_INDEX$CP0921_2_INDEX)*	weight_monthly_Goods_ONLY$CP0921_2
CONTR_GOODS_CP0931<-Chainlinking(Goods_INDEX$CP0931_INDEX)*	weight_monthly_Goods_ONLY$CP0931
CONTR_GOODS_CP0932<-Chainlinking(Goods_INDEX$CP0932_INDEX)*	weight_monthly_Goods_ONLY$CP0932
CONTR_GOODS_CP0933<-Chainlinking(Goods_INDEX$CP0933_INDEX)*	weight_monthly_Goods_ONLY$CP0933
CONTR_GOODS_CP0934_5<-Chainlinking(Goods_INDEX$CP0934_5_INDEX)*	weight_monthly_Goods_ONLY$CP0934_5
CONTR_GOODS_CP0951<-Chainlinking(Goods_INDEX$CP0951_INDEX)*	weight_monthly_Goods_ONLY$CP0951
CONTR_GOODS_CP0952<-Chainlinking(Goods_INDEX$CP0952_INDEX)*	weight_monthly_Goods_ONLY$CP0952
CONTR_GOODS_CP0953_4<-Chainlinking(Goods_INDEX$CP0953_4_INDEX)*	weight_monthly_Goods_ONLY$CP0953_4
CONTR_GOODS_CP1212_3<-Chainlinking(Goods_INDEX$CP1212_3_INDEX)*	weight_monthly_Goods_ONLY$CP1212_3
CONTR_GOODS_CP1231<-Chainlinking(Goods_INDEX$CP1231_INDEX)*	weight_monthly_Goods_ONLY$CP1231
CONTR_GOODS_CP1232<-Chainlinking(Goods_INDEX$CP1232_INDEX)*	weight_monthly_Goods_ONLY$CP1232
















CONTR_GOODS<-merge(CONTR_GOODS_CP0111,
CONTR_GOODS_CP0112,
CONTR_GOODS_CP0113,
CONTR_GOODS_CP0114,
CONTR_GOODS_CP0115,
CONTR_GOODS_CP0116,
CONTR_GOODS_CP0117,
CONTR_GOODS_CP0118,
CONTR_GOODS_CP0119,
CONTR_GOODS_CP0121,
CONTR_GOODS_CP0122,
CONTR_GOODS_CP0211,
CONTR_GOODS_CP0212,
CONTR_GOODS_CP0213,
CONTR_GOODS_CP0220,
CONTR_GOODS_CP0311,
CONTR_GOODS_CP0312,
CONTR_GOODS_CP0313,
CONTR_GOODS_CP032,
CONTR_GOODS_CP0431,
CONTR_GOODS_CP0441,
CONTR_GOODS_CP0451,
CONTR_GOODS_CP0452,
CONTR_GOODS_CP0453,
CONTR_GOODS_CP0454,
CONTR_GOODS_CP0455,
CONTR_GOODS_CP0511,
CONTR_GOODS_CP0512,
CONTR_GOODS_CP0520,
CONTR_GOODS_CP0531_2,
CONTR_GOODS_CP0540,
CONTR_GOODS_CP055,
CONTR_GOODS_CP0561,
CONTR_GOODS_CP0611,
CONTR_GOODS_CP0612_3,
CONTR_GOODS_CP0711,
CONTR_GOODS_CP0712_3_4,
CONTR_GOODS_CP07721,
CONTR_GOODS_CP0911,
CONTR_GOODS_CP0912,
CONTR_GOODS_CP0913,
CONTR_GOODS_CP0914,
CONTR_GOODS_CP0921_2,
CONTR_GOODS_CP0931,
CONTR_GOODS_CP0932,
CONTR_GOODS_CP0933,
CONTR_GOODS_CP0934_5,
CONTR_GOODS_CP0951,
CONTR_GOODS_CP0952,
CONTR_GOODS_CP0953_4,
CONTR_GOODS_CP1212_3,
CONTR_GOODS_CP1231,
CONTR_GOODS_CP1232
)





CONTR_GOODS_sum<-data.frame(NA, nrow=length(index(CONTR_GOODS["2017/"])))

for (i in 1:length(index(CONTR_GOODS["2017/"]))) {
  CONTR_GOODS_sum[i]<-sum(as.numeric(CONTR_GOODS[i]),na.rm = TRUE)
}


TOTAL_CONTR_GOODS_sum<-as.xts(t(CONTR_GOODS_sum), order.by = index(CONTR_GOODS))
colnames(TOTAL_CONTR_GOODS_sum)<-c("TOTAL")





DEC_BASE_GOODS_CONTRIBUTION<-(as.numeric(TOTAL_CONTR_GOODS_sum[paste0(year(TOTAL_CONTR_GOODS_sum["2016/"]), "-12-01")])) 
DEC_BASE_GOODS_CONTRIBUTION<-TOTAL_CONTR_GOODS_sum/DEC_BASE_GOODS_CONTRIBUTION[1:length(TOTAL_CONTR_GOODS_sum)]


GOODS_INDEX_source<-rdb("Eurostat/prc_hicp_midx/M.I15.GD.IE") %>% .$value %>% as.numeric()
GOODS_INDEX_source_DATE<-rdb("Eurostat/prc_hicp_midx/M.I15.GD.IE") %>% .$period %>% as.Date()

GOODS_INDEX_XTS<-as.xts(GOODS_INDEX_source,order.by=GOODS_INDEX_source_DATE)


DEC_BASE_GOODS<-data.frame(NA, nrow=length(index(TOTAL_CONTR_GOODS_sum["2017/"])))
DEC_BASE_GOODS<-(as.numeric(GOODS_INDEX_XTS[paste0(year(GOODS_INDEX_XTS["2016/"]), "-12-01")])) 
DEC_BASE_GOODS[1:length(GOODS_INDEX_XTS["2017/"])]


overall_GOODS_index<-(TOTAL_CONTR_GOODS_sum)*DEC_BASE_GOODS[1:length(GOODS_INDEX_XTS["2017/"])] 





#processed food XTS

CP0111_XTS<-	as.xts(CP0111_WEIGHT	,order.by=CP0111_WEIGHT_Date)
CP0114_XTS<-	as.xts(CP0114_WEIGHT	,order.by=CP0114_WEIGHT_Date)
CP0115_XTS<-	as.xts(CP0115_WEIGHT	,order.by=CP0115_WEIGHT_Date)
CP0118_XTS<-	as.xts(CP0118_WEIGHT	,order.by=CP0118_WEIGHT_Date)
CP0119_XTS<-	as.xts(CP0119_WEIGHT	,order.by=CP0119_WEIGHT_Date)
CP0121_XTS<-	as.xts(CP0121_WEIGHT	,order.by=CP0121_WEIGHT_Date)
CP0122_XTS<-	as.xts(CP0122_WEIGHT	,order.by=CP0122_WEIGHT_Date)
CP0211_XTS<-	as.xts(CP0211_WEIGHT	,order.by=CP0211_WEIGHT_Date)
CP0212_XTS<-	as.xts(CP0212_WEIGHT	,order.by=CP0212_WEIGHT_Date)
CP0213_XTS<-	as.xts(CP0213_WEIGHT	,order.by=CP0213_WEIGHT_Date)
CP0220_XTS<-	as.xts(CP0220_WEIGHT	,order.by=CP0220_WEIGHT_Date)




#unprocessed food XTS
CP0112_XTS<-	as.xts(CP0112_WEIGHT	,order.by=CP0112_WEIGHT_Date)
CP0113_XTS<-	as.xts(CP0113_WEIGHT	,order.by=CP0113_WEIGHT_Date)
CP0116_XTS<-	as.xts(CP0116_WEIGHT	,order.by=CP0116_WEIGHT_Date)
CP0117_XTS<-	as.xts(CP0117_WEIGHT	,order.by=CP0117_WEIGHT_Date)


#Services XTS 
CP0111_XTS<-	as.xts(CP0111_WEIGHT	,order.by=CP0111_WEIGHT_Date)
CP0112_XTS<-	as.xts(CP0112_WEIGHT	,order.by=CP0112_WEIGHT_Date)
CP0113_XTS<-	as.xts(CP0113_WEIGHT	,order.by=CP0113_WEIGHT_Date)
CP0114_XTS<-	as.xts(CP0114_WEIGHT	,order.by=CP0114_WEIGHT_Date)
CP0115_XTS<-	as.xts(CP0115_WEIGHT	,order.by=CP0115_WEIGHT_Date)
CP0116_XTS<-	as.xts(CP0116_WEIGHT	,order.by=CP0116_WEIGHT_Date)
CP0117_XTS<-	as.xts(CP0117_WEIGHT	,order.by=CP0117_WEIGHT_Date)
CP0118_XTS<-	as.xts(CP0118_WEIGHT	,order.by=CP0118_WEIGHT_Date)
CP0119_XTS<-	as.xts(CP0119_WEIGHT	,order.by=CP0119_WEIGHT_Date)
CP0121_XTS<-	as.xts(CP0121_WEIGHT	,order.by=CP0121_WEIGHT_Date)
CP0122_XTS<-	as.xts(CP0122_WEIGHT	,order.by=CP0122_WEIGHT_Date)
CP0211_XTS<-	as.xts(CP0211_WEIGHT	,order.by=CP0211_WEIGHT_Date)
CP0212_XTS<-	as.xts(CP0212_WEIGHT	,order.by=CP0212_WEIGHT_Date)
CP0213_XTS<-	as.xts(CP0213_WEIGHT	,order.by=CP0213_WEIGHT_Date)
CP022_XTS<-	as.xts(CP022_WEIGHT	,order.by=CP022_WEIGHT_Date)
CP0311_XTS<-	as.xts(CP0311_WEIGHT	,order.by=CP0311_WEIGHT_Date)
CP0312_XTS<-	as.xts(CP0312_WEIGHT	,order.by=CP0312_WEIGHT_Date)
CP0313_XTS<-	as.xts(CP0313_WEIGHT	,order.by=CP0313_WEIGHT_Date)
CP0314_XTS<-	as.xts(CP0314_WEIGHT	,order.by=CP0314_WEIGHT_Date)
CP0321_XTS<-	as.xts(CP0321_WEIGHT	,order.by=CP0321_WEIGHT_Date)
CP0322_XTS<-	as.xts(CP0322_WEIGHT	,order.by=CP0322_WEIGHT_Date)
CP0411_XTS<-	as.xts(CP0411_WEIGHT	,order.by=CP0411_WEIGHT_Date)
CP0431_XTS<-	as.xts(CP0431_WEIGHT	,order.by=CP0431_WEIGHT_Date)
CP0432_XTS<-	as.xts(CP0432_WEIGHT	,order.by=CP0432_WEIGHT_Date)
CP0441_XTS<-	as.xts(CP0441_WEIGHT	,order.by=CP0441_WEIGHT_Date)
CP0442_XTS<-	as.xts(CP0442_WEIGHT	,order.by=CP0442_WEIGHT_Date)
CP0443_XTS<-	as.xts(CP0443_WEIGHT	,order.by=CP0443_WEIGHT_Date)
CP0444_XTS<-	as.xts(CP0444_WEIGHT	,order.by=CP0444_WEIGHT_Date)
CP0451_XTS<-	as.xts(CP0451_WEIGHT	,order.by=CP0451_WEIGHT_Date)
CP0452_XTS<-	as.xts(CP0452_WEIGHT	,order.by=CP0452_WEIGHT_Date)
CP0453_XTS<-	as.xts(CP0453_WEIGHT	,order.by=CP0453_WEIGHT_Date)
CP0454_XTS<-	as.xts(CP0454_WEIGHT	,order.by=CP0454_WEIGHT_Date)
CP0511_XTS<-	as.xts(CP0511_WEIGHT	,order.by=CP0511_WEIGHT_Date)
CP0512_XTS<-	as.xts(CP0512_WEIGHT	,order.by=CP0512_WEIGHT_Date)
CP052_XTS<-	as.xts(CP052_WEIGHT	,order.by=CP052_WEIGHT_Date)
CP0531_XTS<-	as.xts(CP0531_WEIGHT	,order.by=CP0531_WEIGHT_Date)
CP0532_XTS<-	as.xts(CP0532_WEIGHT	,order.by=CP0532_WEIGHT_Date)
CP0533_XTS<-	as.xts(CP0533_WEIGHT	,order.by=CP0533_WEIGHT_Date)
CP54_XTS<-	as.xts(CP54_WEIGHT	,order.by=CP54_WEIGHT_Date)
CP0551_XTS<-	as.xts(CP0551_WEIGHT	,order.by=CP0551_WEIGHT_Date)
CP0552_XTS<-	as.xts(CP0552_WEIGHT	,order.by=CP0552_WEIGHT_Date)
CP0561_XTS<-	as.xts(CP0561_WEIGHT	,order.by=CP0561_WEIGHT_Date)
CP0562_XTS<-	as.xts(CP0562_WEIGHT	,order.by=CP0562_WEIGHT_Date)
CP0611_XTS<-	as.xts(CP0611_WEIGHT	,order.by=CP0611_WEIGHT_Date)
CP0612_XTS<-	as.xts(CP0612_WEIGHT	,order.by=CP0612_WEIGHT_Date)
CP0613_XTS<-	as.xts(CP0613_WEIGHT	,order.by=CP0613_WEIGHT_Date)
CP0621_XTS<-	as.xts(CP0621_WEIGHT	,order.by=CP0621_WEIGHT_Date)
CP0622_XTS<-	as.xts(CP0622_WEIGHT	,order.by=CP0622_WEIGHT_Date)
CP0623_XTS<-	as.xts(CP0623_WEIGHT	,order.by=CP0623_WEIGHT_Date)
CP063_XTS<-	as.xts(CP063_WEIGHT	,order.by=CP063_WEIGHT_Date)
CP0711_XTS<-	as.xts(CP0711_WEIGHT	,order.by=CP0711_WEIGHT_Date)
CP0712_XTS<-	as.xts(CP0712_WEIGHT	,order.by=CP0712_WEIGHT_Date)
CP0713_XTS<-	as.xts(CP0713_WEIGHT	,order.by=CP0713_WEIGHT_Date)
CP0721_XTS<-	as.xts(CP0721_WEIGHT	,order.by=CP0721_WEIGHT_Date)
CP0722_XTS<-	as.xts(CP0722_WEIGHT	,order.by=CP0722_WEIGHT_Date)
CP0723_XTS<-	as.xts(CP0723_WEIGHT	,order.by=CP0723_WEIGHT_Date)
CP0724_XTS<-	as.xts(CP0724_WEIGHT	,order.by=CP0724_WEIGHT_Date)
CP0731_XTS<-	as.xts(CP0731_WEIGHT	,order.by=CP0731_WEIGHT_Date)
CP0732_XTS<-	as.xts(CP0732_WEIGHT	,order.by=CP0732_WEIGHT_Date)
CP0733_XTS<-	as.xts(CP0733_WEIGHT	,order.by=CP0733_WEIGHT_Date)
CP0734_XTS<-	as.xts(CP0734_WEIGHT	,order.by=CP0734_WEIGHT_Date)
CP0735_XTS<-	as.xts(CP0735_WEIGHT	,order.by=CP0735_WEIGHT_Date)
CP0736_XTS<-	as.xts(CP0736_WEIGHT	,order.by=CP0736_WEIGHT_Date)
CP081_XTS<-	as.xts(CP081_WEIGHT	,order.by=CP081_WEIGHT_Date)
CP082_3_XTS<-	as.xts(CP082_3_WEIGHT	,order.by=CP082_3_WEIGHT_Date)


CP0820_XTS<-	as.xts(CP0820_WEIGHT	,order.by=CP0820_WEIGHT_Date)
CP0830_XTS<-	as.xts(CP0830_WEIGHT	,order.by=CP0830_WEIGHT_Date)
CP0911_XTS<-	as.xts(CP0911_WEIGHT	,order.by=CP0911_WEIGHT_Date)
CP0912_XTS<-	as.xts(CP0912_WEIGHT	,order.by=CP0912_WEIGHT_Date)
CP0913_XTS<-	as.xts(CP0913_WEIGHT	,order.by=CP0913_WEIGHT_Date)
CP0914_XTS<-	as.xts(CP0914_WEIGHT	,order.by=CP0914_WEIGHT_Date)
CP0915_XTS<-	as.xts(CP0915_WEIGHT	,order.by=CP0915_WEIGHT_Date)
CP0921_XTS<-	as.xts(CP0921_WEIGHT	,order.by=CP0921_WEIGHT_Date)
CP0922_XTS<-	as.xts(CP0922_WEIGHT	,order.by=CP0922_WEIGHT_Date)
CP0931_XTS<-	as.xts(CP0931_WEIGHT	,order.by=CP0931_WEIGHT_Date)
CP0932_XTS<-	as.xts(CP0932_WEIGHT	,order.by=CP0932_WEIGHT_Date)
CP0933_XTS<-	as.xts(CP0933_WEIGHT	,order.by=CP0933_WEIGHT_Date)
CP0934_XTS<-	as.xts(CP0934_WEIGHT	,order.by=CP0934_WEIGHT_Date)
CP0935_XTS<-	as.xts(CP0935_WEIGHT	,order.by=CP0935_WEIGHT_Date)
CP0941_XTS<-	as.xts(CP0941_WEIGHT	,order.by=CP0941_WEIGHT_Date)
CP0942_XTS<-	as.xts(CP0942_WEIGHT	,order.by=CP0942_WEIGHT_Date)
CP0951_XTS<-	as.xts(CP0951_WEIGHT	,order.by=CP0951_WEIGHT_Date)
CP0952_XTS<-	as.xts(CP0952_WEIGHT	,order.by=CP0952_WEIGHT_Date)
CP0953_XTS<-	as.xts(CP0953_WEIGHT	,order.by=CP0953_WEIGHT_Date)
CP0954_XTS<-	as.xts(CP0954_WEIGHT	,order.by=CP0954_WEIGHT_Date)
CP096_XTS<-	  as.xts(CP096_WEIGHT	,order.by=CP096_WEIGHT_Date)
CP10_XTS<-	  as.xts(CP10_WEIGHT	,order.by=CP10_WEIGHT_Date)
CP1111_XTS<-	as.xts(CP1111_WEIGHT	,order.by=CP1111_WEIGHT_Date)
CP1112_XTS<-	as.xts(CP1112_WEIGHT	,order.by=CP1112_WEIGHT_Date)
CP112_XTS<-	  as.xts(CP112_WEIGHT	,order.by=CP112_WEIGHT_Date)
CP1211_XTS<-	as.xts(CP1211_WEIGHT	,order.by=CP1211_WEIGHT_Date)
CP1212_XTS<-	as.xts(CP1212_WEIGHT	,order.by=CP1212_WEIGHT_Date)
CP1213_XTS<-	as.xts(CP1213_WEIGHT	,order.by=CP1213_WEIGHT_Date)
CP1231_XTS<-	as.xts(CP1231_WEIGHT	,order.by=CP1231_WEIGHT_Date)
CP1232_XTS<-	as.xts(CP1232_WEIGHT	,order.by=CP1232_WEIGHT_Date)
CP124_XTS<-	  as.xts(CP124_WEIGHT	,order.by=CP124_WEIGHT_Date)
CP1252_XTS<-	as.xts(CP1252_WEIGHT	,order.by=CP1252_WEIGHT_Date)
CP1253_XTS<-	as.xts(CP1253_WEIGHT	,order.by=CP1253_WEIGHT_Date)
CP1254_XTS<-	as.xts(CP1254_WEIGHT	,order.by=CP1254_WEIGHT_Date)
CP126_XTS<-	  as.xts(CP126_WEIGHT	,order.by=CP126_WEIGHT_Date)
CP127_XTS<-	  as.xts(CP127_WEIGHT	,order.by=CP127_WEIGHT_Date)


OVERALL_SERVICES_XTS<-as.xts(OVERALL_SERVICES_WEIGHT	,order.by=OVERALL_SERVICES_WEIGHT_Date)
OVERALL_UNPROCESSED_FOOD_XTS<-as.xts(OVERALL_FOOD_NP_WEIGHT	,order.by=OVERALL_UNPROCESSED_FOOD_WEIGHT_Date) 
colnames(OVERALL_UNPROCESSED_FOOD_XTS)<-c("OVERALL")

XTS_WEIGHT<-merge(CP0111_XTS,CP0112_XTS,CP0113_XTS,CP0114_XTS,CP0115_XTS,CP0116_XTS,CP0117_XTS,CP0118_XTS,CP0119_XTS,CP0121_XTS,CP0122_XTS,CP0211_XTS,CP0212_XTS,CP0213_XTS,CP022_XTS,CP0311_XTS,CP0312_XTS,CP0313_XTS,CP0314_XTS,CP0321_XTS,CP0322_XTS,CP0411_XTS,CP0431_XTS,CP0432_XTS,CP0441_XTS,CP0442_XTS,
                  CP0443_XTS,
                  CP0444_XTS,
                  CP0451_XTS,
                  CP0452_XTS,
                  CP0453_XTS,
                  CP0454_XTS,
                  CP0511_XTS,
                  CP0512_XTS,
                  CP052_XTS,
                  CP0531_XTS,
                  CP0532_XTS,
                  CP0533_XTS,
                  CP0551_XTS,
                  CP0552_XTS,
                  CP0561_XTS,
                  CP0562_XTS,
                  CP0611_XTS,
                  CP0612_XTS,
                  CP0613_XTS,
                  CP0621_XTS,
                  CP0622_XTS,
                  CP0623_XTS,
                  CP063_XTS,
                  CP0711_XTS,
                  CP0712_XTS,
                  CP0713_XTS,
                  CP0721_XTS,
                  CP0722_XTS,
                  CP0723_XTS,
                  CP0724_XTS,
                  CP0731_XTS,
                  CP0732_XTS,
                  CP0733_XTS,
                  CP0734_XTS,
                  CP0735_XTS,
                  CP0736_XTS,
                  CP081_XTS,
                  CP082_3_XTS,
                  CP0911_XTS,
                  CP0912_XTS,
                  CP0913_XTS,
                  CP0914_XTS,
                  CP0915_XTS,
                  CP0921_XTS,
                  CP0922_XTS,
                  CP0931_XTS,
                  CP0932_XTS,
                  CP0933_XTS,
                  CP0934_XTS,
                  CP0935_XTS,
                  CP0941_XTS,
                  CP0942_XTS,
                  CP0951_XTS,
                  CP0952_XTS,
                  CP0953_XTS,
                  CP0954_XTS,
                  CP096_XTS,
                  CP10_XTS,
                  CP1111_XTS,
                  CP1112_XTS,
                  CP112_XTS,
                  CP1211_XTS,
                  CP1212_XTS,
                  CP1213_XTS,
                  CP1231_XTS,
                  CP1232_XTS,
                  CP124_XTS,
                  CP1252_XTS,
                  CP1253_XTS,
                  CP1254_XTS,
                  CP126_XTS,
                  CP127_XTS)


#TOTAL WEIGHTS CHECK 


TOTAL_sum_weight<-data.frame(NA, nrow=length(index(XTS_WEIGHT["1996/"])))

for (i in 1:length(index(XTS_WEIGHT["1996/"]))) {
  TOTAL_sum_weight[i]<-sum(as.numeric(XTS_WEIGHT[i]),na.rm = TRUE)
}


TOTAL_sum_weight<-as.xts(t(TOTAL_sum_weight), order.by = index(XTS_WEIGHT))
colnames(TOTAL_sum_weight)<-c("TOTAL")




#FOCUS ON SERVICES WEIGHT 

Services_weight<-merge(CP0411_XTS/1000,CP0432_XTS/1000,CP0442_XTS/1000,CP0443_XTS/1000,CP0444_XTS/1000,CP0533_XTS/1000,CP0562_XTS/1000,CP1252_XTS/1000,CP0314_XTS/1000,CP0915_XTS/1000,CP0941_XTS/1000,CP0942_XTS/1000,CP1111_XTS/1000,CP1112_XTS/1000,CP1211_XTS/1000,CP0723_XTS/1000,CP0724_XTS/1000,CP0731_XTS/1000,CP0732_XTS/1000,CP0733_XTS/1000,CP0734_XTS/1000,CP0735_XTS/1000,CP0736_XTS/1000,CP096_XTS/1000,CP112_XTS/1000,CP0621_XTS/1000,CP0622_XTS/1000,CP0623_XTS/1000,CP063_XTS/1000,CP10_XTS/1000,CP124_XTS/1000,CP1253_XTS/1000,CP1254_XTS/1000,CP126_XTS/1000,CP127_XTS/1000,CP081_XTS/1000,CP082_3_XTS/1000)


Services_sum_weight<-data.frame(NA, nrow=length(index(Services_weight["1996/"])))

for (i in 1:length(index(Services_weight["1996/"]))) {
  Services_sum_weight[i]<-sum(as.numeric(Services_weight[i]),na.rm = TRUE)
}


TOTAL_Services_sum_weight<-as.xts(t(Services_sum_weight), order.by = index(Services_weight))

colnames(TOTAL_Services_sum_weight)<-c("TOTAL")

OVERALL_SERVICES_XTS<-(OVERALL_SERVICES_XTS/1000)
colnames(OVERALL_SERVICES_XTS)<-c("TOTAL")

Services_weight_ONLY<-merge(((CP0411_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0432_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0442_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0443_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0444_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0533_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0562_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP1252_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0314_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0915_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0941_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0942_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP1111_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP1112_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP1211_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0723_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0724_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0731_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0732_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0733_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0734_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0735_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0736_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP096_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP112_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0621_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0622_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP0623_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP063_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP10_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP124_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP1253_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP1254_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP126_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP127_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP081_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL),((CP082_3_XTS/1000)/OVERALL_SERVICES_XTS$TOTAL))
Services_weight_ONLY_17<-Services_weight_ONLY["2017/"]

colnames(Services_weight_ONLY_17)<-c("CP0411","CP0432","CP0442","CP0443","CP0444","CP0533","CP0562","CP1252","CP0314","CP0915","CP0941","CP0942","CP1111","CP1112","CP1211","CP0723","CP0724","CP0731","CP0732","CP0733","CP0734","CP0735","CP0736","CP096","CP112","CP0621","CP0622","CP0623","CP063","CP10","CP124","CP1253","CP1254","CP126","CP127","CP081","CP082_3")

weight_monthly_Services_ONLY<-merge(Services_weight_ONLY_17,index(Services_INDEX["2017/"]))




for (i in 1:length(Services_INDEX$CP0411_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0411["2017/"][i])){
    weight_monthly_Services_ONLY$CP0411["2017/"][i]<-weight_monthly_Services_ONLY$CP0411["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0411["2017/"][i]<-weight_monthly_Services_ONLY$CP0411["2017/"][i]
  }
}



for (i in 1:length(Services_INDEX$CP0432_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0432["2017/"][i])){
    weight_monthly_Services_ONLY$CP0432["2017/"][i]<-weight_monthly_Services_ONLY$CP0432["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0432["2017/"][i]<-weight_monthly_Services_ONLY$CP0432["2017/"][i]
  }
}





for (i in 1:length(Services_INDEX$CP0442_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0442["2017/"][i])){
    weight_monthly_Services_ONLY$CP0442["2017/"][i]<-weight_monthly_Services_ONLY$CP0442["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0442["2017/"][i]<-weight_monthly_Services_ONLY$CP0442["2017/"][i]
  }
}





for (i in 1:length(Services_INDEX$CP0443_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0443["2017/"][i])){
    weight_monthly_Services_ONLY$CP0443["2017/"][i]<-weight_monthly_Services_ONLY$CP0443["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0443["2017/"][i]<-weight_monthly_Services_ONLY$CP0443["2017/"][i]
  }
}




for (i in 1:length(Services_INDEX$CP0444_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0444["2017/"][i])){
    weight_monthly_Services_ONLY$CP0444["2017/"][i]<-weight_monthly_Services_ONLY$CP0444["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0444["2017/"][i]<-weight_monthly_Services_ONLY$CP0444["2017/"][i]
  }
}





for (i in 1:length(Services_INDEX$CP0533_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0533["2017/"][i])){
    weight_monthly_Services_ONLY$CP0533["2017/"][i]<-weight_monthly_Services_ONLY$CP0533["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0533["2017/"][i]<-weight_monthly_Services_ONLY$CP0533["2017/"][i]
  }
}




for (i in 1:length(Services_INDEX$CP0562_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0562["2017/"][i])){
    weight_monthly_Services_ONLY$CP0562["2017/"][i]<-weight_monthly_Services_ONLY$CP0562["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0562["2017/"][i]<-weight_monthly_Services_ONLY$CP0562["2017/"][i]
  }
}


for (i in 1:length(Services_INDEX$CP1252_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP1252["2017/"][i])){
    weight_monthly_Services_ONLY$CP1252["2017/"][i]<-weight_monthly_Services_ONLY$CP1252["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP1252["2017/"][i]<-weight_monthly_Services_ONLY$CP1252["2017/"][i]
  }
}


for (i in 1:length(Services_INDEX$CP0314_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0314["2017/"][i])){
    weight_monthly_Services_ONLY$CP0314["2017/"][i]<-weight_monthly_Services_ONLY$CP0314["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0314["2017/"][i]<-weight_monthly_Services_ONLY$CP0314["2017/"][i]
  }
}


for (i in 1:length(Services_INDEX$CP0915_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0915["2017/"][i])){
    weight_monthly_Services_ONLY$CP0915["2017/"][i]<-weight_monthly_Services_ONLY$CP0915["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0915["2017/"][i]<-weight_monthly_Services_ONLY$CP0915["2017/"][i]
  }
}



for (i in 1:length(Services_INDEX$CP0941_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0941["2017/"][i])){
    weight_monthly_Services_ONLY$CP0941["2017/"][i]<-weight_monthly_Services_ONLY$CP0941["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0941["2017/"][i]<-weight_monthly_Services_ONLY$CP0941["2017/"][i]
  }
}




for (i in 1:length(Services_INDEX$CP0942_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0942["2017/"][i])){
    weight_monthly_Services_ONLY$CP0942["2017/"][i]<-weight_monthly_Services_ONLY$CP0942["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0942["2017/"][i]<-weight_monthly_Services_ONLY$CP0942["2017/"][i]
  }
}



for (i in 1:length(Services_INDEX$CP1111_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP1111["2017/"][i])){
    weight_monthly_Services_ONLY$CP1111["2017/"][i]<-weight_monthly_Services_ONLY$CP1111["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP1111["2017/"][i]<-weight_monthly_Services_ONLY$CP1111["2017/"][i]
  }
}




for (i in 1:length(Services_INDEX$CP1112_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP1112["2017/"][i])){
    weight_monthly_Services_ONLY$CP1112["2017/"][i]<-weight_monthly_Services_ONLY$CP1112["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP1112["2017/"][i]<-weight_monthly_Services_ONLY$CP1112["2017/"][i]
  }
}


for (i in 1:length(Services_INDEX$CP1211_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP1211["2017/"][i])){
    weight_monthly_Services_ONLY$CP1211["2017/"][i]<-weight_monthly_Services_ONLY$CP1211["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP1211["2017/"][i]<-weight_monthly_Services_ONLY$CP1211["2017/"][i]
  }
}


for (i in 1:length(Services_INDEX$CP0723_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0723["2017/"][i])){
    weight_monthly_Services_ONLY$CP0723["2017/"][i]<-weight_monthly_Services_ONLY$CP0723["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0723["2017/"][i]<-weight_monthly_Services_ONLY$CP0723["2017/"][i]
  }
}


for (i in 1:length(Services_INDEX$CP0724_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0724["2017/"][i])){
    weight_monthly_Services_ONLY$CP0724["2017/"][i]<-weight_monthly_Services_ONLY$CP0724["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0724["2017/"][i]<-weight_monthly_Services_ONLY$CP0724["2017/"][i]
  }
}


for (i in 1:length(Services_INDEX$CP0731_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0731["2017/"][i])){
    weight_monthly_Services_ONLY$CP0731["2017/"][i]<-weight_monthly_Services_ONLY$CP0731["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0731["2017/"][i]<-weight_monthly_Services_ONLY$CP0731["2017/"][i]
  }
}



for (i in 1:length(Services_INDEX$CP0732_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0732["2017/"][i])){
    weight_monthly_Services_ONLY$CP0732["2017/"][i]<-weight_monthly_Services_ONLY$CP0732["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0732["2017/"][i]<-weight_monthly_Services_ONLY$CP0732["2017/"][i]
  }
}



for (i in 1:length(Services_INDEX$CP0733_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0733["2017/"][i])){
    weight_monthly_Services_ONLY$CP0733["2017/"][i]<-weight_monthly_Services_ONLY$CP0733["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0733["2017/"][i]<-weight_monthly_Services_ONLY$CP0733["2017/"][i]
  }
}




for (i in 1:length(Services_INDEX$CP0734_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0734["2017/"][i])){
    weight_monthly_Services_ONLY$CP0734["2017/"][i]<-weight_monthly_Services_ONLY$CP0734["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0734["2017/"][i]<-weight_monthly_Services_ONLY$CP0734["2017/"][i]
  }
}

for (i in 1:length(Services_INDEX$CP0735_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0735["2017/"][i])){
    weight_monthly_Services_ONLY$CP0735["2017/"][i]<-weight_monthly_Services_ONLY$CP0735["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0735["2017/"][i]<-weight_monthly_Services_ONLY$CP0735["2017/"][i]
  }
}




for (i in 1:length(Services_INDEX$CP0736_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0736["2017/"][i])){
    weight_monthly_Services_ONLY$CP0736["2017/"][i]<-weight_monthly_Services_ONLY$CP0736["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0736["2017/"][i]<-weight_monthly_Services_ONLY$CP0736["2017/"][i]
  }
}




for (i in 1:length(Services_INDEX$CP096_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP096["2017/"][i])){
    weight_monthly_Services_ONLY$CP096["2017/"][i]<-weight_monthly_Services_ONLY$CP096["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP096["2017/"][i]<-weight_monthly_Services_ONLY$CP096["2017/"][i]
  }
}



for (i in 1:length(Services_INDEX$CP112_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP112["2017/"][i])){
    weight_monthly_Services_ONLY$CP112["2017/"][i]<-weight_monthly_Services_ONLY$CP112["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP112["2017/"][i]<-weight_monthly_Services_ONLY$CP112["2017/"][i]
  }
}




#weight fixed to match index below


weight_monthly_Services_ONLY$CP0621_3<-weight_monthly_Services_ONLY$CP0621+weight_monthly_Services_ONLY$CP0623

for (i in 1:length(Services_INDEX$CP0621_3_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0621_3["2017/"][i])){
    weight_monthly_Services_ONLY$CP0621_3["2017/"][i]<-weight_monthly_Services_ONLY$CP0621_3["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0621_3["2017/"][i]<-weight_monthly_Services_ONLY$CP0621_3["2017/"][i]
  }
}

#############################




for (i in 1:length(Services_INDEX$CP0622_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP0622["2017/"][i])){
    weight_monthly_Services_ONLY$CP0622["2017/"][i]<-weight_monthly_Services_ONLY$CP0622["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP0622["2017/"][i]<-weight_monthly_Services_ONLY$CP0622["2017/"][i]
  }
}



for (i in 1:length(Services_INDEX$CP063_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP063["2017/"][i])){
    weight_monthly_Services_ONLY$CP063["2017/"][i]<-weight_monthly_Services_ONLY$CP063["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP063["2017/"][i]<-weight_monthly_Services_ONLY$CP063["2017/"][i]
  }
}




for (i in 1:length(Services_INDEX$CP10_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP10["2017/"][i])){
    weight_monthly_Services_ONLY$CP10["2017/"][i]<-weight_monthly_Services_ONLY$CP10["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP10["2017/"][i]<-weight_monthly_Services_ONLY$CP10["2017/"][i]
  }
}





for (i in 1:length(Services_INDEX$CP124_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP124["2017/"][i])){
    weight_monthly_Services_ONLY$CP124["2017/"][i]<-weight_monthly_Services_ONLY$CP124["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP124["2017/"][i]<-weight_monthly_Services_ONLY$CP124["2017/"][i]
  }
}




for (i in 1:length(Services_INDEX$CP1253_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP1253["2017/"][i])){
    weight_monthly_Services_ONLY$CP1253["2017/"][i]<-weight_monthly_Services_ONLY$CP1253["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP1253["2017/"][i]<-weight_monthly_Services_ONLY$CP1253["2017/"][i]
  }
}





for (i in 1:length(Services_INDEX$CP1254_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP1254["2017/"][i])){
    weight_monthly_Services_ONLY$CP1254["2017/"][i]<-weight_monthly_Services_ONLY$CP1254["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP1254["2017/"][i]<-weight_monthly_Services_ONLY$CP1254["2017/"][i]
  }
}





for (i in 1:length(Services_INDEX$CP126_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP126["2017/"][i])){
    weight_monthly_Services_ONLY$CP126["2017/"][i]<-weight_monthly_Services_ONLY$CP126["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP126["2017/"][i]<-weight_monthly_Services_ONLY$CP126["2017/"][i]
  }
}







for (i in 1:length(Services_INDEX$CP127_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP127["2017/"][i])){
    weight_monthly_Services_ONLY$CP127["2017/"][i]<-weight_monthly_Services_ONLY$CP127["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP127["2017/"][i]<-weight_monthly_Services_ONLY$CP127["2017/"][i]
  }
}





for (i in 1:length(Services_INDEX$CP081_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP081["2017/"][i])){
    weight_monthly_Services_ONLY$CP081["2017/"][i]<-weight_monthly_Services_ONLY$CP081["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP081["2017/"][i]<-weight_monthly_Services_ONLY$CP081["2017/"][i]
  }
}







for (i in 1:length(Services_INDEX$CP082_3_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP082_3["2017/"][i])){
    weight_monthly_Services_ONLY$CP082_3["2017/"][i]<-weight_monthly_Services_ONLY$CP082_3["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP082_3["2017/"][i]<-weight_monthly_Services_ONLY$CP082_3["2017/"][i]
  }
}



#######


for (i in 1:length(Services_INDEX$CP082_3_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP082_3["2017/"][i])){
    weight_monthly_Services_ONLY$CP082_3["2017/"][i]<-weight_monthly_Services_ONLY$CP082_3["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP082_3["2017/"][i]<-weight_monthly_Services_ONLY$CP082_3["2017/"][i]
  }
}




weight_monthly_Services_adj<-weight_monthly_Services_ONLY  %>% data.frame() %>% select(-CP0621,-CP0623) %>% as.xts()

weight_monthly_Services_SUM<-data.frame(NA, nrow=length(index(weight_monthly_Services_adj["2017/"])))

for (i in 1:length(index(weight_monthly_Services_adj["2017/"]))) {
  weight_monthly_Services_SUM[i]<-sum(as.numeric(weight_monthly_Services_adj[i]),na.rm = TRUE)
}





CONTR_SER_CP0314<-Chainlinking(Services_INDEX$CP0314_INDEX)*	weight_monthly_Services_ONLY$CP0314
CONTR_SER_CP0411<-Chainlinking(Services_INDEX$CP0411_INDEX)*	weight_monthly_Services_ONLY$CP0411
CONTR_SER_CP0432<-Chainlinking(Services_INDEX$CP0432_INDEX)*	weight_monthly_Services_ONLY$CP0432
CONTR_SER_CP0442<-Chainlinking(Services_INDEX$CP0442_INDEX)*	weight_monthly_Services_ONLY$CP0442
CONTR_SER_CP0443<-Chainlinking(Services_INDEX$CP0443_INDEX)*	weight_monthly_Services_ONLY$CP0443
CONTR_SER_CP0444<-Chainlinking(Services_INDEX$CP0444_INDEX)*	weight_monthly_Services_ONLY$CP0444
CONTR_SER_CP0533<-Chainlinking(Services_INDEX$CP0533_INDEX)*	weight_monthly_Services_ONLY$CP0533
CONTR_SER_CP0562<-Chainlinking(Services_INDEX$CP0562_INDEX)*	weight_monthly_Services_ONLY$CP0562
CONTR_SER_CP0621_3<-Chainlinking(Services_INDEX$CP0621_3_INDEX)*	weight_monthly_Services_ONLY$CP0621_3
CONTR_SER_CP0622<-Chainlinking(Services_INDEX$CP0622_INDEX)*	weight_monthly_Services_ONLY$CP0622
CONTR_SER_CP063<-Chainlinking(Services_INDEX$CP063_INDEX)*	weight_monthly_Services_ONLY$CP063
CONTR_SER_CP01252<-Chainlinking(Services_INDEX$CP1252_INDEX)*	weight_monthly_Services_ONLY$CP1252
CONTR_SER_CP0915<-Chainlinking(Services_INDEX$CP0915_INDEX)*	weight_monthly_Services_ONLY$CP0915
CONTR_SER_CP0941<-Chainlinking(Services_INDEX$CP0941_INDEX)*	weight_monthly_Services_ONLY$CP0941
CONTR_SER_CP0942<-Chainlinking(Services_INDEX$CP0942_INDEX)*	weight_monthly_Services_ONLY$CP0942
CONTR_SER_CP1111<-Chainlinking(Services_INDEX$CP1111_INDEX)*	weight_monthly_Services_ONLY$CP1111
CONTR_SER_CP1112<-Chainlinking(Services_INDEX$CP1112_INDEX)*	weight_monthly_Services_ONLY$CP1112
CONTR_SER_CP1211<-Chainlinking(Services_INDEX$CP1211_INDEX)*	weight_monthly_Services_ONLY$CP1211
CONTR_SER_CP0723<-Chainlinking(Services_INDEX$CP0723_INDEX)*	weight_monthly_Services_ONLY$CP0723
CONTR_SER_CP0724<-Chainlinking(Services_INDEX$CP0724_INDEX)*	weight_monthly_Services_ONLY$CP0724
CONTR_SER_CP0731<-Chainlinking(Services_INDEX$CP0731_INDEX)*	weight_monthly_Services_ONLY$CP0731
CONTR_SER_CP0732<-Chainlinking(Services_INDEX$CP0732_INDEX)*	weight_monthly_Services_ONLY$CP0732
CONTR_SER_CP0733<-Chainlinking(Services_INDEX$CP0733_INDEX)*	weight_monthly_Services_ONLY$CP0733
CONTR_SER_CP0734<-Chainlinking(Services_INDEX$CP0734_INDEX)*	weight_monthly_Services_ONLY$CP0734
CONTR_SER_CP0735<-Chainlinking(Services_INDEX$CP0735_INDEX)*	weight_monthly_Services_ONLY$CP0735
CONTR_SER_CP0736<-Chainlinking(Services_INDEX$CP0736_INDEX)*	weight_monthly_Services_ONLY$CP0736
CONTR_SER_CP096<-Chainlinking(Services_INDEX$CP096_INDEX)*	weight_monthly_Services_ONLY$CP096
CONTR_SER_CP112<-Chainlinking(Services_INDEX$CP112_INDEX)*	weight_monthly_Services_ONLY$CP112
CONTR_SER_CP10<-Chainlinking(Services_INDEX$CP10_INDEX)*	weight_monthly_Services_ONLY$CP10
CONTR_SER_CP124<-Chainlinking(Services_INDEX$CP124_INDEX)*	weight_monthly_Services_ONLY$CP124
CONTR_SER_CP1253<-Chainlinking(Services_INDEX$CP1253_INDEX)*	weight_monthly_Services_ONLY$CP1253
CONTR_SER_CP1254<-Chainlinking(Services_INDEX$CP1254_INDEX)*	weight_monthly_Services_ONLY$CP1254
CONTR_SER_CP0126<-Chainlinking(Services_INDEX$CP126_INDEX)*	weight_monthly_Services_ONLY$CP126
CONTR_SER_CP127<-Chainlinking(Services_INDEX$CP127_INDEX)*	weight_monthly_Services_ONLY$CP127
CONTR_SER_CP081<-Chainlinking(Services_INDEX$CP081_INDEX)*	weight_monthly_Services_ONLY$CP081
CONTR_SER_CP082_3<-Chainlinking(Services_INDEX$CP082_3_INDEX)*	weight_monthly_Services_ONLY$CP082_3




CONTR_SER<-merge(CONTR_SER_CP0411
                 ,CONTR_SER_CP0432
                 ,CONTR_SER_CP0442
                 ,CONTR_SER_CP0443
                 ,CONTR_SER_CP0443
                 ,CONTR_SER_CP0533
                 ,CONTR_SER_CP0562
                 ,CONTR_SER_CP01252
                 ,CONTR_SER_CP0314
                 ,CONTR_SER_CP0915
                 ,CONTR_SER_CP0941
                 ,CONTR_SER_CP0942
                 ,CONTR_SER_CP1111
                 ,CONTR_SER_CP1112
                 ,CONTR_SER_CP1211
                 ,CONTR_SER_CP0723
                 ,CONTR_SER_CP0724
                 ,CONTR_SER_CP0731
                 ,CONTR_SER_CP0732
                 ,CONTR_SER_CP0733
                 ,CONTR_SER_CP0734
                 ,CONTR_SER_CP0735
                 ,CONTR_SER_CP0736
                 ,CONTR_SER_CP096
                 ,CONTR_SER_CP112
                 ,CONTR_SER_CP0621_3
                 ,CONTR_SER_CP0622
                 ,CONTR_SER_CP063
                 ,CONTR_SER_CP10
                 ,CONTR_SER_CP124
                 ,CONTR_SER_CP1253
                 ,CONTR_SER_CP1254
                 ,CONTR_SER_CP0126
                 ,CONTR_SER_CP127
                 ,CONTR_SER_CP081
                 ,CONTR_SER_CP082_3)


Index_names_services<-c("Actual Rent", "Repair of Dwelling","Refuse Collection","Sewerage Collection", "Other Services for Dwellings","Repair of Household Appliances", "Domestic Services and Household Services","Insurance for Dwellings","Cleaning & Repair Clothing","Repair of audio-visual","Recreational & Sporting Services","Cultural Services", "Restaurant, Cafes etc.","Canteens","Hairdressing Salons","Repair Personal Transport","Other services for Personal Transport","Passenger transport by railway","Passenger transport by road","Passenger transport by air","Passenger transport by sea","Combined Passenger transport","Other purchased transport services","Package Holidays","Accomdation Services","Medical Services", "Dental Services","Hospital Services","Education","Social Protection","Healthcare Insurance","Transport Insurance","Financial Services","Other Services","Postal Services","Telephone equipment and services")

colnames(CONTR_SER)<-c(Index_names_services)

CONTR_SER_sum<-data.frame(NA, nrow=length(index(CONTR_SER["2017/"])))

for (i in 1:length(index(CONTR_SER["2017/"]))) {
  CONTR_SER_sum[i]<-sum(as.numeric(CONTR_SER[i]),na.rm = TRUE)
}


TOTAL_CONTR_SER_sum<-as.xts(t(CONTR_SER_sum), order.by = index(CONTR_SER))
colnames(TOTAL_CONTR_SER_sum)<-c("TOTAL")



DEC_BASE_SERVICES<-data.frame(NA, nrow=length(index(TOTAL_CONTR_SER_sum["2017/"])))
DEC_BASE_SERVICES<-(as.numeric(SERVICES_INDEX_XTS[paste0(year(SERVICES_INDEX_XTS["2016/"]), "-12-01")])) 
DEC_BASE_SERVICES[1:length(SERVICES_INDEX_XTS["2017/"])]


overall_service_index<-(TOTAL_CONTR_SER_sum)*DEC_BASE_SERVICES[1:length(TOTAL_CONTR_SER_sum["2017/"])]
write.xlsx(overall_service_index,file = 'SERVICES.xlsx')






for (i in 1:length(Services_INDEX$CP124_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Services_ONLY$CP124["2017/"][i])){
    weight_monthly_Services_ONLY$CP124["2017/"][i]<-weight_monthly_Services_ONLY$CP124["2017/"][i-1]
  } else {
    weight_monthly_Services_ONLY$CP124["2017/"][i]<-weight_monthly_Services_ONLY$CP124["2017/"][i]
  }
}











#CORE SERVICES
weight_CORE_SERVICES<-weight_monthly_Services_ONLY  %>% data.frame() %>% select(-CP0621,-CP0623,-CP0411) %>% as.xts()


weight_CORE_SERVICES<-weight_CORE_SERVICES
#####################################################



weight_CORE_SERVICES_sum<-data.frame(NA, nrow=length(index(weight_CORE_SERVICES["2017/"])))

for (i in 1:length(index(weight_CORE_SERVICES["2017/"]))) {
  weight_CORE_SERVICES_sum[i]<-sum(as.numeric(weight_CORE_SERVICES[i]),na.rm = TRUE)
}


weight_CORE_SERVICES_sum<-as.xts(t(weight_CORE_SERVICES_sum), order.by = index(weight_CORE_SERVICES)) 
colnames(weight_CORE_SERVICES_sum)<-c("TOTAL")


#headline adjustment to core services weight 





CORE_SERVICES_WEIGHT<-1-((CP0411_XTS/1000)/OVERALL_SERVICES_XTS)
weight_monthly_CORE_Services_ONLY<-merge(CORE_SERVICES_WEIGHT,index(Services_INDEX["2017/"]))


for (i in 1:length(Services_INDEX$CP082_3_INDEX["2017/"])){
  
  if( is.na(weight_CORE_SERVICES_sum$TOTAL["2017/"][i])){
    weight_monthly_CORE_Services_ONLY$e1["2017/"][i]<-weight_monthly_CORE_Services_ONLY$e1["2017/"][i-1]
  } else {
    weight_monthly_CORE_Services_ONLY$e1["2017/"][i]<-weight_monthly_CORE_Services_ONLY$e1["2017/"][i]
  }
}




weight_monthly_Services_ONLY<-weight_monthly_Services_ONLY/1000
weight_CORE_SERVICES_sum<-weight_CORE_SERVICES_sum
#####################################################



weight_CORE_SERVICES_CP0432<-(data.frame(weight_monthly_Services_ONLY$CP0432)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0432<-data.frame(Services_INDEX$CP0432_INDEX["2017/"])*weight_CORE_SERVICES_CP0432	

CONTR_CORE_SER_CP0442<-data.frame((Services_INDEX$CP0442_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0442)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0443<-data.frame((Services_INDEX$CP0443_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0443)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0444<-data.frame((Services_INDEX$CP0444_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0444)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0533<-data.frame((Services_INDEX$CP0533_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0533)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0562<-data.frame((Services_INDEX$CP0562_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0562)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP01252<-data.frame((Services_INDEX$CP1252_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP1252)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0314<-data.frame((Services_INDEX$CP0314_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0314)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0915<-data.frame((Services_INDEX$CP0915_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0915)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0941<-data.frame((Services_INDEX$CP0941_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0941)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0942<-data.frame((Services_INDEX$CP0942_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0942)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP1111<-data.frame((Services_INDEX$CP1111_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP1111)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP1112<-data.frame((Services_INDEX$CP1112_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP1112)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP1211<-data.frame((Services_INDEX$CP1211_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP1211)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0723<-data.frame((Services_INDEX$CP0723_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0723)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0724<-data.frame((Services_INDEX$CP0724_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0724)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0731<-data.frame((Services_INDEX$CP0731_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0731)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0732<-data.frame((Services_INDEX$CP0732_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0732)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0733<-data.frame((Services_INDEX$CP0733_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0733)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0734<-data.frame((Services_INDEX$CP0734_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0734)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0735<-data.frame((Services_INDEX$CP0735_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0735)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0736<-data.frame((Services_INDEX$CP0736_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0736)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP096<-data.frame((Services_INDEX$CP096_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP096)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP112<-data.frame((Services_INDEX$CP112_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP112)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0621_3<-data.frame((Services_INDEX$CP0621_3_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0621_3)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0622<-data.frame((Services_INDEX$CP0622_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP0622)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP063<-data.frame((Services_INDEX$CP063_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP063)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP10<-data.frame((Services_INDEX$CP10_INDEX)["2017/"])*(data.frame(weight_monthly_Services_ONLY$CP10)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP124<-data.frame((Services_INDEX$CP124_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP124)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP1253<-data.frame((Services_INDEX$CP1253_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP1253)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP1254<-data.frame((Services_INDEX$CP1254_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP1254)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP0126<-data.frame((Services_INDEX$CP126_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP126)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP127<-data.frame((Services_INDEX$CP127_INDEX)["2017/"])*	(data.frame(weight_monthly_Services_ONLY$CP127)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP081<-data.frame((Services_INDEX$CP081_INDEX)["2017/"])*(data.frame(weight_monthly_Services_ONLY$CP081)/data.frame(weight_CORE_SERVICES_sum$TOTAL))
CONTR_CORE_SER_CP082_3<-data.frame((Services_INDEX$CP082_3_INDEX)["2017/"])*(data.frame(weight_monthly_Services_ONLY$CP082_3)/data.frame(weight_CORE_SERVICES_sum$TOTAL))



CONTR_CORE_SER<-data.frame(CONTR_CORE_SER_CP0432
                           ,CONTR_CORE_SER_CP0442
                           ,CONTR_CORE_SER_CP0443
                           ,CONTR_CORE_SER_CP0444
                           ,CONTR_CORE_SER_CP0533
                           ,CONTR_CORE_SER_CP0562
                           ,CONTR_CORE_SER_CP01252
                           ,CONTR_CORE_SER_CP0314
                           ,CONTR_CORE_SER_CP0915
                           ,CONTR_CORE_SER_CP0941
                           ,CONTR_CORE_SER_CP0942
                           ,CONTR_CORE_SER_CP1111
                           ,CONTR_CORE_SER_CP1112
                           ,CONTR_CORE_SER_CP1211
                           ,CONTR_CORE_SER_CP0723
                           ,CONTR_CORE_SER_CP0724
                           ,CONTR_CORE_SER_CP0731
                           ,CONTR_CORE_SER_CP0732
                           ,CONTR_CORE_SER_CP0733
                           ,CONTR_CORE_SER_CP0734
                           ,CONTR_CORE_SER_CP0735
                           ,CONTR_CORE_SER_CP0736
                           ,CONTR_CORE_SER_CP096
                           ,CONTR_CORE_SER_CP112
                           ,CONTR_CORE_SER_CP0621_3
                           ,CONTR_CORE_SER_CP0622
                           ,CONTR_CORE_SER_CP063
                           ,CONTR_CORE_SER_CP10
                           ,CONTR_CORE_SER_CP124
                           ,CONTR_CORE_SER_CP1253
                           ,CONTR_CORE_SER_CP1254
                           ,CONTR_CORE_SER_CP0126
                           ,CONTR_CORE_SER_CP127
                           ,CONTR_CORE_SER_CP081
                           ,CONTR_CORE_SER_CP082_3) %>% as.xts(order.by=index(weight_CORE_SERVICES))






CONTR_CORE_SER_sum<-data.frame(NA, nrow=length(index(CONTR_CORE_SER["2017/"])))

for (i in 1:length(index(CONTR_CORE_SER["2017/"]))) {
  CONTR_CORE_SER_sum[i]<-sum(as.numeric(CONTR_CORE_SER[i]),na.rm = TRUE)
}


TOTAL_CONTR_CORE_SER_sum<-as.xts(t(CONTR_CORE_SER_sum), order.by = index(CONTR_CORE_SER))
colnames(TOTAL_CONTR_CORE_SER_sum)<-c("TOTAL")




DEC_BASE_CORE_SERVICES<-data.frame(NA, nrow=length(index(TOTAL_CONTR_CORE_SER_sum["2017/"])))
DEC_BASE_CORE_SERVICES<-(as.numeric(CORE_SERVICES_INDEX_XTS[paste0(year(CORE_SERVICES_INDEX_XTS["2016/"]), "-12-01")])) 
DEC_BASE_CORE_SERVICES[1:length(CORE_SERVICES_INDEX_XTS["2017/"])]


Core_service_index<-(TOTAL_CONTR_CORE_SER_sum)*DEC_BASE_CORE_SERVICES[1:length(TOTAL_CONTR_CORE_SER_sum["2017/"])]
write.xlsx(TOTAL_CONTR_CORE_SER_sum,file = 'CORE_SERVICES.xlsx')





write.xlsx(TOTAL_CONTR_CORE_SER_sum, file = 'Core_SERVICES.xlsx')



#Unprocessed food 

Unprocessed_food_weight_ONLY<-merge((CP0112_XTS/1000),(CP0113_XTS/1000),(CP0116_XTS/1000),(CP0117_XTS/1000))
Unprocessed_food_weight_ONLY_17<-Unprocessed_food_weight_ONLY["2017/"]

colnames(Unprocessed_food_weight_ONLY_17)<-c("CP0112","CP0113","CP0116","CP0117")

weight_monthly_Unprocessed_food_weight_ONLY<-merge(Unprocessed_food_weight_ONLY_17,index(UNPROCESSED_FOOD_INDEX["2017/"]))


#temporary fix below 
weight_monthly_Unprocessed_food_weight_ONLY<-weight_monthly_Unprocessed_food_weight_ONLY


for (i in 1:length(UNPROCESSED_FOOD_INDEX$CP0112_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Unprocessed_food_weight_ONLY$CP0112["2017/"][i])){
    weight_monthly_Unprocessed_food_weight_ONLY$CP0112["2017/"][i]<-weight_monthly_Unprocessed_food_weight_ONLY$CP0112["2017/"][i-1]
  } else {
    weight_monthly_Unprocessed_food_weight_ONLY$CP0112["2017/"][i]<-weight_monthly_Unprocessed_food_weight_ONLY$CP0112["2017/"][i]
  }
}

for (i in 1:length(UNPROCESSED_FOOD_INDEX$CP0112_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Unprocessed_food_weight_ONLY$CP0113["2017/"][i])){
    weight_monthly_Unprocessed_food_weight_ONLY$CP0113["2017/"][i]<-weight_monthly_Unprocessed_food_weight_ONLY$CP0113["2017/"][i-1]
  } else {
    weight_monthly_Unprocessed_food_weight_ONLY$CP0113["2017/"][i]<-weight_monthly_Unprocessed_food_weight_ONLY$CP0113["2017/"][i]
  }
}


for (i in 1:length(UNPROCESSED_FOOD_INDEX$CP0112_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Unprocessed_food_weight_ONLY$CP0116["2017/"][i])){
    weight_monthly_Unprocessed_food_weight_ONLY$CP0116["2017/"][i]<-weight_monthly_Unprocessed_food_weight_ONLY$CP0116["2017/"][i-1]
  } else {
    weight_monthly_Unprocessed_food_weight_ONLY$CP01116["2017/"][i]<-weight_monthly_Unprocessed_food_weight_ONLY$CP01116["2017/"][i]
  }
}




for (i in 1:length(UNPROCESSED_FOOD_INDEX$CP0112_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Unprocessed_food_weight_ONLY$CP0117["2017/"][i])){
    weight_monthly_Unprocessed_food_weight_ONLY$CP0117["2017/"][i]<-weight_monthly_Unprocessed_food_weight_ONLY$CP0117["2017/"][i-1]
  } else {
    weight_monthly_Unprocessed_food_weight_ONLY$CP0117["2017/"][i]<-weight_monthly_Unprocessed_food_weight_ONLY$CP0117["2017/"][i]
  }
}




weight_Unprocessed_food_weight_sum<-data.frame(NA, nrow=length(index(weight_monthly_Unprocessed_food_weight_ONLY["2017/"])))

for (i in 1:length(index(weight_monthly_Unprocessed_food_weight_ONLY["2017/"]))) {
  weight_Unprocessed_food_weight_sum[i]<-sum(as.numeric(weight_monthly_Unprocessed_food_weight_ONLY[i]),na.rm = TRUE)
}


weight_Unprocessed_food_sum<-as.xts(t(weight_Unprocessed_food_weight_sum), order.by = index(weight_CORE_SERVICES)) 
colnames(weight_Unprocessed_food_sum)<-c("TOTAL")


##WEIGHT AGGREGATE UNPROCESSED FOOD 


Unprocessed_food_weight_TOTAL<-merge(OVERALL_UNPROCESSED_FOOD_XTS,index(UNPROCESSED_FOOD_INDEX["2017/"]))



for (i in 1:length(UNPROCESSED_FOOD_INDEX$CP0112_INDEX["2017/"])){
  
  if( is.na(Unprocessed_food_weight_TOTAL["2017/"][i])){
    Unprocessed_food_weight_TOTAL["2017/"][i]<-Unprocessed_food_weight_TOTAL["2017/"][i-1]
  } else {
    Unprocessed_food_weight_TOTAL["2017/"][i]<-Unprocessed_food_weight_TOTAL["2017/"][i]
  }
}






Unprocessed_food_CP0112_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Unprocessed_food_weight_ONLY$CP0112)/data.frame(weight_Unprocessed_food_sum)
Unprocessed_food_CP0113_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Unprocessed_food_weight_ONLY$CP0113)/data.frame(weight_Unprocessed_food_sum)
Unprocessed_food_CP0116_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Unprocessed_food_weight_ONLY$CP0116)/data.frame(weight_Unprocessed_food_sum)
Unprocessed_food_CP0117_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Unprocessed_food_weight_ONLY$CP0117)/data.frame(weight_Unprocessed_food_sum)


Unprocessed_food_WEIGHT_ADJ<-data.frame(Unprocessed_food_CP0112_WEIGHT_ADJ_SHARE,Unprocessed_food_CP0113_WEIGHT_ADJ_SHARE,Unprocessed_food_CP0116_WEIGHT_ADJ_SHARE,Unprocessed_food_CP0117_WEIGHT_ADJ_SHARE)




Chain_UNPROCESSED_FOOD_INDEX_CP0112_INDEX<-Chainlinking(UNPROCESSED_FOOD_INDEX$CP0112_INDEX) 
Chain_UNPROCESSED_FOOD_INDEX_CP0113_INDEX<-Chainlinking(UNPROCESSED_FOOD_INDEX$CP0113_INDEX) 
Chain_UNPROCESSED_FOOD_INDEX_CP0116_INDEX<-Chainlinking(UNPROCESSED_FOOD_INDEX$CP0116_INDEX) 
Chain_UNPROCESSED_FOOD_INDEX_CP0117_INDEX<-Chainlinking(UNPROCESSED_FOOD_INDEX$CP0117_INDEX) 


CONTR_Unprocessed_food_CP0112<-data.frame(Chain_UNPROCESSED_FOOD_INDEX_CP0112_INDEX["2017/"])*as.numeric(Unprocessed_food_WEIGHT_ADJ$CP0112)
CONTR_Unprocessed_food_CP0113<-data.frame(Chain_UNPROCESSED_FOOD_INDEX_CP0113_INDEX["2017/"])*as.numeric(Unprocessed_food_WEIGHT_ADJ$CP0113)
CONTR_Unprocessed_food_CP0116<-data.frame(Chain_UNPROCESSED_FOOD_INDEX_CP0116_INDEX["2017/"])*as.numeric(Unprocessed_food_WEIGHT_ADJ$CP0116)
CONTR_Unprocessed_food_CP0117<-data.frame(Chain_UNPROCESSED_FOOD_INDEX_CP0117_INDEX["2017/"])*as.numeric(Unprocessed_food_WEIGHT_ADJ$CP0117)



CONTR_Unprocessed_food_AGG<-data.frame(CONTR_Unprocessed_food_CP0112,
                                       CONTR_Unprocessed_food_CP0113,
                                       CONTR_Unprocessed_food_CP0116,
                                       CONTR_Unprocessed_food_CP0117) %>% as.xts(order.by=index(UNPROCESSED_FOOD_INDEX["2017/"]))


CONTR_Unprocessed_food_sum<-data.frame(NA, nrow=length(index(CONTR_Unprocessed_food_AGG["2017/"])))

for (i in 1:length(index(CONTR_Unprocessed_food_AGG["2017/"]))) {
  CONTR_Unprocessed_food_sum[i]<-(sum(as.numeric(CONTR_Unprocessed_food_AGG[i]),na.rm = TRUE))
}



CONTR_Unprocessed_food_sum_XTS<-as.xts(t(CONTR_Unprocessed_food_sum), order.by=index(Unprocessed_food_weight_TOTAL$OVERALL["2017/"]))



DEC_BASE_FOOD_NP<-data.frame(NA, nrow=length(index(CONTR_Unprocessed_food_AGG["2017/"])))
DEC_BASE_FOOD_NP<-(as.numeric(FOOD_NP_INDEX_XTS[paste0(year(FOOD_NP_INDEX_XTS["2016/"]), "-12-01")])) 
DEC_BASE_FOOD_NP[1:length(CONTR_Unprocessed_food_sum_XTS["2017/"])]


Unprocessed_food_weight_TOTAL_adj<-(Unprocessed_food_weight_TOTAL$OVERALL/1000)

Unprocessed_food_index<-(CONTR_Unprocessed_food_sum_XTS)*DEC_BASE_FOOD_NP[1:length(CONTR_Unprocessed_food_sum_XTS["2017/"])]




TOTAL_CONTR_Unprocessed_food_sum<-Unprocessed_food_index
colnames(TOTAL_CONTR_Unprocessed_food_sum)<-c("TOTAL")







#processed food 





Processed_food_weight_ONLY<-merge((CP0111_XTS/1000),(CP0114_XTS/1000),(CP0115_XTS/1000),(CP0118_XTS/1000),(CP0119_XTS/1000),(CP0121_XTS/1000),(CP0122_XTS/1000),(CP0211_XTS/1000),(CP0212_XTS/1000),(CP0213_XTS/1000),(CP0220_XTS/1000))
Processed_food_weight_ONLY_17<-Processed_food_weight_ONLY["2017/"]

colnames(Processed_food_weight_ONLY_17)<-c("CP0111","CP0114","CP0115","CP0118","CP0119","CP0121","CP0122","CP0211","CP0212","CP0213","CP0220")

weight_monthly_Processed_food_weight_ONLY<-merge(Processed_food_weight_ONLY_17,index(PROCESSED_FOOD_INDEX["2017/"]))




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0111["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0111["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0111["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0111["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0111["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0114["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0114["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0114["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0114["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0114["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0115_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0115["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0115["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0115["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0115["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0115["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0118_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0118["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0118["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0118["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0118["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0118["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0119_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0119["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0119["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0119["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0119["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0119["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0121_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0121["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0121["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0121["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0121["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0121["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0122_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0122["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0122["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0122["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0122["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0122["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0211_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0211["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0211["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0211["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0211["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0211["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0212_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0212["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0212["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0212["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0212["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0212["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0213_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0213["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0213["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0213["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0213["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0213["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0220_INDEX["2017/"])){
  
  if( is.na(weight_monthly_Processed_food_weight_ONLY$CP0220["2017/"][i])){
    weight_monthly_Processed_food_weight_ONLY$CP0220["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0220["2017/"][i-1]
  } else {
    weight_monthly_Processed_food_weight_ONLY$CP0220["2017/"][i]<-weight_monthly_Processed_food_weight_ONLY$CP0220["2017/"][i]
  }
}







weight_Processed_food_weight_sum<-data.frame(NA, nrow=length(index(weight_monthly_Processed_food_weight_ONLY["2017/"])))

for (i in 1:length(index(weight_monthly_Processed_food_weight_ONLY["2017/"]))) {
  weight_Processed_food_weight_sum[i]<-sum(as.numeric(weight_monthly_Processed_food_weight_ONLY[i]),na.rm = TRUE)
}


weight_Processed_food_sum<-as.xts(t(weight_Processed_food_weight_sum), order.by = index(weight_CORE_SERVICES)) 
colnames(weight_Processed_food_sum)<-c("TOTAL")




Processed_food_CP0111_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0111)/data.frame(weight_Processed_food_sum)
Processed_food_CP0114_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0114)/data.frame(weight_Processed_food_sum)
Processed_food_CP0115_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0115)/data.frame(weight_Processed_food_sum)
Processed_food_CP0118_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0118)/data.frame(weight_Processed_food_sum)
Processed_food_CP0119_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0119)/data.frame(weight_Processed_food_sum)
Processed_food_CP0121_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0121)/data.frame(weight_Processed_food_sum)
Processed_food_CP0122_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0122)/data.frame(weight_Processed_food_sum)
Processed_food_CP0211_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0211)/data.frame(weight_Processed_food_sum)
Processed_food_CP0212_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0212)/data.frame(weight_Processed_food_sum)
Processed_food_CP0213_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0213)/data.frame(weight_Processed_food_sum)
Processed_food_CP0220_WEIGHT_ADJ_SHARE<-data.frame(weight_monthly_Processed_food_weight_ONLY$CP0220)/data.frame(weight_Processed_food_sum)


Processed_food_WEIGHT_ADJ<-data.frame(Processed_food_CP0111_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0114_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0115_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0118_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0119_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0121_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0122_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0211_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0212_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0213_WEIGHT_ADJ_SHARE,
                                      Processed_food_CP0220_WEIGHT_ADJ_SHARE)




Chain_PROCESSED_FOOD_INDEX_CP0111_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0111_INDEX) 
Chain_PROCESSED_FOOD_INDEX_CP0114_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0114_INDEX) 
Chain_PROCESSED_FOOD_INDEX_CP0115_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0115_INDEX) 
Chain_PROCESSED_FOOD_INDEX_CP0118_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0118_INDEX)
Chain_PROCESSED_FOOD_INDEX_CP0119_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0119_INDEX)
Chain_PROCESSED_FOOD_INDEX_CP0121_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0121_INDEX)
Chain_PROCESSED_FOOD_INDEX_CP0122_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0122_INDEX)
Chain_PROCESSED_FOOD_INDEX_CP0211_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0211_INDEX)
Chain_PROCESSED_FOOD_INDEX_CP0212_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0212_INDEX)
Chain_PROCESSED_FOOD_INDEX_CP0213_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0213_INDEX)
Chain_PROCESSED_FOOD_INDEX_CP0220_INDEX<-Chainlinking(PROCESSED_FOOD_INDEX$CP0220_INDEX)



CONTR_Processed_food_CP0111<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0111_INDEX["2017/"])*as.numeric(Processed_food_CP0111_WEIGHT_ADJ_SHARE$CP0111)
CONTR_Processed_food_CP0114<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0114_INDEX["2017/"])*as.numeric(Processed_food_CP0114_WEIGHT_ADJ_SHARE$CP0114)
CONTR_Processed_food_CP0115<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0115_INDEX["2017/"])*as.numeric(Processed_food_CP0115_WEIGHT_ADJ_SHARE$CP0115)
CONTR_Processed_food_CP0118<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0118_INDEX["2017/"])*as.numeric(Processed_food_CP0118_WEIGHT_ADJ_SHARE$CP0118)
CONTR_Processed_food_CP0119<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0119_INDEX["2017/"])*as.numeric(Processed_food_CP0119_WEIGHT_ADJ_SHARE$CP0119)
CONTR_Processed_food_CP0121<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0121_INDEX["2017/"])*as.numeric(Processed_food_CP0121_WEIGHT_ADJ_SHARE$CP0121)
CONTR_Processed_food_CP0122<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0122_INDEX["2017/"])*as.numeric(Processed_food_CP0122_WEIGHT_ADJ_SHARE$CP0122)
CONTR_Processed_food_CP0211<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0211_INDEX["2017/"])*as.numeric(Processed_food_CP0211_WEIGHT_ADJ_SHARE$CP0211)
CONTR_Processed_food_CP0212<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0212_INDEX["2017/"])*as.numeric(Processed_food_CP0212_WEIGHT_ADJ_SHARE$CP0212)
CONTR_Processed_food_CP0213<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0213_INDEX["2017/"])*as.numeric(Processed_food_CP0213_WEIGHT_ADJ_SHARE$CP0213)
CONTR_Processed_food_CP0220<-data.frame(Chain_PROCESSED_FOOD_INDEX_CP0220_INDEX["2017/"])*as.numeric(Processed_food_CP0220_WEIGHT_ADJ_SHARE$CP0220)



CONTR_Processed_food_AGG<-data.frame(CONTR_Processed_food_CP0111,
                                     CONTR_Processed_food_CP0114,
                                     CONTR_Processed_food_CP0115,
                                     CONTR_Processed_food_CP0118,
                                     CONTR_Processed_food_CP0119,
                                     CONTR_Processed_food_CP0121,
                                     CONTR_Processed_food_CP0122,
                                     CONTR_Processed_food_CP0211,
                                     CONTR_Processed_food_CP0212,
                                     CONTR_Processed_food_CP0213,
                                     CONTR_Processed_food_CP0220) %>% as.xts(order.by=index(PROCESSED_FOOD_INDEX["2017/"]))


CONTR_Processed_food_sum<-data.frame(NA, nrow=length(index(CONTR_Processed_food_AGG["2017/"])))

for (i in 1:length(index(CONTR_Processed_food_AGG["2017/"]))) {
  CONTR_Processed_food_sum[i]<-sum(as.numeric(CONTR_Processed_food_AGG[i]),na.rm = TRUE)
}





CONTR_Processed_food_sum_XTS<-as.xts(t(CONTR_Processed_food_sum), order.by=index(Unprocessed_food_weight_TOTAL$OVERALL["2017/"]))



DEC_BASE_FOOD_P<-data.frame(NA, nrow=length(index(CONTR_Processed_food_AGG["2017/"])))
DEC_BASE_FOOD_P<-(as.numeric(FOOD_P_INDEX_XTS[paste0(year(FOOD_P_INDEX_XTS["2016/"]), "-12-01")])) 
DEC_BASE_FOOD_P[1:length(CONTR_Unprocessed_food_sum_XTS["2017/"])]



Processed_food_index<-(CONTR_Processed_food_sum_XTS)*DEC_BASE_FOOD_P[1:length(CONTR_Processed_food_sum_XTS["2017/"])]




TOTAL_CONTR_Processed_food_sum<-Processed_food_index
colnames(TOTAL_CONTR_Processed_food_sum)<-c("TOTAL")































inflation_excel<-data.frame(index(TOTAL_CONTR_CORE_SER_sum),TOTAL_CONTR_CORE_SER_sum,overall_service_index,TOTAL_CONTR_Unprocessed_food_sum,TOTAL_CONTR_Processed_food_sum) 

colnames(inflation_excel)<-c("Date","Core Services (2015= 100)","Overall Services (2015= 100)", "Unprocessed Food (2015= 100)","Processed Food (2015= 100)")  



write.xlsx(inflation_excel, file = 'inflation_excel7.xlsx')





#TEST GOOD SERVICE AGGREGATION 

SERVICES_GOODS_XTS_WEIGHT<-merge(CP0411_XTS/1000,
                                 CP0432_XTS/1000,
                                 CP0442_XTS/1000,
                                 CP0443_XTS/1000,
                                 CP0444_XTS/1000,
                                 CP0533_XTS/1000,
                                 CP0562_XTS/1000,
                                 CP1252_XTS/1000,
                                 CP0314_XTS/1000,
                                 CP0915_XTS/1000,
                                 CP0941_XTS/1000,
                                 CP0942_XTS/1000,
                                 CP1111_XTS/1000,
                                 CP1112_XTS/1000,
                                 CP1211_XTS/1000,
                                 CP0723_XTS/1000,
                                 CP0724_XTS/1000,
                                 CP0731_XTS/1000,
                                 CP0732_XTS/1000,
                                 CP0733_XTS/1000,
                                 CP0734_XTS/1000,
                                 CP0735_XTS/1000,
                                 CP0736_XTS/1000,
                                 CP096_XTS/1000,
                                 CP112_XTS/1000,
                                 CP0621_XTS/1000,
                                 CP0622_XTS/1000,
                                 CP0623_XTS/1000,
                                 CP063_XTS/1000,
                                 CP10_XTS/1000,
                                 CP124_XTS/1000,
                                 CP1253_XTS/1000,
                                 CP1254_XTS/1000,
                                 CP126_XTS/1000,
                                 CP127_XTS/1000,
                                 CP081_XTS/1000,
                                 CP082_3_XTS/1000,
                                 CP0111_XTS/1000,
                                 CP0112_XTS/1000,
                                 CP0113_XTS/1000,
                                 CP0114_XTS/1000,
                                 CP0115_XTS/1000,
                                 CP0116_XTS/1000,
                                 CP0117_XTS/1000,
                                 CP0118_XTS/1000,
                                 CP0119_XTS/1000,
                                 CP0121_XTS/1000,
                                 CP0122_XTS/1000,
                                 CP0211_XTS/1000,
                                 CP0212_XTS/1000,
                                 CP0213_XTS/1000,
                                 CP0220_XTS/1000,
                                 CP0311_XTS/1000,
                                 CP0312_XTS/1000,
                                 CP0313_XTS/1000,
                                 CP032_XTS/1000,
                                 CP0431_XTS/1000,
                                 CP0441_XTS/1000,
                                 CP0451_XTS/1000,
                                 CP0452_XTS/1000,
                                 CP0453_XTS/1000,
                                 CP0454_XTS/1000,
                                 CP0455_XTS/1000,
                                 CP0511_XTS/1000,
                                 CP0512_XTS/1000,
                                 CP0520_XTS/1000,
                                 CP0531_2_XTS/1000,
                                 CP0540_XTS/1000,
                                 CP055_XTS/1000,
                                 CP0561_XTS/1000,
                                 CP0611_XTS/1000,
                                 CP0612_3_XTS/1000,
                                 CP0711_XTS/1000,
                                 CP0712_3_4_XTS/1000,
                                 CP0721_XTS/1000,
                                 CP0722_XTS/1000,
                                 CP0911_XTS/1000,
                                 CP0912_XTS/1000,
                                 CP0913_XTS/1000,
                                 CP0914_XTS/1000,
                                 CP0921_2_XTS/1000,
                                 CP0931_XTS/1000,
                                 CP0932_XTS/1000,
                                 CP0933_XTS/1000,
                                 CP0934_5_XTS/1000,
                                 CP0951_XTS/1000,
                                 CP0952_XTS/1000,
                                 CP0953_4_XTS/1000,
                                 CP1212_3_XTS/1000,
                                 CP1231_XTS/1000,
                                 CP1232_XTS/1000)

colnames(SERVICES_GOODS_XTS_WEIGHT)<-c("CP0411_XTS",
                                       "CP0432_XTS",
                                       "CP0442_XTS",
                                       "CP0443_XTS",
                                       "CP0444_XTS",
                                       "CP0533_XTS",
                                       "CP0562_XTS",
                                       "CP1252_XTS",
                                       "CP0314_XTS",
                                       "CP0915_XTS",
                                       "CP0941_XTS",
                                       "CP0942_XTS",
                                       "CP1111_XTS",
                                       "CP1112_XTS",
                                       "CP1211_XTS",
                                       "CP0723_XTS",
                                       "CP0724_XTS",
                                       "CP0731_XTS",
                                       "CP0732_XTS",
                                       "CP0733_XTS",
                                       "CP0734_XTS",
                                       "CP0735_XTS",
                                       "CP0736_XTS",
                                       "CP096_XTS",
                                       "CP112_XTS",
                                       "CP0621_XTS",
                                       "CP0622_XTS",
                                       "CP0623_XTS",
                                       "CP063_XTS",
                                       "CP10_XTS",
                                       "CP124_XTS",
                                       "CP1253_XTS",
                                       "CP1254_XTS",
                                       "CP126_XTS",
                                       "CP127_XTS",
                                       "CP081_XTS",
                                       "CP082_3_XTS",
                                       "CP0111_XTS",
                                       "CP0112_XTS",
                                       "CP0113_XTS",
                                       "CP0114_XTS",
                                       "CP0115_XTS",
                                       "CP0116_XTS",
                                       "CP0117_XTS",
                                       "CP0118_XTS",
                                       "CP0119_XTS",
                                       "CP0121_XTS",
                                       "CP0122_XTS",
                                       "CP0211_XTS",
                                       "CP0212_XTS",
                                       "CP0213_XTS",
                                       "CP0220_XTS",
                                       "CP0311_XTS",
                                       "CP0312_XTS",
                                       "CP0313_XTS",
                                       "CP032_XTS",
                                       "CP0431_XTS",
                                       "CP0441_XTS",
                                       "CP0451_XTS",
                                       "CP0452_XTS",
                                       "CP0453_XTS",
                                       "CP0454_XTS",
                                       "CP0455_XTS",
                                       "CP0511_XTS",
                                       "CP0512_XTS",
                                       "CP0520_XTS",
                                       "CP0531_2_XTS",
                                       "CP0540_XTS",
                                       "CP055_XTS",
                                       "CP0561_XTS",
                                       "CP0611_XTS",
                                       "CP0612_3_XTS",
                                       "CP0711_XTS",
                                       "CP0712_3_4_XTS",
                                       "CP0721_XTS",
                                       "CP0722_XTS",
                                       "CP0911_XTS",
                                       "CP0912_XTS",
                                       "CP0913_XTS",
                                       "CP0914_XTS",
                                       "CP0921_2_XTS",
                                       "CP0931_XTS",
                                       "CP0932_XTS",
                                       "CP0933_XTS",
                                       "CP0934_5_XTS",
                                       "CP0951_XTS",
                                       "CP0952_XTS",
                                       "CP0953_4_XTS",
                                       "CP1212_3_XTS",
                                       "CP1231_XTS",
                                       "CP1232_XTS")



SERVICES_GOODS_weight_sum<-data.frame(NA, nrow=length(index(SERVICES_GOODS_XTS_WEIGHT["2017/"])))
SERVICES_GOODS_XTS_WEIGHT[is.na(SERVICES_GOODS_XTS_WEIGHT)]<-0

for (i in 1:length(index(SERVICES_GOODS_XTS_WEIGHT["2017/"]))) {
  SERVICES_GOODS_weight_sum[i]<-sum(as.numeric(SERVICES_GOODS_XTS_WEIGHT["2017/"][i]))
}




WEIGHTS_GOODS_SERVICES_COMBO<-merge(SERVICES_GOODS_XTS_WEIGHT["2017/"],index(PROCESSED_FOOD_INDEX["2017/"]))
WEIGHTS_GOODS_SERVICES_COMBO_CP0621_3_XTS<-WEIGHTS_GOODS_SERVICES_COMBO$CP0621_XTS+WEIGHTS_GOODS_SERVICES_COMBO$CP0623_XTS




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0411_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0411_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0411_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0411_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0411_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0432_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0432_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0432_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0432_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0432_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0442_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0442_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0442_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0442_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0442_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0443_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0443_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0443_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0443_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0443_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0444_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0444_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0444_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0444_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0444_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0533_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0533_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0533_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0533_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0533_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0562_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0562_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0562_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0562_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0562_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP1252_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP1252_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1252_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP1252_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1252_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0314_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0314_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0314_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0314_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0314_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0915_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0915_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0915_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0915_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0915_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0941_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0941_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0941_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0941_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0941_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0942_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0942_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0942_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0942_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0942_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP1111_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP1111_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1111_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP1111_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1111_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP1112_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP1112_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1112_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP1112_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1112_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP1211_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP1211_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1211_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP1211_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1211_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0723_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0723_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0723_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0723_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0723_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0724_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0724_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0724_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0724_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0724_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0731_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0731_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0731_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0731_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0731_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0732_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0732_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0732_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0732_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0732_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0733_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0733_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0733_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0733_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0733_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0734_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0734_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0734_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0734_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0734_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0735_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0735_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0735_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0735_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0735_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0736_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0736_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0736_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0736_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0736_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP096_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP096_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP096_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP096_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP096_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP112_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP112_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP112_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP112_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP112_XTS["2017/"][i]
  }
}





for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0622_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0622_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0622_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0622_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0622_XTS["2017/"][i]
  }
}












for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO_CP0621_3_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO_CP0621_3_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO_CP0621_3_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO_CP0621_3_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO_CP0621_3_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP063_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP063_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP063_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP063_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP063_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP10_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP10_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP10_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP10_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP10_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP124_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP124_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP124_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP124_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP124_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP1253_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP1253_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1253_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP1253_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1253_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP1254_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP1254_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1254_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP1254_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1254_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP126_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP126_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP126_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP126_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP126_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP127_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP127_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP127_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP127_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP127_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP081_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP081_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP081_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP081_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP081_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP082_3_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP082_3_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP082_3_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP082_3_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP082_3_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0111_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0111_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0111_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0111_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0111_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0112_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0112_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0112_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0112_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0112_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0113_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0113_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0113_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0113_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0113_XTS["2017/"][i]
  }
}





for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0114_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0114_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0114_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0114_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0114_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0115_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0115_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0115_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0115_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0115_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0116_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0116_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0116_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0116_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0116_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0117_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0117_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0117_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0117_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0117_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0118_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0118_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0118_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0118_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0118_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0119_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0119_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0119_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0119_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0119_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0121_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0121_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0121_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0121_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0121_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0122_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0122_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0122_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0122_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0122_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0211_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0211_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0211_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0211_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0211_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0212_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0212_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0212_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0212_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0212_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0213_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0213_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0213_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0213_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0213_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0220_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0220_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0220_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0220_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0220_XTS["2017/"][i]
  }
}





for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0311_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0311_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0311_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0311_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0311_XTS["2017/"][i]
  }
}






for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0312_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0312_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0312_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0312_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0312_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0313_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0313_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0313_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0313_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0313_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP032_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP032_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP032_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP032_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP032_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0431_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0431_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0431_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0431_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0431_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0441_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0441_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0441_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0441_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0441_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0451_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0451_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0451_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0451_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0451_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0452_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0452_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0452_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0452_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0452_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0453_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0453_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0453_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0453_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0453_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0454_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0454_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0454_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0454_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0454_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0455_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0455_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0455_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0455_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0455_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0511_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0511_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0511_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0511_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0511_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0512_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0512_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0512_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0512_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0512_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0520_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0520_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0520_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0520_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0520_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0531_2_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0531_2_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0531_2_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0531_2_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0531_2_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0540_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0540_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0540_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0540_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0540_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP055_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP055_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP055_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP055_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP055_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0561_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0561_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0561_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0561_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0561_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0611_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0611_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0611_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0611_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0611_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0612_3_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0612_3_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0612_3_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0612_3_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0612_3_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0711_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0711_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0711_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0711_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0711_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0712_3_4_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0712_3_4_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0712_3_4_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0712_3_4_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0712_3_4_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0721_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0721_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0721_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0721_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0721_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0722_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0722_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0722_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0722_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0722_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0911_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0911_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0911_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0911_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0911_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0912_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0912_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0912_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0912_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0912_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0913_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0913_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0913_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0913_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0913_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0914_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0914_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0914_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0914_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0914_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0921_2_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0921_2_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0921_2_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0921_2_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0921_2_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0931_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0931_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0931_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0931_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0931_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0932_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0932_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0932_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0932_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0932_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0933_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0933_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0933_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0933_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0933_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0934_5_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0934_5_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0934_5_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0934_5_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0934_5_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0951_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0951_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0951_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0951_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0951_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0952_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0952_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0952_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0952_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0952_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP0953_4_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP0953_4_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0953_4_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP0953_4_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP0953_4_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP1212_3_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP1212_3_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1212_3_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP1212_3_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1212_3_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP1231_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP1231_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1231_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP1231_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1231_XTS["2017/"][i]
  }
}






for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(WEIGHTS_GOODS_SERVICES_COMBO$CP1232_XTS["2017/"][i])){
    WEIGHTS_GOODS_SERVICES_COMBO$CP1232_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1232_XTS["2017/"][i-1]
  } else {
    WEIGHTS_GOODS_SERVICES_COMBO$CP1232_XTS["2017/"][i]<-WEIGHTS_GOODS_SERVICES_COMBO$CP1232_XTS["2017/"][i]
  }
}






























SERVICES_GOODS_XTS_INDEX<-merge(CP0411_INDEX,
                                 CP0432_INDEX,
                                 CP0442_INDEX,
                                 CP0443_INDEX,
                                 CP0444_INDEX,
                                 CP0533_INDEX,
                                 CP0562_INDEX,
                                 CP1252_INDEX,
                                 CP0314_INDEX,
                                 CP0915_INDEX,
                                 CP0941_INDEX,
                                 CP0942_INDEX,
                                 CP1111_INDEX,
                                 CP1112_INDEX,
                                 CP1211_INDEX,
                                 CP0723_INDEX,
                                 CP0724_INDEX,
                                 CP0731_INDEX,
                                 CP0732_INDEX,
                                 CP0733_INDEX,
                                 CP0734_INDEX,
                                 CP0735_INDEX,
                                 CP0736_INDEX,
                                 CP096_INDEX,
                                 CP112_INDEX,
                                CP0621_3_INDEX,
                                 CP0622_INDEX,
                                 CP063_INDEX,
                                 CP10_INDEX,
                                 CP124_INDEX,
                                 CP1253_INDEX,
                                 CP1254_INDEX,
                                 CP126_INDEX,
                                 CP127_INDEX,
                                 CP081_INDEX,
                                 CP082_3_INDEX,
                                 CP0111_INDEX,
                                 CP0112_INDEX,
                                 CP0113_INDEX,
                                 CP0114_INDEX,
                                 CP0115_INDEX,
                                 CP0116_INDEX,
                                 CP0117_INDEX,
                                 CP0118_INDEX,
                                 CP0119_INDEX,
                                 CP0121_INDEX,
                                 CP0122_INDEX,
                                 CP0211_INDEX,
                                 CP0212_INDEX,
                                 CP0213_INDEX,
                                 CP0220_INDEX,
                                 CP0311_INDEX,
                                 CP0312_INDEX,
                                 CP0313_INDEX,
                                 CP032_INDEX,
                                 CP0431_INDEX,
                                 CP0441_INDEX,
                                 CP0451_INDEX,
                                 CP0452_INDEX,
                                 CP0453_INDEX,
                                 CP0454_INDEX,
                                 CP0455_INDEX,
                                 CP0511_INDEX,
                                 CP0512_INDEX,
                                 CP0520_INDEX,
                                 CP0531_2_INDEX,
                                 CP0540_INDEX,
                                 CP055_INDEX,
                                 CP0561_INDEX,
                                 CP0611_INDEX,
                                 CP0612_3_INDEX,
                                 CP0711_INDEX,
                                 CP0712_3_4_INDEX,
                                 CP0721_INDEX,
                                 CP0722_INDEX,
                                 CP0911_INDEX,
                                 CP0912_INDEX,
                                 CP0913_INDEX,
                                 CP0914_INDEX,
                                 CP0921_2_INDEX,
                                 CP0931_INDEX,
                                 CP0932_INDEX,
                                 CP0933_INDEX,
                                 CP0934_5_INDEX,
                                 CP0951_INDEX,
                                 CP0952_INDEX,
                                 CP0953_4_INDEX,
                                 CP1212_3_INDEX,
                                 CP1231_INDEX,
                                 CP1232_INDEX)



colnames(SERVICES_GOODS_XTS_INDEX)<-c("CP0411_INDEX",
                                       "CP0432_INDEX",
                                       "CP0442_INDEX",
                                       "CP0443_INDEX",
                                       "CP0444_INDEX",
                                       "CP0533_INDEX",
                                       "CP0562_INDEX",
                                       "CP1252_INDEX",
                                       "CP0314_INDEX",
                                       "CP0915_INDEX",
                                       "CP0941_INDEX",
                                       "CP0942_INDEX",
                                       "CP1111_INDEX",
                                       "CP1112_INDEX",
                                       "CP1211_INDEX",
                                       "CP0723_INDEX",
                                       "CP0724_INDEX",
                                       "CP0731_INDEX",
                                       "CP0732_INDEX",
                                       "CP0733_INDEX",
                                       "CP0734_INDEX",
                                       "CP0735_INDEX",
                                       "CP0736_INDEX",
                                       "CP096_INDEX",
                                       "CP112_INDEX",
                                       "CP0621_3_INDEX",
                                       "CP0622_INDEX",
                                       "CP063_INDEX",
                                       "CP10_INDEX",
                                       "CP124_INDEX",
                                       "CP1253_INDEX",
                                       "CP1254_INDEX",
                                       "CP126_INDEX",
                                       "CP127_INDEX",
                                       "CP081_INDEX",
                                       "CP082_3_INDEX",
                                       "CP0111_INDEX",
                                       "CP0112_INDEX",
                                       "CP0113_INDEX",
                                       "CP0114_INDEX",
                                       "CP0115_INDEX",
                                       "CP0116_INDEX",
                                       "CP0117_INDEX",
                                       "CP0118_INDEX",
                                       "CP0119_INDEX",
                                       "CP0121_INDEX",
                                       "CP0122_INDEX",
                                       "CP0211_INDEX",
                                       "CP0212_INDEX",
                                       "CP0213_INDEX",
                                       "CP0220_INDEX",
                                       "CP0311_INDEX",
                                       "CP0312_INDEX",
                                       "CP0313_INDEX",
                                       "CP032_INDEX",
                                       "CP0431_INDEX",
                                       "CP0441_INDEX",
                                       "CP0451_INDEX",
                                       "CP0452_INDEX",
                                       "CP0453_INDEX",
                                       "CP0454_INDEX",
                                       "CP0455_INDEX",
                                       "CP0511_INDEX",
                                       "CP0512_INDEX",
                                       "CP0520_INDEX",
                                       "CP0531_2_INDEX",
                                       "CP0540_INDEX",
                                       "CP055_INDEX",
                                       "CP0561_INDEX",
                                       "CP0611_INDEX",
                                       "CP0612_3_INDEX",
                                       "CP0711_INDEX",
                                       "CP0712_3_4_INDEX",
                                       "CP0721_INDEX",
                                       "CP0722_INDEX",
                                       "CP0911_INDEX",
                                       "CP0912_INDEX",
                                       "CP0913_INDEX",
                                       "CP0914_INDEX",
                                       "CP0921_2_INDEX",
                                       "CP0931_INDEX",
                                       "CP0932_INDEX",
                                       "CP0933_INDEX",
                                       "CP0934_5_INDEX",
                                       "CP0951_INDEX",
                                       "CP0952_INDEX",
                                       "CP0953_4_INDEX",
                                       "CP1212_3_INDEX",
                                       "CP1231_INDEX",
                                       "CP1232_INDEX")


#contributions of each component requires additional 

CONTR_GOODS_SERVICES_CP0411<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0411_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0411_XTS
CONTR_GOODS_SERVICES_CP0432<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0432_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0432_XTS
CONTR_GOODS_SERVICES_CP0442<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0442_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0442_XTS
CONTR_GOODS_SERVICES_CP0443<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0443_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0443_XTS
CONTR_GOODS_SERVICES_CP0444<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0444_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0444_XTS
CONTR_GOODS_SERVICES_CP0533<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0533_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0533_XTS
CONTR_GOODS_SERVICES_CP0562<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0562_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0562_XTS
CONTR_GOODS_SERVICES_CP1252<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1252_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP1252_XTS
CONTR_GOODS_SERVICES_CP0314<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0314_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0314_XTS
CONTR_GOODS_SERVICES_CP0915<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0915_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0915_XTS
CONTR_GOODS_SERVICES_CP0941<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0941_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0941_XTS
CONTR_GOODS_SERVICES_CP0942<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0942_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0942_XTS
CONTR_GOODS_SERVICES_CP1111<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1111_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP1111_XTS
CONTR_GOODS_SERVICES_CP1112<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1112_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP1112_XTS
CONTR_GOODS_SERVICES_CP1211<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1211_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP1211_XTS
CONTR_GOODS_SERVICES_CP0723<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0723_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0723_XTS
CONTR_GOODS_SERVICES_CP0724<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0724_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0724_XTS
CONTR_GOODS_SERVICES_CP0731<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0731_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0731_XTS
CONTR_GOODS_SERVICES_CP0732<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0732_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0732_XTS
CONTR_GOODS_SERVICES_CP0733<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0733_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0733_XTS
CONTR_GOODS_SERVICES_CP0734<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0734_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0734_XTS
CONTR_GOODS_SERVICES_CP0735<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0735_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0735_XTS
CONTR_GOODS_SERVICES_CP0736<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0736_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0736_XTS
CONTR_GOODS_SERVICES_CP096<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP096_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP096_XTS
CONTR_GOODS_SERVICES_CP112<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP112_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP112_XTS
CONTR_GOODS_SERVICES_CP0621_3<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0621_3_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO_CP0621_3_XTS
CONTR_GOODS_SERVICES_CP0622<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0622_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0622_XTS
CONTR_GOODS_SERVICES_CP063<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP063_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP063_XTS
CONTR_GOODS_SERVICES_CP10<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP10_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP10_XTS
CONTR_GOODS_SERVICES_CP124<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP124_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP124_XTS
CONTR_GOODS_SERVICES_CP1253<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1253_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP1253_XTS
CONTR_GOODS_SERVICES_CP1254<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1254_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP1254_XTS
CONTR_GOODS_SERVICES_CP126<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP126_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP126_XTS
CONTR_GOODS_SERVICES_CP127<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP127_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP127_XTS
CONTR_GOODS_SERVICES_CP081<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP081_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP081_XTS
CONTR_GOODS_SERVICES_CP082_3<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP082_3_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP082_3_XTS
CONTR_GOODS_SERVICES_CP0111<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0111_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0111_XTS
CONTR_GOODS_SERVICES_CP0112<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0112_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0112_XTS
CONTR_GOODS_SERVICES_CP0113<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0113_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0113_XTS
CONTR_GOODS_SERVICES_CP0114<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0114_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0114_XTS
CONTR_GOODS_SERVICES_CP0115<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0115_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0115_XTS
CONTR_GOODS_SERVICES_CP0116<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0116_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0116_XTS
CONTR_GOODS_SERVICES_CP0117<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0117_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0117_XTS
CONTR_GOODS_SERVICES_CP0118<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0118_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0118_XTS
CONTR_GOODS_SERVICES_CP0119<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0119_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0119_XTS
CONTR_GOODS_SERVICES_CP0121<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0121_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0121_XTS
CONTR_GOODS_SERVICES_CP0122<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0122_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0122_XTS
CONTR_GOODS_SERVICES_CP0211<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0211_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0211_XTS
CONTR_GOODS_SERVICES_CP0212<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0212_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0212_XTS
CONTR_GOODS_SERVICES_CP0213<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0213_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0213_XTS
CONTR_GOODS_SERVICES_CP0220<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0220_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0220_XTS
CONTR_GOODS_SERVICES_CP0311<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0311_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0311_XTS
CONTR_GOODS_SERVICES_CP0312<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0312_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0312_XTS
CONTR_GOODS_SERVICES_CP0313<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0313_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0313_XTS
CONTR_GOODS_SERVICES_CP032<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP032_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP032_XTS
CONTR_GOODS_SERVICES_CP0431<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0431_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0431_XTS
CONTR_GOODS_SERVICES_CP0441<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0441_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0441_XTS
CONTR_GOODS_SERVICES_CP0451<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0451_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0451_XTS
CONTR_GOODS_SERVICES_CP0452<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0452_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0452_XTS
CONTR_GOODS_SERVICES_CP0453<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0453_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0453_XTS
CONTR_GOODS_SERVICES_CP0454<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0454_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0454_XTS
CONTR_GOODS_SERVICES_CP0455<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0455_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0455_XTS
CONTR_GOODS_SERVICES_CP0511<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0511_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0511_XTS
CONTR_GOODS_SERVICES_CP0512<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0512_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0512_XTS
CONTR_GOODS_SERVICES_CP0520<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0520_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0520_XTS
CONTR_GOODS_SERVICES_CP0531_2<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0531_2_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0531_2_XTS
CONTR_GOODS_SERVICES_CP0540<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0540_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0540_XTS
CONTR_GOODS_SERVICES_CP055<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP055_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP055_XTS
CONTR_GOODS_SERVICES_CP0561<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0561_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0561_XTS
CONTR_GOODS_SERVICES_CP0611<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0611_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0611_XTS
CONTR_GOODS_SERVICES_CP0612_3<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0612_3_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0612_3_XTS
CONTR_GOODS_SERVICES_CP0711<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0711_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0711_XTS
CONTR_GOODS_SERVICES_CP0712_3_4<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0712_3_4_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0712_3_4_XTS
CONTR_GOODS_SERVICES_CP0721<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0721_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0721_XTS
CONTR_GOODS_SERVICES_CP0722<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0722_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0722_XTS
CONTR_GOODS_SERVICES_CP0911<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0911_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0911_XTS
CONTR_GOODS_SERVICES_CP0912<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0912_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0912_XTS
CONTR_GOODS_SERVICES_CP0913<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0913_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0913_XTS
CONTR_GOODS_SERVICES_CP0914<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0914_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0914_XTS
CONTR_GOODS_SERVICES_CP0921_2<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0921_2_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0921_2_XTS
CONTR_GOODS_SERVICES_CP0931<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0931_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0931_XTS
CONTR_GOODS_SERVICES_CP0932<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0932_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0932_XTS
CONTR_GOODS_SERVICES_CP0933<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0933_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0933_XTS
CONTR_GOODS_SERVICES_CP0934_5<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0934_5_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0934_5_XTS
CONTR_GOODS_SERVICES_CP0951<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0951_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0951_XTS
CONTR_GOODS_SERVICES_CP0952<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0952_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0952_XTS
CONTR_GOODS_SERVICES_CP0953_4<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0953_4_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP0953_4_XTS
CONTR_GOODS_SERVICES_CP1212_3<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1212_3_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP1212_3_XTS
CONTR_GOODS_SERVICES_CP1231<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1231_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP1231_XTS
CONTR_GOODS_SERVICES_CP1232<-Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1232_INDEX)*	WEIGHTS_GOODS_SERVICES_COMBO$CP1232_XTS







OVERALL_CONTR_GOODS_SERVICES<-merge(CONTR_GOODS_SERVICES_CP0411
,CONTR_GOODS_SERVICES_CP0432
,CONTR_GOODS_SERVICES_CP0442
,CONTR_GOODS_SERVICES_CP0443
,CONTR_GOODS_SERVICES_CP0444
,CONTR_GOODS_SERVICES_CP0533
,CONTR_GOODS_SERVICES_CP0562
,CONTR_GOODS_SERVICES_CP1252
,CONTR_GOODS_SERVICES_CP0314
,CONTR_GOODS_SERVICES_CP0915
,CONTR_GOODS_SERVICES_CP0941
,CONTR_GOODS_SERVICES_CP0942
,CONTR_GOODS_SERVICES_CP1111
,CONTR_GOODS_SERVICES_CP1112
,CONTR_GOODS_SERVICES_CP1211
,CONTR_GOODS_SERVICES_CP0723
,CONTR_GOODS_SERVICES_CP0724
,CONTR_GOODS_SERVICES_CP0731
,CONTR_GOODS_SERVICES_CP0732
,CONTR_GOODS_SERVICES_CP0733
,CONTR_GOODS_SERVICES_CP0734
,CONTR_GOODS_SERVICES_CP0735
,CONTR_GOODS_SERVICES_CP0736
,CONTR_GOODS_SERVICES_CP096
,CONTR_GOODS_SERVICES_CP112
,CONTR_GOODS_SERVICES_CP0621_3
,CONTR_GOODS_SERVICES_CP0622
,CONTR_GOODS_SERVICES_CP063
,CONTR_GOODS_SERVICES_CP10
,CONTR_GOODS_SERVICES_CP124
,CONTR_GOODS_SERVICES_CP1253
,CONTR_GOODS_SERVICES_CP1254
,CONTR_GOODS_SERVICES_CP126
,CONTR_GOODS_SERVICES_CP127
,CONTR_GOODS_SERVICES_CP081
,CONTR_GOODS_SERVICES_CP082_3
,CONTR_GOODS_SERVICES_CP0111
,CONTR_GOODS_SERVICES_CP0112
,CONTR_GOODS_SERVICES_CP0113
,CONTR_GOODS_SERVICES_CP0114
,CONTR_GOODS_SERVICES_CP0115
,CONTR_GOODS_SERVICES_CP0116
,CONTR_GOODS_SERVICES_CP0117
,CONTR_GOODS_SERVICES_CP0118
,CONTR_GOODS_SERVICES_CP0119
,CONTR_GOODS_SERVICES_CP0121
,CONTR_GOODS_SERVICES_CP0122
,CONTR_GOODS_SERVICES_CP0211
,CONTR_GOODS_SERVICES_CP0212
,CONTR_GOODS_SERVICES_CP0213
,CONTR_GOODS_SERVICES_CP0220
,CONTR_GOODS_SERVICES_CP0311
,CONTR_GOODS_SERVICES_CP0312
,CONTR_GOODS_SERVICES_CP0313
,CONTR_GOODS_SERVICES_CP032
,CONTR_GOODS_SERVICES_CP0431
,CONTR_GOODS_SERVICES_CP0441
,CONTR_GOODS_SERVICES_CP0451
,CONTR_GOODS_SERVICES_CP0452
,CONTR_GOODS_SERVICES_CP0453
,CONTR_GOODS_SERVICES_CP0454
,CONTR_GOODS_SERVICES_CP0455
,CONTR_GOODS_SERVICES_CP0511
,CONTR_GOODS_SERVICES_CP0512
,CONTR_GOODS_SERVICES_CP0520
,CONTR_GOODS_SERVICES_CP0531_2
,CONTR_GOODS_SERVICES_CP0540
,CONTR_GOODS_SERVICES_CP055
,CONTR_GOODS_SERVICES_CP0561
,CONTR_GOODS_SERVICES_CP0611
,CONTR_GOODS_SERVICES_CP0612_3
,CONTR_GOODS_SERVICES_CP0711
,CONTR_GOODS_SERVICES_CP0712_3_4
,CONTR_GOODS_SERVICES_CP0721
,CONTR_GOODS_SERVICES_CP0722
,CONTR_GOODS_SERVICES_CP0911
,CONTR_GOODS_SERVICES_CP0912
,CONTR_GOODS_SERVICES_CP0913
,CONTR_GOODS_SERVICES_CP0914
,CONTR_GOODS_SERVICES_CP0921_2
,CONTR_GOODS_SERVICES_CP0931
,CONTR_GOODS_SERVICES_CP0932
,CONTR_GOODS_SERVICES_CP0933
,CONTR_GOODS_SERVICES_CP0934_5
,CONTR_GOODS_SERVICES_CP0951
,CONTR_GOODS_SERVICES_CP0952
,CONTR_GOODS_SERVICES_CP0953_4
,CONTR_GOODS_SERVICES_CP1212_3
,CONTR_GOODS_SERVICES_CP1231
,CONTR_GOODS_SERVICES_CP1232)

colnames(OVERALL_CONTR_GOODS_SERVICES)<-c("CP0411","CP0432","CP0442","CP0443","CP0444","CP0533","CP0562","CP1252","CP0314",
"CP0915","CP0941","CP0942","CP1111","CP1112","CP1211","CP0723","CP0724","CP0731","CP0732","CP0733","CP0734","CP0735","CP0736","CP096","CP112"
,"CP0621_3","CP0622","CP063","CP10","CP124","CP1253","CP1254","CP126","CP127","CP081","CP082","CP0111","CP0112","CP0113","CP0114","CP0115","CP0116","CP0117","CP0118",
"CP0119","CP0121","CP0122","CP0211","CP0212","CP0213","CP0220","CP0311","CP0312","CP0313","CP032","CP0431","CP0441","CP0451","CP0452","CP0453",
"CP0454","CP0455","CP0511","CP0512","CP0520","CP0531","CP0540","CP055","CP0561","CP0611","CP0612","CP0711","CP0712","CP0721",
"CP0722","CP0911","CP0912","CP0913","CP0914","CP0921","CP0931","CP0932","CP0933","CP0934","CP0951","CP0952",
"CP0953","CP1212","CP1231","CP1232")



OVERALL_CONTR_GOODS_SERVICES_sum<-data.frame(NA, nrow=length(index(OVERALL_CONTR_GOODS_SERVICES["2017/"])))

OVERALL_CONTR_GOODS_SERVICES[is.na(OVERALL_CONTR_GOODS_SERVICES)]<-0

for (i in 1:length(index(OVERALL_CONTR_GOODS_SERVICES["2017/"]))) {
  OVERALL_CONTR_GOODS_SERVICES_sum[i]<-sum(as.numeric(OVERALL_CONTR_GOODS_SERVICES["2017/"][i]))
}


#working out the index using the december base
Overall_XTS<-as.xts(t(OVERALL_CONTR_GOODS_SERVICES_sum),order.by = index(OVERALL_CONTR_GOODS_SERVICES))
DEC_BASE_HICP_CONTRIBUTION<-(as.numeric(OVERALL_HICP_XTS[paste0(year(OVERALL_HICP_XTS["2016/"]), "-12-01")])) 
overall_good_services_index<-(Overall_XTS)*DEC_BASE_HICP_CONTRIBUTION[1:length(Overall_XTS["2017/"])]



inflation_excel<-data.frame(index(TOTAL_CONTR_CORE_SER_sum),TOTAL_CONTR_CORE_SER_sum,overall_service_index,TOTAL_CONTR_Unprocessed_food_sum,TOTAL_CONTR_Processed_food_sum,overall_good_services_index)

colnames(inflation_excel)<-c("Date","Core Services (2015= 100)","Overall Services (2015= 100)", "Unprocessed Food (2015= 100)","Processed Food (2015= 100)","Overall HICP Index (2015=100)")

write.xlsx(inflation_excel,  file = paste0(Sys.Date(),'_inflation_excel.xlsx'))


chained_index<-merge(
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0411_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0432_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0442_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0443_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0444_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0533_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0562_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1252_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0314_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0915_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0941_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0942_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1111_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1112_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1211_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0723_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0724_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0731_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0732_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0733_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0734_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0735_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0736_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP096_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP112_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0621_3_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0622_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP063_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP10_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP124_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1253_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1254_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP126_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP127_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP081_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP082_3_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0111_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0112_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0113_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0114_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0115_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0116_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0117_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0118_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0119_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0121_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0122_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0211_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0212_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0213_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0220_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0311_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0312_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0313_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP032_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0431_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0441_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0451_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0452_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0453_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0454_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0455_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0511_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0512_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0520_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0531_2_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0540_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP055_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0561_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0611_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0612_3_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0711_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0712_3_4_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0721_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0722_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0911_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0912_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0913_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0914_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0921_2_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0931_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0932_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0933_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0934_5_INDEX),
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0951_INDEX),	
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0952_INDEX),
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP0953_4_INDEX),
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1212_3_INDEX),
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1231_INDEX),
Chainlinking(SERVICES_GOODS_XTS_INDEX$CP1232_INDEX)
)





growth_index<-growth(SERVICES_GOODS_XTS_INDEX["2017/"],12) 


OVERALL_INDEX<-overall_good_services_index/lag.xts(overall_good_services_index,12)

WEIGHTS_GOODS_SERVICES_COMBO$CP0621_XTS<-WEIGHTS_GOODS_SERVICES_COMBO_CP0621_3_XTS


combo_weight<-WEIGHTS_GOODS_SERVICES_COMBO[,!colnames(WEIGHTS_GOODS_SERVICES_COMBO) %in% c("CP0623_XTS")]
contribution_growth_overall<-growth_index["2018/"]* lag.xts(combo_weight["2017/"],12)




OVERALL_INDEX_DEC_ONE_YEARLAG<-data.frame(matrix(NA, ncol=1,nrow=nrow((SERVICES_GOODS_XTS_INDEX$CP0411_INDEX["2017/"])))) %>%as.xts(order.by=(as.Date(index(SERVICES_GOODS_XTS_INDEX$CP0411_INDEX["2017/"]))))
OVERALL_INDEX_DEC_ONE_YEARLAG["2017/2022"]<-data.frame(lag.xts(OVERALL_HICP_XTS[paste0(year(SERVICES_GOODS_XTS_INDEX["2017/2022"]), "-12-01")],12)) %>% as.xts(index(SERVICES_GOODS_XTS_INDEX["2017/2022"]))
OVERALL_INDEX_DEC_ONE_YEARLAG["2023/"]<-OVERALL_HICP_XTS["2022-12-01"]



OVERALL_INDEX_ONE_YEARLAG<-(lag.xts(OVERALL_HICP_XTS["2017/"],12))

OVERALL_INDEX_DEC_TWO_YEARLAG<-data.frame(matrix(NA, ncol=1,nrow=nrow((SERVICES_GOODS_XTS_INDEX$CP0411_INDEX["2017/"])))) %>%as.xts(order.by=(as.Date(index(SERVICES_GOODS_XTS_INDEX$CP0411_INDEX["2017/"]))))
OVERALL_INDEX_DEC_TWO_YEARLAG["2017/2022"]<-data.frame(lag.xts(OVERALL_HICP_XTS[paste0(year(SERVICES_GOODS_XTS_INDEX["2017/2022"]), "-12-01")],24))%>% as.xts(index(SERVICES_GOODS_XTS_INDEX["2017/2022"]))
OVERALL_INDEX_DEC_TWO_YEARLAG["2023/"]<-OVERALL_HICP_XTS["2021-12-01"]


IND_WEIGHT_ONE_YEARLAG<-(combo_weight["2017/"])

IND_INDEX_DEC_ONE_YEARLAG<-data.frame(matrix(NA, ncol=ncol(SERVICES_GOODS_XTS_INDEX),nrow=nrow((SERVICES_GOODS_XTS_INDEX$CP0411_INDEX["2017/"])))) %>% as.xts(order.by=(as.Date(index(SERVICES_GOODS_XTS_INDEX$CP0411_INDEX["2017/"]))))

for(i in 1:ncol(SERVICES_GOODS_XTS_INDEX)){
IND_INDEX_DEC_ONE_YEARLAG["2017/2022",i]<-(lag.xts(SERVICES_GOODS_XTS_INDEX[paste0(year(SERVICES_GOODS_XTS_INDEX["2017/2022"]), "-12-01")],12))[,i]
}


for(i in 1:ncol(SERVICES_GOODS_XTS_INDEX)){
IND_INDEX_DEC_ONE_YEARLAG["2023/",i]<-SERVICES_GOODS_XTS_INDEX["2022-12-01"][,i]
}

colnames(IND_INDEX_DEC_ONE_YEARLAG)<-names(SERVICES_GOODS_XTS_INDEX)



IND_INDEX_ONE_YEARLAG<-(lag.xts(SERVICES_GOODS_XTS_INDEX,12))

IND_WEIGHT_TWO_YEARLAG<-lag.xts(combo_weight["2017/"],12)


IND_INDEX_DEC_TWO_YEARLAG<-data.frame(matrix(NA, ncol=ncol(SERVICES_GOODS_XTS_INDEX),nrow=nrow((SERVICES_GOODS_XTS_INDEX$CP0411_INDEX["2017/"])))) %>% as.xts(order.by=(as.Date(index(SERVICES_GOODS_XTS_INDEX$CP0411_INDEX["2017/"]))))

for(i in 1:ncol(SERVICES_GOODS_XTS_INDEX)){
IND_INDEX_DEC_TWO_YEARLAG["2017/2022",i]<-(lag.xts(SERVICES_GOODS_XTS_INDEX[paste0(year(SERVICES_GOODS_XTS_INDEX["2017/2022"]), "-12-01")],24))[,i]
}


for(i in 1:ncol(SERVICES_GOODS_XTS_INDEX)){
IND_INDEX_DEC_TWO_YEARLAG["2023/",i]<-SERVICES_GOODS_XTS_INDEX["2021-12-01"][,i]
}

colnames(IND_INDEX_DEC_TWO_YEARLAG)<-names(SERVICES_GOODS_XTS_INDEX)



EQ1<-((OVERALL_INDEX_DEC_ONE_YEARLAG/OVERALL_INDEX_ONE_YEARLAG)*IND_WEIGHT_ONE_YEARLAG$CP0411_XTS)
EQ2  <-((SERVICES_GOODS_XTS_INDEX$CP0411_INDEX-IND_INDEX_DEC_ONE_YEARLAG$CP0411_INDEX)/IND_INDEX_DEC_ONE_YEARLAG$CP0411_INDEX)
EQ3<-((OVERALL_INDEX_DEC_TWO_YEARLAG/OVERALL_INDEX_ONE_YEARLAG)*IND_WEIGHT_TWO_YEARLAG$CP0411_XTS)
EQ4<-((IND_INDEX_DEC_ONE_YEARLAG$CP0411_INDEX-IND_INDEX_ONE_YEARLAG$CP0411_INDEX)/IND_INDEX_DEC_TWO_YEARLAG$CP0411_INDEX)


(EQ1*EQ2)+(EQ3*EQ4)


CONTRIBUTION<-data.frame(matrix(ncol=ncol(SERVICES_GOODS_XTS_INDEX["2017/"]),nrow=length(index(OVERALL_CONTR_GOODS_SERVICES["2017/"]))))
CONTRIBUTION[is.na(CONTRIBUTION)]<-0

for(i in 1:ncol(SERVICES_GOODS_XTS_INDEX)){
  
EQ1<-((OVERALL_INDEX_DEC_ONE_YEARLAG/OVERALL_INDEX_ONE_YEARLAG)*IND_WEIGHT_ONE_YEARLAG[,i]) #
EQ2  <-((SERVICES_GOODS_XTS_INDEX[,i]-IND_INDEX_DEC_ONE_YEARLAG[,i])/IND_INDEX_DEC_ONE_YEARLAG[,i]) #individual index change V's Dec 
EQ3<-((OVERALL_INDEX_DEC_TWO_YEARLAG/OVERALL_INDEX_ONE_YEARLAG)*IND_WEIGHT_TWO_YEARLAG[,i])
EQ4<-((IND_INDEX_DEC_ONE_YEARLAG[,i]-IND_INDEX_ONE_YEARLAG[,i])/IND_INDEX_DEC_TWO_YEARLAG[,i])


CONTRIBUTION[i]<-((EQ1*EQ2)+(EQ3*EQ4))*100

  
}


Index_names<-c("Actual Rent", "Repair of Dwelling","Refuse Collection","Sewerage Collection", "Other Services for Dwellings","Repair of Household Appliances", "Domestic Services and Household Services","Insurance for Dwellings","Cleaning & Repair Clothing","Repair of audio-visual","Recreational & Sporting Services","Cultural Services", "Restaurant, Cafes etc.","Canteens","Hairdressing Salons","Repair Personal Transport","Other services for Personal Transport","Passenger transport by railway","Passenger transport by road","Passenger transport by air","Passenger transport by sea","Combined Passenger transport","Other purchased transport services","Package Holidays","Accomdation Services","Medical Services", "Dental Services","Hospital Services","Education","Social Protection","Healthcare Insurance","Transport Insurance","Financial Services","Other Services","Postal Services","Telephone equipment and services","Bread & Cereals","Meat","Fish","Milk, Cheese,eggs","Oil & Fats","Fruit","Vegetables","Sugar,Jam, Honey, Chocolate","Food Products","Coffee, tea, Cocoa","Mineral Water, Soft Drinks, Vegetable Juices","Spirits","Wine","Beer","Tobacco","Clothing Materials","Garments","Other Clothing","Footwear","Material for the maintenance of dwellings","Water Supply","Electricity","Gas","Liquid Fuel","Solid Fuels","Heat Energy","Furniture","Carpets","Household textiles","Major Household Appliances","Glassware,tableware and Utensils","House & Garden Tools","Non-durable househld goods","Pharma Products","Other medical products", "Motor Cars","Motor Cycles, Bicycles", "Spare parts personal transport", "Fuels & Lubricants for personal transport", "Recording Equipment", "Photographic equipment", "Information processing equipment", "Recording Media", "Musical Instruments", "Games, Toys, hobbies", "Sports & outdoor Equipment","Gardens, plants and flowers", "Pets Products", "Books","Newspapers", "Misc. Print","Electrical Appliances for personal care", "Jewellery, clocks, watches", "Other Personal effects")





colnames(CONTRIBUTION)<-Index_names

write.xlsx(CONTRIBUTION, "inflation_contributions.xlsx")
sort_contribution<-sort(as_vector(CONTRIBUTION[72,1:ncol(CONTRIBUTION)]), decreasing = FALSE) %>% data.frame()



Inflation_Contributions<-(rowSums(CONTRIBUTION,na.rm =TRUE)) %>% data.frame()  


write.xlsx(Inflation_Contributions,file="inflaiton_contributions.xlsx")


colnames(IND_WEIGHT_ONE_YEARLAG)<-Index_names


energy_weight<-IND_WEIGHT_ONE_YEARLAG$Electricity+IND_WEIGHT_ONE_YEARLAG$Gas+IND_WEIGHT_ONE_YEARLAG$`Liquid Fuel`+IND_WEIGHT_ONE_YEARLAG$`Solid Fuels`+IND_WEIGHT_ONE_YEARLAG$`Fuels & Lubricants for personal transport` 



#Contribution energy annual growth
ENERGY<-CONTRIBUTION$Electricity+CONTRIBUTION$Gas+CONTRIBUTION$`Liquid Fuel`+CONTRIBUTION$`Solid Fuels`+CONTRIBUTION$`Fuels & Lubricants for personal transport` 

(ENERGY/energy_weight)


#Contribution food annual growth
FOOD<-CONTRIBUTION$`Bread & Cereals`+CONTRIBUTION$Meat+CONTRIBUTION$Fish+CONTRIBUTION$`Milk, Cheese,eggs`+CONTRIBUTION$`Oil & Fats` +CONTRIBUTION$Fruit+CONTRIBUTION$Vegetables+CONTRIBUTION$`Sugar,Jam, Honey, Chocolate`+CONTRIBUTION$`Food Products`+CONTRIBUTION$`Coffee, tea, Cocoa`+CONTRIBUTION$`Mineral Water, Soft Drinks, Vegetable Juices`+CONTRIBUTION$Spirits+CONTRIBUTION$Wine+CONTRIBUTION$Beer+CONTRIBUTION$Tobacco


#Contribution NEIG annual growth
NEIG<-CONTRIBUTION$Garments+
  CONTRIBUTION$`Other Clothing`+
  CONTRIBUTION$Footwear+
  CONTRIBUTION$`Repair of Dwelling`+
  CONTRIBUTION$Furniture+
  CONTRIBUTION$Carpets+
  CONTRIBUTION$`Household textiles`+
  CONTRIBUTION$`Major Household Appliances`+
  CONTRIBUTION$`Glassware,tableware and Utensils`+
  CONTRIBUTION$`Non-durable househld goods`+CONTRIBUTION$`Pharma Products`+CONTRIBUTION$`Other medical products`+CONTRIBUTION$`Motor Cars`+CONTRIBUTION$`Motor Cycles, Bicycles`+CONTRIBUTION$`Spare parts personal transport`+CONTRIBUTION$`Recording Equipment`+CONTRIBUTION$`Photographic equipment`+CONTRIBUTION$`Information processing equipment`+CONTRIBUTION$`Recording Media`+CONTRIBUTION$`Musical Instruments`+CONTRIBUTION$`Games, Toys, hobbies`+CONTRIBUTION$`Sports & outdoor Equipment`+CONTRIBUTION$`Gardens, plants and flowers`+CONTRIBUTION$`Pets Products`+CONTRIBUTION$Books+CONTRIBUTION$Newspapers+CONTRIBUTION$`Misc. Print`+CONTRIBUTION$`Electrical Appliances for personal care`+CONTRIBUTION$`Jewellery, clocks, watches`+CONTRIBUTION$`Other Personal effects`
  

#Contribution RENT annual growth
Rent<-CONTRIBUTION$`Actual Rent`
  


#Contribution CORE SERVICES annual growth
CORE_SERVICES<-CONTRIBUTION$`Cleaning & Repair Clothing`+
  CONTRIBUTION$`Repair of Dwelling`+
  CONTRIBUTION$`Refuse Collection`+
  CONTRIBUTION$`Other Services for Dwellings`+
  CONTRIBUTION$`Repair of Household Appliances`+
  CONTRIBUTION$`Domestic Services and Household Services`+
  CONTRIBUTION$`Medical Services`+
  CONTRIBUTION$`Dental Services`+
  CONTRIBUTION$`Hospital Services`+
  CONTRIBUTION$`Repair Personal Transport`+
  CONTRIBUTION$`Other services for Personal Transport`+
  CONTRIBUTION$`Passenger transport by railway`+
  CONTRIBUTION$`Passenger transport by road`+
  CONTRIBUTION$`Passenger transport by air`+
  CONTRIBUTION$`Passenger transport by sea`+
  CONTRIBUTION$`Combined Passenger transport`+
  CONTRIBUTION$`Other purchased transport services`+
  CONTRIBUTION$`Postal Services`+
  CONTRIBUTION$`Telephone equipment and services`+
  CONTRIBUTION$`Repair of audio-visual`+
  CONTRIBUTION$`Recreational & Sporting Services`+
  CONTRIBUTION$`Cultural Services`+
  CONTRIBUTION$`Package Holidays`+
  CONTRIBUTION$Education+
  CONTRIBUTION$`Restaurant, Cafes etc.`+
  CONTRIBUTION$Canteens+
  CONTRIBUTION$`Accomdation Services`+
  CONTRIBUTION$`Hairdressing Salons`+
  CONTRIBUTION$`Social Protection`+
  CONTRIBUTION$`Insurance for Dwellings`+
  CONTRIBUTION$`Healthcare Insurance`+
  CONTRIBUTION$`Transport Insurance`+
  CONTRIBUTION$`Financial Services`+
  CONTRIBUTION$`Other Services`
  
  
  
summary_contribution<-data.frame(merge(NEIG["2020/"],FOOD["2020/"],ENERGY["2020/"]),Rent["2020/"],CORE_SERVICES["2020/"],index(ENERGY["2020/"]))


colnames(summary_contribution)<-c("NEIG","Food","Energy","Rent","Core Services","Date")
summary_contribution_melt<-melt(summary_contribution,id=c("Date"))





INFLATION_CON_plot<-ggplot(data=summary_contribution_melt, aes(y=value, x=Date, fill=variable)) + 
  geom_bar(position="stack", stat="identity")+theme(legend.position='bottom',element_text(size=100))+
  labs(x="",
       title="Contribution of Inflation",
       caption="Source: CSO, DOF, Eurostat",
       y="contribution to annual growth (%)")+
  scale_fill_manual(name = "", values  = c("NEIG" = DOF_colours[1],"Food" = DOF_colours[2],"Energy" = DOF_colours[3],"Rent" = DOF_colours[5],"Core Services" = DOF_colours[4]))+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))
  



#Change in annual contribution M-o-M
Contribution_CHANGE<-CONTRIBUTION-lag(CONTRIBUTION)
LATEST_Contribution_CHANGE<-Contribution_CHANGE[nrow(Contribution_CHANGE),]


ENERGY_CHANGE_CONTRIBUTION<-Contribution_CHANGE$Electricity+Contribution_CHANGE$Gas+Contribution_CHANGE$`Liquid Fuel`+Contribution_CHANGE$`Solid Fuels`+Contribution_CHANGE$`Fuels & Lubricants for personal transport` 



#Contribution food annual growth
FOOD_CHANGE_CONTRIBUTION<-Contribution_CHANGE$`Bread & Cereals`+Contribution_CHANGE$Meat+Contribution_CHANGE$Fish+Contribution_CHANGE$`Milk, Cheese,eggs`+Contribution_CHANGE$`Oil & Fats` +Contribution_CHANGE$Fruit+Contribution_CHANGE$Vegetables+Contribution_CHANGE$`Sugar,Jam, Honey, Chocolate`+Contribution_CHANGE$`Food Products`+Contribution_CHANGE$`Coffee, tea, Cocoa`+Contribution_CHANGE$`Mineral Water, Soft Drinks, Vegetable Juices`+Contribution_CHANGE$Spirits+Contribution_CHANGE$Wine+Contribution_CHANGE$Beer+Contribution_CHANGE$Tobacco


#Contribution NEIG annual growth
NEIG_CHANGE_CONTRIBUTION<-Contribution_CHANGE$Garments+
  Contribution_CHANGE$`Other Clothing`+
  Contribution_CHANGE$Footwear+
  Contribution_CHANGE$`Repair of Dwelling`+
  Contribution_CHANGE$Furniture+
  Contribution_CHANGE$Carpets+
  Contribution_CHANGE$`Household textiles`+
  Contribution_CHANGE$`Major Household Appliances`+
  Contribution_CHANGE$`Glassware,tableware and Utensils`+
  Contribution_CHANGE$`Non-durable househld goods`+Contribution_CHANGE$`Pharma Products`+Contribution_CHANGE$`Other medical products`+Contribution_CHANGE$`Motor Cars`+Contribution_CHANGE$`Motor Cycles, Bicycles`+Contribution_CHANGE$`Spare parts personal transport`+Contribution_CHANGE$`Recording Equipment`+Contribution_CHANGE$`Photographic equipment`+Contribution_CHANGE$`Information processing equipment`+Contribution_CHANGE$`Recording Media`+Contribution_CHANGE$`Musical Instruments`+Contribution_CHANGE$`Games, Toys, hobbies`+Contribution_CHANGE$`Sports & outdoor Equipment`+Contribution_CHANGE$`Gardens, plants and flowers`+Contribution_CHANGE$`Pets Products`+Contribution_CHANGE$Books+Contribution_CHANGE$Newspapers+Contribution_CHANGE$`Misc. Print`+Contribution_CHANGE$`Electrical Appliances for personal care`+Contribution_CHANGE$`Jewellery, clocks, watches`+Contribution_CHANGE$`Other Personal effects`
  

#Contribution RENT annual growth
Rent_CHANGE_CONTRIBUTION<-Contribution_CHANGE$`Actual Rent`
  


#Contribution RENT annual growth
CORE_SERVICES_CHANGE_CONTRIBUTION<-Contribution_CHANGE$`Cleaning & Repair Clothing`+
  Contribution_CHANGE$`Repair of Dwelling`+
  Contribution_CHANGE$`Refuse Collection`+
  Contribution_CHANGE$`Other Services for Dwellings`+
  Contribution_CHANGE$`Repair of Household Appliances`+
  Contribution_CHANGE$`Domestic Services and Household Services`+
  Contribution_CHANGE$`Medical Services`+
  Contribution_CHANGE$`Dental Services`+
  Contribution_CHANGE$`Hospital Services`+
  Contribution_CHANGE$`Repair Personal Transport`+
  Contribution_CHANGE$`Other services for Personal Transport`+
  Contribution_CHANGE$`Passenger transport by railway`+
  Contribution_CHANGE$`Passenger transport by road`+
  Contribution_CHANGE$`Passenger transport by air`+
  Contribution_CHANGE$`Passenger transport by sea`+
  Contribution_CHANGE$`Combined Passenger transport`+
  Contribution_CHANGE$`Other purchased transport services`+
  Contribution_CHANGE$`Postal Services`+
  Contribution_CHANGE$`Telephone equipment and services`+
  Contribution_CHANGE$`Repair of audio-visual`+
  Contribution_CHANGE$`Recreational & Sporting Services`+
  Contribution_CHANGE$`Cultural Services`+
  Contribution_CHANGE$`Package Holidays`+
  Contribution_CHANGE$Education+
  Contribution_CHANGE$`Restaurant, Cafes etc.`+
  Contribution_CHANGE$Canteens+
  Contribution_CHANGE$`Accomdation Services`+
  Contribution_CHANGE$`Hairdressing Salons`+
  Contribution_CHANGE$`Social Protection`+
  Contribution_CHANGE$`Insurance for Dwellings`+
  Contribution_CHANGE$`Healthcare Insurance`+
  Contribution_CHANGE$`Transport Insurance`+
  Contribution_CHANGE$`Financial Services`+
  Contribution_CHANGE$`Other Services`





latest_annual_Change_contributions<-data.frame(Inflation_Contributions[nrow(Inflation_Contributions)-1,],ENERGY_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)],FOOD_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)],NEIG_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)],Rent_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)],CORE_SERVICES_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)]) %>% round(2) 


Previous<-format((summary_contribution$Date)[length((summary_contribution$Date))-1],format="%b-%Y")
CURRENT<-format((summary_contribution$Date)[length((summary_contribution$Date))],format="%b-%Y")

colnames(latest_annual_Change_contributions)<-c(Previous,"Energy","Food","NEIG","Rent", "Core Services")


latest_annual_Change_contributions<-melt(latest_annual_Change_contributions)
latest_annual_Change_contributions$colour <- ifelse(latest_annual_Change_contributions$value < 0, DOF_colours[1],DOF_colours[2])

waterfall_graph_change_annual_inflation<-latest_annual_Change_contributions  %>% waterfall(calc_total=TRUE, fill_by_sign =FALSE,  fill_colours = latest_annual_Change_contributions$colour,  total_rect_color = DOF_colours[2], total_axis_text=CURRENT,scale_y_to_waterfall=TRUE)+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))+theme_bw()+coord_cartesian(ylim=c(sum(latest_annual_Change_contributions$value)-1, max(latest_annual_Change_contributions$value)+1))+scale_fill_manual(values=c(positive="firebrick1",negative="steelblue"))




#UPDATED WEIGHT BELOW
#ENERGY<-(combo_weight$CP0451_XTS*1.4)+(combo_weight$CP0452_XTS*1.2)+combo_weight$CP0453_XTS+combo_weight$CP0454_XTS+combo_weight$CP0455_XTS+combo_weight$CP0722_XTS






WEIGHTS_GOODS_SERVICES_COMBO<-merge(SERVICES_GOODS_XTS_WEIGHT["2017/"],index(PROCESSED_FOOD_INDEX["2017/"]))


TOTAL_WEIGHT<-merge(
WEIGHTS_GOODS_SERVICES_COMBO$CP0411_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0432_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0442_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0443_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0444_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0533_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0562_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP1252_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0314_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0915_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0941_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0942_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP1111_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP1112_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP1211_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0723_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0724_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0731_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0732_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0733_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0734_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0735_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0736_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP096_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP112_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO_CP0621_3_XTS,	
WEIGHTS_GOODS_SERVICES_COMBO$CP0622_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP063_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP10_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP124_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP1253_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP1254_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP126_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP127_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP081_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP082_3_XTS,	
WEIGHTS_GOODS_SERVICES_COMBO$CP0111_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0112_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0113_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0114_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0115_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0116_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0117_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0118_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0119_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0121_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0122_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0211_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0212_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0213_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0220_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0311_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0312_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0313_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP032_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0431_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0441_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0451_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0452_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0453_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0454_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0455_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0511_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0512_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0520_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0531_2_XTS,	
WEIGHTS_GOODS_SERVICES_COMBO$CP0540_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP055_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0561_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0611_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0612_3_XTS,	
WEIGHTS_GOODS_SERVICES_COMBO$CP0711_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0712_3_4_XTS,
WEIGHTS_GOODS_SERVICES_COMBO$CP0721_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0722_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0911_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0912_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0913_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0914_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0921_2_XTS,	
WEIGHTS_GOODS_SERVICES_COMBO$CP0931_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0932_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0933_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0934_5_XTS,	
WEIGHTS_GOODS_SERVICES_COMBO$CP0951_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0952_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP0953_4_XTS,	
WEIGHTS_GOODS_SERVICES_COMBO$CP1212_3_XTS,	
WEIGHTS_GOODS_SERVICES_COMBO$CP1231_XTS,		
WEIGHTS_GOODS_SERVICES_COMBO$CP1232_XTS)		

  




#trimmed mean below

growth_SERVICES_GOODS<-growth(SERVICES_GOODS_XTS_INDEX,freq=12)

x=(growth_SERVICES_GOODS) %>% data.frame()
length<-round(ncol(x)*0.50)



exclude_top<-colnames((sort(as_vector(x[200,]),decreasing=TRUE))[1:23]) 
exclude_bottom<-colnames((sort(as_vector(x[200,]),decreasing=FALSE))[1:23])

exclude<-c(exclude_bottom,exclude_top)


Trimmed_SERVICES_GOODS<-data.frame(NA, nrow=length(index(SERVICES_GOODS_XTS_INDEX["2017/"])))

x<-as.xts(x)  
x<-x["2017/"]

DF<-data.frame(matrix(nrow = nrow(x), ncol = 23)) 


for(i in 1:(nrow(x))){
DF[i,]  <-t(data.frame(colnames(x[i,sort.list(as.array(x[i]),decreasing = TRUE)]))) 
}


DF_decreased<-data.frame(matrix(nrow = nrow(x), ncol = 23)) 


##ERROR 
for(i in 1:(nrow(x))){
  DF_decreased[i,]  <-t(data.frame(colnames(x[i,sort.list(as.array(x[i]),decreasing = FALSE)]))) 
}



exclusion_list<-cbind(DF,DF_decreased) %>% data.frame()



DF_INDEX<-data.frame(matrix(nrow = nrow(x), ncol = ncol(x)-46)) 


for(i in 1:(nrow(x))){
  DF_INDEX[i,]<-select(data.frame(x[i,]),-((paste(exclusion_list[i,])))) %>% colnames() 
  
  }

DF_INDEX_XTS<-as.xts(DF_INDEX,order.by = floor_date(index(x)))


DF_NAME_4_WEIGHT<-gsub("_INDEX","",DF_INDEX_XTS)


TOTAL_WEIGHT<-as.xts(TOTAL_WEIGHT)



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0411_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0411_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0411_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0411_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0411_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0114_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0432_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0432_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0432_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0432_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0432_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0442_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0442_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0442_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0442_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0442_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0443_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0443_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0443_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0443_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0443_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0444_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0444_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0444_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0444_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0444_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0533_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0533_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0533_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0533_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0533_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0562_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0562_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0562_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0562_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0562_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP1252_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP1252_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1252_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP1252_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1252_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0314_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0314_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0314_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0314_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0314_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0915_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0915_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0915_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0915_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0915_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0941_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0941_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0941_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0941_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0941_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0942_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0942_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0942_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0942_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0942_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP1111_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP1111_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1111_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP1111_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1111_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP1112_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP1112_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1112_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP1112_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1112_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP1211_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP1211_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1211_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP1211_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1211_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0723_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0723_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0723_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0723_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0723_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0724_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0724_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0724_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0724_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0724_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0731_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0731_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0731_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0731_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0731_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0732_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0732_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0732_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0732_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0732_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0733_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0733_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0733_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0733_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0733_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0734_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0734_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0734_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0734_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0734_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0734_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0734_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0734_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0734_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0734_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0735_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0735_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0735_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0735_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0735_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0736_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0736_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0736_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0736_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0736_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP096_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP096_XTS["2017/"][i]<-TOTAL_WEIGHT$CP096_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP096_XTS["2017/"][i]<-TOTAL_WEIGHT$CP096_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP112_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP112_XTS["2017/"][i]<-TOTAL_WEIGHT$CP112_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP112_XTS["2017/"][i]<-TOTAL_WEIGHT$CP112_XTS["2017/"][i]
  }
}





#########################################################################




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0621_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0621_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0621_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0621_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0621_XTS["2017/"][i]
  }
}






for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0622_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0622_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0622_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0622_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0622_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP063_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP063_XTS["2017/"][i]<-TOTAL_WEIGHT$CP063_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP063_XTS["2017/"][i]<-TOTAL_WEIGHT$CP063_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP10_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP10_XTS["2017/"][i]<-TOTAL_WEIGHT$CP10_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP10_XTS["2017/"][i]<-TOTAL_WEIGHT$CP10_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP124_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP124_XTS["2017/"][i]<-TOTAL_WEIGHT$CP124_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP124_XTS["2017/"][i]<-TOTAL_WEIGHT$CP124_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP1253_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP1253_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1253_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP1253_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1253_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP1254_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP1254_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1254_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP1254_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1254_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP126_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP126_XTS["2017/"][i]<-TOTAL_WEIGHT$CP126_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP126_XTS["2017/"][i]<-TOTAL_WEIGHT$CP126_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP127_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP127_XTS["2017/"][i]<-TOTAL_WEIGHT$CP127_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP127_XTS["2017/"][i]<-TOTAL_WEIGHT$CP127_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP081_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP081_XTS["2017/"][i]<-TOTAL_WEIGHT$CP081_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP081_XTS["2017/"][i]<-TOTAL_WEIGHT$CP081_XTS["2017/"][i]
  }
}





for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP082_3_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP082_3_XTS["2017/"][i]<-TOTAL_WEIGHT$CP082_3_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP082_3_XTS["2017/"][i]<-TOTAL_WEIGHT$CP082_3_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0111_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0111_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0111_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0111_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0111_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0112_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0112_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0112_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0112_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0112_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0113_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0113_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0113_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0113_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0113_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0114_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0114_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0114_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0114_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0114_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0115_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0115_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0115_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0115_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0115_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0116_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0116_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0116_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0116_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0116_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0117_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0117_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0117_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0117_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0117_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0118_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0118_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0118_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0118_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0118_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0119_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0119_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0119_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0119_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0119_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0121_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0121_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0121_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0121_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0121_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0122_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0122_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0122_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0122_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0122_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0211_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0211_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0211_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0211_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0211_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0212_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0212_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0212_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0212_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0212_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0213_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0213_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0213_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0213_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0213_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0220_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0220_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0220_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0220_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0220_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0311_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0311_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0311_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0311_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0311_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0312_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0312_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0312_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0312_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0312_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0313_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0313_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0313_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0313_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0313_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP032_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP032_XTS["2017/"][i]<-TOTAL_WEIGHT$CP032_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP032_XTS["2017/"][i]<-TOTAL_WEIGHT$CP032_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0431_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0431_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0431_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0431_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0431_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0441_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0441_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0441_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0441_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0441_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0451_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0451_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0451_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0451_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0451_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0452_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0452_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0452_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0452_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0452_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0453_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0453_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0453_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0453_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0453_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0454_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0454_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0454_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0454_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0454_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0455_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0455_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0455_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0455_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0455_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0511_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0511_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0511_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0511_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0511_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0512_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0512_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0512_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0512_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0512_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0520_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0520_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0520_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0520_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0520_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0531_2_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0531_2_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0531_2_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0531_2_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0531_2_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0540_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0540_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0540_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0540_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0540_XTS["2017/"][i]
  }
}




for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP055_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP055_XTS["2017/"][i]<-TOTAL_WEIGHT$CP055_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP055_XTS["2017/"][i]<-TOTAL_WEIGHT$CP055_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0561_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0561_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0561_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0561_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0561_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0611_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0611_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0611_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0611_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0611_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0612_3_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0612_3_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0612_3_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0612_3_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0612_3_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0711_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0711_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0711_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0711_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0711_XTS["2017/"][i]
  }
}



for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0712_3_4_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0712_3_4_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0712_3_4_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0712_3_4_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0712_3_4_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0721_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0721_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0721_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0721_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0721_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0722_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0722_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0722_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0722_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0722_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0911_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0911_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0911_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0911_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0911_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0912_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0912_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0912_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0912_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0912_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0913_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0913_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0913_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0913_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0913_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0914_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0914_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0914_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0914_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0914_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0921_2_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0921_2_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0921_2_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0921_2_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0921_2_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0931_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0931_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0931_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0931_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0931_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0932_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0932_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0932_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0932_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0932_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0933_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0933_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0933_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0933_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0933_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0934_5_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0934_5_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0934_5_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0934_5_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0934_5_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0951_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0951_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0951_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0951_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0951_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0952_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0952_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0952_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0952_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0952_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP0953_4_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP0953_4_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0953_4_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP0953_4_XTS["2017/"][i]<-TOTAL_WEIGHT$CP0953_4_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP1212_3_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP1212_3_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1212_3_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP1212_3_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1212_3_XTS["2017/"][i]
  }
}

for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP1231_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP1231_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1231_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP1231_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1231_XTS["2017/"][i]
  }
}


for (i in 1:length(PROCESSED_FOOD_INDEX$CP0111_INDEX["2017/"])){
  
  if( is.na(TOTAL_WEIGHT$CP1232_XTS["2017/"][i])){
    TOTAL_WEIGHT$CP1232_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1232_XTS["2017/"][i-1]
  } else {
    TOTAL_WEIGHT$CP1232_XTS["2017/"][i]<-TOTAL_WEIGHT$CP1232_XTS["2017/"][i]
  }
}


colnames(TOTAL_WEIGHT)<-c("CP0411","CP0432","CP0442","CP0443","CP0444","CP0533","CP0562","CP1252","CP0314",
                          "CP0915","CP0941","CP0942","CP1111","CP1112","CP1211","CP0723","CP0724","CP0731","CP0732","CP0733","CP0734","CP0735","CP0736","CP096","CP112","CP0621_3","CP0622","CP063","CP10","CP124","CP1253","CP1254","CP126","CP127","CP081","CP082_3","CP0111","CP0112","CP0113","CP0114","CP0115","CP0116","CP0117","CP0118",
                          "CP0119","CP0121","CP0122","CP0211","CP0212","CP0213","CP0220","CP0311","CP0312","CP0313","CP032","CP0431","CP0441","CP0451","CP0452","CP0453",
                          "CP0454","CP0455","CP0511","CP0512","CP0520","CP0531_2","CP0540","CP055","CP0561","CP0611","CP0612_3","CP0711","CP0712_3_4","CP0721",
                          "CP0722","CP0911","CP0912","CP0913","CP0914","CP0921_2","CP0931","CP0932","CP0933","CP0934_5","CP0951","CP0952",
                          "CP0953_4","CP1212_3","CP1231","CP1232")


DF_WEIGHT_SUM<-data.frame(matrix(nrow = nrow(DF_NAME_4_WEIGHT["2017/"]))) 

DF_NAME_4_WEIGHT_SHORT<-DF_NAME_4_WEIGHT["2017/"] %>% data.frame() %>% as.xts()



TOTAL_WEIGHT<-data.frame(TOTAL_WEIGHT)


for(i in 1:(nrow(DF_NAME_4_WEIGHT_SHORT["2017/"]))){
  DF_WEIGHT_SUM[i,]<-  sum(as.numeric(TOTAL_WEIGHT[i,paste(DF_NAME_4_WEIGHT_SHORT[i,])]))  
  
}


DF_WEIGHT_SUM_XTS<-as.xts(DF_WEIGHT_SUM,order.by=index(DF_NAME_4_WEIGHT["2017/"]))





DF_NAME_4_WEIGHT<-as.xts(DF_NAME_4_WEIGHT)
ADJ_WEIGHT<-data.frame(matrix(nrow = nrow(DF_NAME_4_WEIGHT["2017/"]),ncol=ncol(DF_NAME_4_WEIGHT)))


for(i in 1:(nrow(DF_NAME_4_WEIGHT["2017/"]))){
  ADJ_WEIGHT[i,]<-  (as.numeric(TOTAL_WEIGHT[i,paste(DF_NAME_4_WEIGHT["2017/"][i,])]))/as.numeric(DF_WEIGHT_SUM_XTS[i,])
  
}


ADJ_WEIGHT_XTS<-as.xts(ADJ_WEIGHT,order.by=index(DF_NAME_4_WEIGHT["2017/"]))














#NEED TO WORK OUT THE CONTRIBUTION OF THE INDEX USING THE WEIGHTS

DF_NAME_4_WEIGHT<-gsub("_INDEX","",DF_INDEX_XTS)


data<-as.xts(x["2017/"]) 
colnames(data)<- c(gsub("_INDEX","",colnames(data)))


data[is.na(data)]<-0



Trimmed_growth<-data.frame(matrix(nrow = nrow(DF_NAME_4_WEIGHT["2017/"]))) %>% as.xts(order.by=index(DF_NAME_4_WEIGHT["2017/"])) 


for(i in 1:nrow(DF_NAME_4_WEIGHT["2017/"])){
  for(j in 1:ncol(DF_NAME_4_WEIGHT["2017/"])){
  Trimmed_growth[i]<-  (as.numeric(data[i,paste(DF_NAME_4_WEIGHT[i,])])*as.numeric(ADJ_WEIGHT_XTS["2017/"][i,]))  %>% sum()  
  }
}

Trimmed_growth<-data.frame(Trimmed_growth) 
trim<-as.xts(Trimmed_growth, order.by=index(growth_SERVICES_GOODS["2017/"]))

write.xlsx(trim, file = 'trim.xlsx')






```






```{r Block 2, echo=FALSE, warning=FALSE}
 
graph_data<-merge(trim,GROWTH_OVERALL_XTS,GROWTH_CORE_XTS)
colnames(graph_data)<-c("trim","GROWTH_OVERALL_XTS","GROWTH_CORE_XTS")

y1<-ggplot()+geom_line(data=graph_data["2017/"],aes(x=index(graph_data["2017/"]),y=graph_data$trim["2017/"], colour="DOF Trimmed Inflation"),size=1)+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+
  theme(legend.position=c(0.8,0.2),plot.caption = element_text(hjust=0),legend.background=element_blank())+
    geom_line(data=graph_data["2017/"],aes(x=index(graph_data["2017/"]),y=graph_data$GROWTH_CORE_XTS["2017/"], colour="Core Inflation"),size=1)+

  
  labs(x="",
       title="Annual percentage change in inflation",
       caption="Source: CSO, Eurostat, DOF calculations",
       y="Percentage change (%)")+
  scale_color_manual(name = "", values = c("DOF Trimmed Inflation" = DOF_colours[2],"Core Inflation" = DOF_colours[3]))+
  theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))

trim_graph<-y1+theme(legend.position=c(0.3,0.6),plot.title = element_text(hjust = 0.5))





growth_INDEX<-gsub("_INDEX","",colnames(growth_SERVICES_GOODS))
TOTAL_WEIGHT_NAME<-gsub("_XTS","",colnames(TOTAL_WEIGHT))


colnames(growth_SERVICES_GOODS)<-c(growth_INDEX)
colnames(TOTAL_WEIGHT)<-c(TOTAL_WEIGHT_NAME)


growth_SERVICES_GOODS[is.na(growth_SERVICES_GOODS)]<-0 

below_zero<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS["2017/"]))
betweeen_zero_two<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS["2017/"]))
betweeen_two_five<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS["2017/"]))
over_five<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS["2017/"])) 
zero<-0
two<-2
five<-5



for(i in 1:nrow(growth_SERVICES_GOODS["2017/"])){
for(j in 1:ncol(growth_SERVICES_GOODS["2017/"])){
  if(as.numeric(growth_SERVICES_GOODS["2017/"][i,j])< zero){
    below_zero[i,j]<-(TOTAL_WEIGHT[i,colnames(growth_SERVICES_GOODS["2017/"][i,j])])
    }
  }
}

below_zero<-data.frame(below_zero)
below_zero[is.na(below_zero)]<-0 
below_zero_xts<-below_zero %>% as.xts(order.by=index(WEIGHTS_GOODS_SERVICES_COMBO))
below_zero_xts_sum<-rowSums(below_zero_xts,na.rm=TRUE)


for(i in 1:nrow(growth_SERVICES_GOODS["2017/"])){
  for(j in 1:ncol(growth_SERVICES_GOODS["2017/"])){
    if(between(as.numeric(growth_SERVICES_GOODS["2017/"][i,j]),zero,two)){
      betweeen_zero_two[i,j]<-(TOTAL_WEIGHT[i,colnames(growth_SERVICES_GOODS["2017/"][i,j])])
    }
  }
}


betweeen_zero_two<-data.frame(betweeen_zero_two)
betweeen_zero_two[is.na(betweeen_zero_two)]<-0 
betweeen_zero_two_xts<-betweeen_zero_two %>% as.xts(order.by=index(WEIGHTS_GOODS_SERVICES_COMBO))
betweeen_zero_two_xts_sum<-rowSums(betweeen_zero_two_xts,na.rm=TRUE)




for(i in 1:nrow(growth_SERVICES_GOODS["2017/"])){
  for(j in 1:ncol(growth_SERVICES_GOODS["2017/"])){
    if(between(as.numeric(growth_SERVICES_GOODS["2017/"][i,j]),two,five)){
      betweeen_two_five[i,j]<-(TOTAL_WEIGHT[i,colnames(growth_SERVICES_GOODS["2017/"][i,j])])
    }
  }
}

betweeen_two_five<-data.frame(betweeen_two_five)
betweeen_two_five[is.na(betweeen_two_five)]<-0 
betweeen_two_five_xts<-betweeen_two_five %>% as.xts(order.by=index(WEIGHTS_GOODS_SERVICES_COMBO))
betweeen_two_five_xts_sum<-rowSums(betweeen_two_five_xts,na.rm=TRUE)




    for(i in 1:nrow(growth_SERVICES_GOODS["2017/"])){
      for(j in 1:ncol(growth_SERVICES_GOODS["2017/"])){
          if(as.numeric(growth_SERVICES_GOODS["2017/"][i,j])>five){
      over_five[i,j]<-(TOTAL_WEIGHT[i,colnames(growth_SERVICES_GOODS["2017/"][i,j])])
    }
  }
}


over_five<-data.frame(over_five)
over_five[is.na(over_five)]<-0 
over_five_xts<-over_five %>% as.xts(order.by=index(WEIGHTS_GOODS_SERVICES_COMBO))

over_five_xts_sum<-rowSums(over_five_xts,na.rm=TRUE)



below_zero_xts<-as.xts(below_zero_xts_sum, order.by = index(below_zero_xts))
betweeen_zero_two_xts<-as.xts(betweeen_zero_two_xts_sum, order.by = index(below_zero_xts))
betweeen_two_five_xts<-as.xts(betweeen_two_five_xts_sum, order.by = index(below_zero_xts))
over_five_xts<-as.xts(over_five_xts_sum, order.by = index(below_zero_xts))

inflationbreakdown<-data.frame(index(below_zero_xts),below_zero_xts,betweeen_zero_two_xts,betweeen_two_five_xts,over_five_xts)
colnames(inflationbreakdown)<-c("Date","<0%","0%-2%","2%-5%",">5%")

summary_df_graph_melt<-melt(inflationbreakdown,id=c("Date"))


CONTRIBUTION_INFLATION<-ggplot(data=summary_df_graph_melt, aes(y=value*100, x=Date, fill=variable)) + 
  geom_bar(position="stack", stat="identity")+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"),legend.background=element_blank())+
scale_fill_manual(name = "", values  = c("<0%" = DOF_colours[4],"0%-2%" = DOF_colours[2],"2%-5%" = DOF_colours[3],">5%"=DOF_colours[1]))+
  labs(x="",
       title="Proportion of Inflation Basket",
       caption="Source: CSO, DOF, Eurostat",
       y="")
  
  



over_five_12_Months<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS["2017/"])) 

    for(i in 13:nrow(over_five)){
      for(j in 1:ncol(over_five)){
          if((as.numeric(over_five[i,j])>0)  && (as.numeric(over_five[i-1,j])>0)  && (as.numeric(over_five[i-2,j])>0) && (as.numeric(over_five[i-3,j])>0) && (as.numeric(over_five[i-4,j])>0) && (as.numeric(over_five[i-5,j])>0) && (as.numeric(over_five[i-6,j])>0) && (as.numeric(over_five[i-7,j])>0) && (as.numeric(over_five[i-8,j])>0) && (as.numeric(over_five[i-9,j])>0) && (as.numeric(over_five[i-10,j])>0) && (as.numeric(over_five[i-11,j])>0) ){
      over_five_12_Months[i,j]<-over_five[i,j]
          } else {
      over_five_12_Months[i,j]<-as.numeric(0)

    } 
  }
}


over_five_12_Months_SUM<-na.omit(over_five_12_Months) %>% rowSums() %>% as.xts(order.by=index(growth_SERVICES_GOODS["2018-01-01/"]))
colnames(over_five_12_Months)<-c(Index_names)




#compoisiton weight inflation exclduing energy 

TOTAL_WEIGHT_EX_ENERGY<-subset(TOTAL_WEIGHT, select=-c(CP0451,CP0452,CP0453,CP0454,CP0455,CP0722))
TOTAL_WEIGHT_EX_ENERGY_ADJ<-(TOTAL_WEIGHT_EX_ENERGY/rowSums(TOTAL_WEIGHT_EX_ENERGY)) 




growth_SERVICES_GOODS[is.na(growth_SERVICES_GOODS)]<-0 

growth_SERVICES_GOODS_EX_ENERGY<-subset(growth_SERVICES_GOODS, select=-c(CP0451,CP0452,CP0453,CP0454,CP0455,CP0722))



below_zero_EX_ENERGY<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS_EX_ENERGY["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS_EX_ENERGY["2017/"]))
betweeen_zero_two_EX_ENERGY<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS_EX_ENERGY["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS_EX_ENERGY["2017/"]))
betweeen_two_five_EX_ENERGY<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS_EX_ENERGY["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS_EX_ENERGY["2017/"]))
over_five_EX_ENERGY<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS_EX_ENERGY["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS_EX_ENERGY["2017/"])) 
zero<-0
two<-2
five<-5



for(i in 1:nrow(growth_SERVICES_GOODS_EX_ENERGY["2017/"])){
for(j in 1:ncol(growth_SERVICES_GOODS_EX_ENERGY["2017/"])){
  if(as.numeric(growth_SERVICES_GOODS_EX_ENERGY["2017/"][i,j])< zero){
    below_zero_EX_ENERGY[i,j]<-(TOTAL_WEIGHT_EX_ENERGY_ADJ[i,colnames(growth_SERVICES_GOODS_EX_ENERGY["2017/"][i,j])])
    }
  }
}

below_zero_EX_ENERGY<-data.frame(below_zero_EX_ENERGY)
below_zero_EX_ENERGY[is.na(below_zero_EX_ENERGY)]<-0 
below_zero_EX_ENERGY_xts<-below_zero_EX_ENERGY %>% as.xts(order.by=index(WEIGHTS_GOODS_SERVICES_COMBO))
below_zero_EX_ENERGY_xts_sum<-rowSums(below_zero_EX_ENERGY_xts,na.rm=TRUE)


for(i in 1:nrow(growth_SERVICES_GOODS_EX_ENERGY["2017/"])){
  for(j in 1:ncol(growth_SERVICES_GOODS_EX_ENERGY["2017/"])){
    if(between(as.numeric(growth_SERVICES_GOODS_EX_ENERGY["2017/"][i,j]),zero,two)){
      betweeen_zero_two_EX_ENERGY[i,j]<-(TOTAL_WEIGHT_EX_ENERGY_ADJ[i,colnames(growth_SERVICES_GOODS_EX_ENERGY["2017/"][i,j])])
    }
  }
}


betweeen_zero_two_EX_ENERGY<-data.frame(betweeen_zero_two_EX_ENERGY)
betweeen_zero_two_EX_ENERGY[is.na(betweeen_zero_two_EX_ENERGY)]<-0 
betweeen_zero_two_EX_ENERGY_xts<-betweeen_zero_two_EX_ENERGY %>% as.xts(order.by=index(WEIGHTS_GOODS_SERVICES_COMBO))
betweeen_zero_two_EX_ENERGY_xts_sum<-rowSums(betweeen_zero_two_EX_ENERGY_xts,na.rm=TRUE)




for(i in 1:nrow(growth_SERVICES_GOODS_EX_ENERGY["2017/"])){
  for(j in 1:ncol(growth_SERVICES_GOODS_EX_ENERGY["2017/"])){
    if(between(as.numeric(growth_SERVICES_GOODS_EX_ENERGY["2017/"][i,j]),two,five)){
      betweeen_two_five_EX_ENERGY[i,j]<-(TOTAL_WEIGHT_EX_ENERGY_ADJ[i,colnames(growth_SERVICES_GOODS_EX_ENERGY["2017/"][i,j])])
    }
  }
}

betweeen_two_five_EX_ENERGY<-data.frame(betweeen_two_five_EX_ENERGY)
betweeen_two_five_EX_ENERGY[is.na(betweeen_two_five_EX_ENERGY)]<-0 
betweeen_two_five_EX_ENERGY_xts<-betweeen_two_five_EX_ENERGY %>% as.xts(order.by=index(WEIGHTS_GOODS_SERVICES_COMBO))
betweeen_two_five_EX_ENERGY_xts_sum<-rowSums(betweeen_two_five_EX_ENERGY_xts,na.rm=TRUE)




    for(i in 1:nrow(growth_SERVICES_GOODS_EX_ENERGY["2017/"])){
      for(j in 1:ncol(growth_SERVICES_GOODS_EX_ENERGY["2017/"])){
          if(as.numeric(growth_SERVICES_GOODS_EX_ENERGY["2017/"][i,j])>five){
      over_five_EX_ENERGY[i,j]<-(TOTAL_WEIGHT_EX_ENERGY_ADJ[i,colnames(growth_SERVICES_GOODS_EX_ENERGY["2017/"][i,j])])
    }
  }
}


over_five_EX_ENERGY<-data.frame(over_five_EX_ENERGY)
over_five_EX_ENERGY[is.na(over_five_EX_ENERGY)]<-0 
over_five_EX_ENERGY_xts<-over_five_EX_ENERGY %>% as.xts(order.by=index(WEIGHTS_GOODS_SERVICES_COMBO))

over_five_EX_ENERGY_xts_sum<-rowSums(over_five_EX_ENERGY_xts,na.rm=TRUE)




over_five_12_Months_EX_ENERGY<-matrix(NA,ncol=ncol(growth_SERVICES_GOODS_EX_ENERGY["2017/"]) ,nrow=nrow(growth_SERVICES_GOODS_EX_ENERGY["2017/"])) 

    for(i in 13:nrow(over_five_EX_ENERGY)){
      for(j in 1:ncol(over_five_EX_ENERGY)){
          if((as.numeric(over_five_EX_ENERGY[i,j])>0)  && (as.numeric(over_five_EX_ENERGY[i-1,j])>0)  && (as.numeric(over_five_EX_ENERGY[i-2,j])>0) && (as.numeric(over_five_EX_ENERGY[i-3,j])>0) && (as.numeric(over_five_EX_ENERGY[i-4,j])>0) && (as.numeric(over_five_EX_ENERGY[i-5,j])>0) && (as.numeric(over_five_EX_ENERGY[i-6,j])>0) && (as.numeric(over_five_EX_ENERGY[i-7,j])>0) && (as.numeric(over_five_EX_ENERGY[i-8,j])>0) && (as.numeric(over_five_EX_ENERGY[i-9,j])>0) && (as.numeric(over_five_EX_ENERGY[i-10,j])>0) && (as.numeric(over_five_EX_ENERGY[i-11,j])>0)) {
      over_five_12_Months_EX_ENERGY[i,j]<-over_five_EX_ENERGY[i,j]
          } else {
      over_five_12_Months_EX_ENERGY[i,j]<-as.numeric(0)

    } 
  }
}


over_five_12_Months_EX_ENERGY_SUM<-na.omit(over_five_12_Months_EX_ENERGY) %>% rowSums() %>% as.xts(order.by=index(growth_SERVICES_GOODS["2018-01-01/"]))


over_five_12_Months<-merge(over_five_12_Months_EX_ENERGY_SUM,over_five_12_Months_SUM)
colnames(over_five_12_Months)<-c("Over_5_ex_energy","Over_5")

##starting point new graph 


over_five_12_Months_graph<-ggplot(data=over_five_12_Months,aes(x=index(over_five_12_Months)))+
      geom_line(aes(y=100*(Over_5_ex_energy), color="> 5% 12 months or more (Excl. Energy)"),size=1)+
      geom_line(aes(y=100*(Over_5), color="> 5% 12 months or more"),size=1)+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+
  theme(legend.position="none",plot.caption = element_text(hjust=0))+
  labs(x="",
       title="Composition of Inflation Basket >5%",
       caption="Date Source: CSO, DOF",
       y="")+
    scale_color_manual(name = "", values = c("> 5% 12 months or more (Excl. Energy)" = DOF_colours[1],"> 5% 12 months or more" = DOF_colours[2]))+
  theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))

over_five_12_Months_graph<-over_five_12_Months_graph+ theme(legend.position=c(0.4, 0.5))




EX_ENERGY_COMPO<-data.frame(index(over_five_12_Months_EX_ENERGY_SUM),below_zero_EX_ENERGY_xts_sum[13:length(below_zero_EX_ENERGY_xts_sum)],betweeen_zero_two_EX_ENERGY_xts_sum[13:length(below_zero_EX_ENERGY_xts_sum)],betweeen_two_five_EX_ENERGY_xts_sum[13:length(below_zero_EX_ENERGY_xts_sum)],over_five_EX_ENERGY_xts_sum[13:length(below_zero_EX_ENERGY_xts_sum)],na.omit(over_five_12_Months_EX_ENERGY_SUM))

colnames(EX_ENERGY_COMPO)<-c("Date","<0%","0%-2%","2%-5%",">5%",">5% MORE THAN 12 Months")






graph_data<-as.xts(graph_data)

graph_data_2023<-data.frame(index(graph_data["2018/"]),graph_data["2018/"])
colnames(graph_data_2023)<-c("Date", "Trimmed Inflation","Overall Inflation", "Core Inflation")




Inflation_Excel_20230117 <- createWorkbook()
addWorksheet(Inflation_Excel_20230117,"Aggregate Index")
addWorksheet(Inflation_Excel_20230117,"Composition of Inflation")
addWorksheet(Inflation_Excel_20230117, "Trimmed Mean Inflation")


writeData(Inflation_Excel_20230117,"Aggregate Index",inflation_excel)
writeData(Inflation_Excel_20230117,"Composition of Inflation",inflationbreakdown)
writeData(Inflation_Excel_20230117,"Trimmed Mean Inflation",graph_data_2023)

#print(CONTRIBUTION_INFLATION)
#insertPlot(Inflation_Excel_20230117, 2, width = 5, height = 3.5,  startRow = 1,
#           startCol = 10,fileType = "png", units = "in")


#print(trim_graph)
#insertPlot(Inflation_Excel_20230117, 3, width = 5, height = 3.5,startRow = 1,
#           startCol = 10, fileType = "png", units = "in")



saveWorkbook(Inflation_Excel_20230117, "Inflation_R_Output.xlsx", overwrite = TRUE)

infl_CONTR<-data.frame(inflationbreakdown[13:nrow(inflationbreakdown),],over_five_12_Months_SUM)
colnames(infl_CONTR)<-c("Date","<0%","0%-2%","2%-5%",">5%",">5% MORE THAN 12 Months")
write.xlsx(infl_CONTR, file='INFLATIONOUTPUT.xlsx')




COMPO_INFLATION_EXCEL <- createWorkbook()
addWorksheet(COMPO_INFLATION_EXCEL,"OVERALL")
addWorksheet(COMPO_INFLATION_EXCEL,"EXCL. ENERGY")

writeData(COMPO_INFLATION_EXCEL,"OVERALL",infl_CONTR)
writeData(COMPO_INFLATION_EXCEL,"EXCL. ENERGY",EX_ENERGY_COMPO)

saveWorkbook(COMPO_INFLATION_EXCEL, "COMPO_INFLATION_EXCEL.xlsx", overwrite = TRUE)

















#print(waterfall_graph_change_annual_inflation)

```



```{r inflation text for markdown, warning=FALSE, include=FALSE}


#download data ggplot
#embed_data= function(x= mtcars, filename= "file.csv", label= "Download Graph Data"){

  # Create encoded Base64 datastream 
#  encode_data= function(x){
#    write.csv(x, "./file.csv")
#    enc= sprintf('data:text/csv;base64,%s', openssl::base64_encode(paste0(readLines("./file.csv"), collapse="\n")) )
#    unlink("./file.csv")
#    return(enc)
#  }

  # String result ready to be placed in rmarkdown
 # paste0("<a download='", filename, "' href=", encode_data(x), ">", label, "</a>")

#}









conditional <- function(x){
  if (x > 0) {
    print(paste0("increased by ", round((x), digits = 1),sep="%"))
  } else if (x < 0){
    print(paste0("decreased by ", round((x), digits = 1),sep="%"))
  } else {
    print(paste0("was flat at ", round((x), digits = 1),sep="%"))
  }
}

conditional_alt <- function(x){
  if (x > x) {
    print(paste("pace of growth has increased", round((x), digits = 1,sep="%")))
  } else if (x < 0){
    print(paste("decreasing by", round((x), digits = 1,sep="%")))
  } else {
    print(paste("flat at", round((x), digits = 1,sep="%")))
  }
}

conditional_alt2 <- function(x){
  if (x > 0) {
    (paste(round((x), digits = 1)," higher than ",sep="%"))
  } else if (x < 0){
    (paste(round((x), digits = 1), " lower than ",sep="%"))
  } else {
    (paste("remains flat at ", round(abs(x), digits = 1,sep="%")))
  }
}

conditional_alt3 <- function(x){
  if (x < lag.xts(x,k=1)) {
    print(paste("a slower pace of growth compared to the previous month"))
  } else if (x >lag.xts(x,k=1)){
    print(paste("a faster pace of growth compared to the previous month"))
  } else {
    print(paste("a consistent pace of growth compared to the previous month"))
  }
}


conditional_alt4 <- function(x){
  if (x < 0) {
    print(paste(round(x,1), "percentage points below what was forecast at the time of the Budget"))
  } else if (x >0){
    print(paste(round(x,1), "percentage points above what was forecast at the time of the Budget"))
  } else {
    print(paste("inline with the Budget forecast"))
  }
}

conditional_alt5 <- function(x){
  if (x < 0) {
    print(paste("made a negative contribution of", round(x,1), "percentage points to overall export growth"))
  } else if (x >0){
    print(paste("made a positive contribution of", round(x,1), "percentage points to overall export growth"))
  } else {
    print(paste("made a broadly balanced contribution to overall export growth"))
  }
}


CURRENT_DATE<-format(index(OVERALL_HICP_XTS)[length(OVERALL_HICP_XTS)],format="%B %Y")
Monthly_INFLATION<-growth(OVERALL_HICP_XTS, 1) %>% round(1)  
Monthly_INFLATION_TEXT<-conditional(Monthly_INFLATION[length(OVERALL_HICP_XTS)])


ANNUAL_INFLATION<-growth(OVERALL_HICP_XTS, 12) %>% round(1)  
ANNUAL_INFLATION_TEXT<-conditional(ANNUAL_INFLATION[length(OVERALL_HICP_XTS)])

Monthly_INFLATION<-growth(OVERALL_HICP_XTS, 1) %>% round(1)  
Monthly_INFLATION_TEXT<-conditional(Monthly_INFLATION[length(OVERALL_HICP_XTS)])


ANNUAL_CORE_INFLATION<-growth(CORE_HICP_XTS, 12) %>% round(1)  
ANNUAL_CORE_INFLATION_TEXT<-conditional(ANNUAL_CORE_INFLATION[length(CORE_HICP_XTS)])



Monthly_CORE_INFLATION<-growth(CORE_HICP_XTS, 1) %>% round(1)  
Monthly_CORE_INFLATION_TEXT<-conditional(Monthly_CORE_INFLATION[length(CORE_HICP_XTS)])



YTD_2023_annual<-ANNUAL_INFLATION["2023/"] %>% mean()  %>% round(1)

FORECAST_KPI<-YTD_2023_annual-5.3
FORECAST_KPI_TEXT<-conditional_alt4(FORECAST_KPI)

Carryover<-(OVERALL_HICP_XTS[length(OVERALL_HICP_XTS)]-mean(OVERALL_HICP_XTS["2022"]))/mean(OVERALL_HICP_XTS["2022"])*100 %>% as.numeric() 
Carryover_TEXT<-paste0(round(Carryover,1),sep="%")


Contribution_highest_name<-sort(as_vector(last(summary_contribution[1:5])))[(ncol(summary_contribution[1:5]))] %>% names()

Contribution_highest_number<-sort(as_vector(last(summary_contribution[1:5])))[(ncol(summary_contribution[1:5]))] %>% round(1)
Contribution_highest_number_text<-as.numeric(Contribution_highest_number)

Contribution_highest_percent<-(Contribution_highest_number/rowSums(last(summary_contribution)[1:5]))*100 %>% round(1)
Contribution_highest_percent<-paste0(round(as.numeric(Contribution_highest_percent),1), sep="%")


CURRENT_DATE_COMPONENTS<-format((summary_contribution$Date)[length(summary_contribution$Date)],format="%B %Y")


sub_compon_max<-sort(last(as_vector(CONTRIBUTION)),decreasing = TRUE)[1] %>% round(1)


growth_goods<-growth(overall_GOODS_index, 12) %>% round(1)
growth_Services<-growth(overall_service_index,12) %>% round(1)
growth_Services_TEXT<-conditional(growth_Services[length(growth_Services)])


ORDER_SERVICES_CONTRIBUTION<-last(CONTRIBUTION[1:36]) %>% data.frame() %>% as_vector() %>% 
  sort(decreasing = TRUE) 

names(ORDER_SERVICES_CONTRIBUTION)<-ORDER_SERVICES_CONTRIBUTION %>% names() %>% gsub(
                        pattern = "\\.",
                        replacement = " ") %>% str_squish()


SERVICES_GOODS_XTS_INDEX_GROWTH<-growth(SERVICES_GOODS_XTS_INDEX["2020/"], freq=12) %>% round(1) %>%.["2021/"]


GROWTH_COMPONENTS<-data.frame(SERVICES_GOODS_XTS_INDEX_GROWTH,index(SERVICES_GOODS_XTS_INDEX_GROWTH))
names(GROWTH_COMPONENTS)<-colnames(CONTRIBUTION) 

names(GROWTH_COMPONENTS)<-GROWTH_COMPONENTS %>% names() %>% gsub(
                        pattern = "\\,",
                        replacement = " ") %>%  gsub(
                        pattern = "\\.",
                        replacement = " ")    %>% str_squish()




GROWTH_RATE_SERVICES_MAX_CONTRIBUTION<-GROWTH_COMPONENTS[names(ORDER_SERVICES_CONTRIBUTION[1:3])]



FIRST_ORDER_SERVICES_CONTRIBUTION<-names(ORDER_SERVICES_CONTRIBUTION[1])
SECOND_ORDER_SERVICES_CONTRIBUTION<-names(ORDER_SERVICES_CONTRIBUTION[2])
THIRD_ORDER_SERVICES_CONTRIBUTION<-names(ORDER_SERVICES_CONTRIBUTION[3])

FIRST_ORDER_SERVICES_CONTRIBUTION_YOY<-paste0(GROWTH_RATE_SERVICES_MAX_CONTRIBUTION[nrow(GROWTH_RATE_SERVICES_MAX_CONTRIBUTION),1], sep="%")
SECOND_ORDER_SERVICES_CONTRIBUTION_YOY<-paste0(GROWTH_RATE_SERVICES_MAX_CONTRIBUTION[nrow(GROWTH_RATE_SERVICES_MAX_CONTRIBUTION),2], sep="%")
THIRD_ORDER_SERVICES_CONTRIBUTION_YOY<-paste0(GROWTH_RATE_SERVICES_MAX_CONTRIBUTION[nrow(GROWTH_RATE_SERVICES_MAX_CONTRIBUTION),3], sep="%")



```


***

#### **Overall Inflation Trends** ####

* According to the latest data,  inflation in `r CURRENT_DATE`  `r Monthly_INFLATION_TEXT` over the month. On an annual basis, inflation `r ANNUAL_INFLATION_TEXT` in `r CURRENT_DATE`. 
<br>
<br>

* Core inflation in `r CURRENT_DATE`  `r Monthly_CORE_INFLATION_TEXT` over the month. On an annual basis, inflation `r ANNUAL_CORE_INFLATION_TEXT` in `r CURRENT_DATE`. 
<br>
<br>

* As part of Budget 2024, the Department forecast Inflation growth of 5.3% in 2023. Year to date, annual inflation averaged `r YTD_2023_annual`% in `r CURRENT_DATE`. As a result inflation is currently running `r FORECAST_KPI_TEXT`. 
<br>
<br>

* On a carryover only basis, annual inflation is currently running at `r Carryover_TEXT` for 2023.  
<br>
<br>

***



```{r inflatin contributon graph, echo=FALSE, warning=FALSE}

INFLATION_CON_plot<-INFLATION_CON_plot+theme(legend.position=c(0.3,0.6),plot.title = element_text(hjust = 0.5))


LINE_DATA<-data.frame(unique(summary_contribution_melt$Date),round(GROWTH_OVERALL_XTS[(unique(summary_contribution_melt$Date))],1))
colnames(LINE_DATA)<-c("Date","Growth")

LINE_DATA_2<-melt(LINE_DATA, id=c("Date"))

INFLATION_CON_plot_WITH_LINE<-INFLATION_CON_plot+geom_line(data=LINE_DATA_2,aes(x=Date, y=value),size = 1.2)


INFLATION_CON_plot_WITH_LINE
Inflation_contributions_graph_data<-summary_contribution[1:5] %>% round(3)

```

<br>
<br>

* `r Contribution_highest_name` made the largest contribution to inflation on an annual basis contributing `r Contribution_highest_percent` (`r Contribution_highest_number_text` percentage points to growth) to overall inflation in `r CURRENT_DATE_COMPONENTS`.
<br>
<br>

* At a sub-component level, `r names(sub_compon_max)` made the largest contribution to inflation, contributing `r paste(sub_compon_max)` percentage points to overall inflation growth. 
<br>
<br>

* Service prices `r growth_Services_TEXT` in `r CURRENT_DATE_COMPONENTS` on an annual basis, with strong growth in `r FIRST_ORDER_SERVICES_CONTRIBUTION` (`r FIRST_ORDER_SERVICES_CONTRIBUTION_YOY` y-o-y), `r SECOND_ORDER_SERVICES_CONTRIBUTION` (`r SECOND_ORDER_SERVICES_CONTRIBUTION_YOY` y-o-y) and `r THIRD_ORDER_SERVICES_CONTRIBUTION` (`r THIRD_ORDER_SERVICES_CONTRIBUTION_YOY` y-o-y)
<br>
<br>

***



```{r Inflation waterfall, echo=FALSE, warning=FALSE}

waterfall_graph_change_annual_inflation<-waterfall_graph_change_annual_inflation+ labs(x="",
       title="waterfall change annual inflation",
       caption="Source: CSO, Eurostat, DOF calculations",
       y="Percentage change (%)")+theme(plot.title = element_text(hjust = 0.5))+scale_y_continuous(labels=function(x) paste0(x,"%"))


(waterfall_graph_change_annual_inflation)


colnames(LATEST_Contribution_CHANGE)<-LATEST_Contribution_CHANGE %>% names() %>% gsub(
                        pattern = "\\,",
                        replacement = " ") %>%  gsub(
                        pattern = "\\.",
                        replacement = " ")    %>% str_squish()


Last_month_decreasing_component<-paste0(lag(GROWTH_COMPONENTS[names(sort(as_vector(LATEST_Contribution_CHANGE))[1])],1)[nrow(GROWTH_COMPONENTS),],sep="%")
Current_month_decreasing_component<-paste0(GROWTH_COMPONENTS[names(sort(as_vector(LATEST_Contribution_CHANGE))[1])][nrow(GROWTH_COMPONENTS),],sep="%")


Last_month_increasing_component<-paste0(lag(GROWTH_COMPONENTS[(names(sort(as_vector(LATEST_Contribution_CHANGE),decreasing = TRUE)))[1]],1)[nrow(GROWTH_COMPONENTS),],sep="%")
Current_month_increasing_component<-paste0((GROWTH_COMPONENTS[(names(sort(as_vector(LATEST_Contribution_CHANGE),decreasing = TRUE)))[1]])[nrow(GROWTH_COMPONENTS),],sep="%")

Waterfall_graph_data<-data.frame(Inflation_Contributions[nrow(Inflation_Contributions)-1,],ENERGY_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)],FOOD_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)],NEIG_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)],Rent_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)],CORE_SERVICES_CHANGE_CONTRIBUTION[length(CORE_SERVICES_CHANGE_CONTRIBUTION)],Inflation_Contributions[nrow(Inflation_Contributions),]) %>% round(3)



colnames(Waterfall_graph_data)<-c(Previous,"Energy","Food","NEIG","Rent","Core Services", CURRENT)

overall_waterfall_text<-conditional_alt2(last(Inflation_Contributions)-as.numeric(last(lag(Inflation_Contributions,1))))


text1<-paste0(as.numeric(round(last(Inflation_Contributions),1)),sep="%")
text2<-paste0(as.numeric(round(last(lag(Inflation_Contributions,1)),1)),sep="%")
text3<-names(sort(as_vector(LATEST_Contribution_CHANGE))[1])
text4<-names(sort(as_vector(LATEST_Contribution_CHANGE),decreasing = TRUE)[1])

```

***

* In `r CURRENT` annual inflation (`r text1`) was `r overall_waterfall_text` `r Previous`  (`r text2`).
<br>
<br>
* `r text3` was the most substantive drag on annual inflation over the month, falling from `r Last_month_decreasing_component` in  `r Previous` to `r Current_month_decreasing_component` in `r CURRENT`
<br>
<br>
* `r text4` was the most substantive contribution to the change in annual inflation over the month, rising from `r Last_month_increasing_component` in  `r Previous` to `r Current_month_increasing_component` in `r CURRENT`
<br>
<br>

***
```{r trim_graph, echo=FALSE, warning=FALSE}

(trim_graph)
```

```{r trim_graph_2, echo=FALSE, warning=FALSE}

trimmed_graph_data<-graph_data["2017/"] %>% round(3)
colnames(trimmed_graph_data)<-c("Trimmed DOF Inflation", "Overall HICP", "Core Inflation")

```


```{r trim_graph_2_1, echo=FALSE, warning=FALSE}
Compare_TRIM_CORE<-na.omit(trimmed_graph_data$`Trimmed DOF Inflation`,na.rm=TRUE)-na.omit(trimmed_graph_data$`Core Inflation`,na.rm=TRUE)
Compare_TRIM_CORE_TEXT<-conditional_alt2(Compare_TRIM_CORE[length(Compare_TRIM_CORE)])
trim_date<-index(Compare_TRIM_CORE)[length(Compare_TRIM_CORE)] %>% format("%B %Y")
```


```{r trim_graph_3, echo=FALSE, warning=FALSE}

current_trimmed_mean<-trimmed_graph_data$`Trimmed DOF Inflation`[nrow(trimmed_graph_data)] %>% round(1) %>% paste0(sep="%")

```



```{r trim_graph_3.1, echo=FALSE, warning=FALSE}

current_core_inflation<-trimmed_graph_data$`Core Inflation`[nrow(trimmed_graph_data)] %>% round(1) %>% paste0(sep="%")

```






```{r trim_graph_4, echo=FALSE, warning=FALSE}
trimming_series<-growth_SERVICES_GOODS["2017/"] 
colnames(trimming_series)<-c(Index_names)
exclusion_max<-trimming_series[nrow(trimming_series)] %>% data.frame() %>% as_vector() %>% sort(decreasing = TRUE) %>% round(1) 


```

```{r trim_graph_5, echo=FALSE, warning=FALSE}

exclusion_list<-exclusion_max[1:9] %>% names() %>% gsub(
                        pattern = "\\,",
                        replacement = " ") %>%  gsub(
                       pattern = "\\.",
                       replacement = " ")    %>% str_squish() 
```



```{r trim_graph_6, echo=FALSE, warning=FALSE}

exclusion_min<-trimming_series[nrow(trimming_series)] %>% data.frame() %>% as_vector() %>% sort(decreasing = FALSE) %>% round(1) 
```



```{r trim_graph_7, echo=FALSE, warning=FALSE}

exclusion_list_min<-exclusion_min[1:9] %>% names() %>% gsub(
                       pattern = "\\,",
                      replacement = " ") %>%  gsub(
                     pattern = "\\.",
                 replacement = " ")    %>% str_squish() 

```
 

***
* The trimmed mean inflation is an internal DOF calculation based on excluding the series with highest and lowest rates of annual growth. 
<br>
<br>
* Among high growth components removed include `r exclusion_list[1]` (`r paste0(as.numeric(exclusion_max[1]), sep="%")` y-o-y), `r  exclusion_list[2]`(`r paste0(as.numeric(exclusion_max[2]), sep="%")` y-o-y) and  `r  exclusion_list[3]` (`r paste0(as.numeric(exclusion_max[3]), sep="%")` y-o-y)
<br>
<br>
* Among the low growth components removed include `r exclusion_list_min[1]` (`r paste0(as.numeric(exclusion_min[1]), sep="%")` y-o-y), `r  exclusion_list_min[2]` (`r paste0(as.numeric(exclusion_min[2]),sep="%")` y-o-y) and `r  exclusion_list_min[3]` (`r paste0(as.numeric(exclusion_min[3]), sep="%")` y-o-y).  
<br>
<br>
* In `r trim_date`, the trimmed inflation rate (`r current_trimmed_mean` y-o-y) was `r Compare_TRIM_CORE_TEXT` Core inflation (`r current_core_inflation` y-o-y).
<br>
<br>

***
```{r proporation of inflation basket, echo=FALSE, warning=FALSE}


CONTRIBUTION_INFLATION<-CONTRIBUTION_INFLATION+theme(legend.position="bottom",plot.title = element_text(hjust = 0.5))
CONTRIBUTION_INFLATION

graph_data_inflation_basket<-inflationbreakdown[2:5]

basket_weight_date<-last(unique(index(as.xts(graph_data_inflation_basket)))) %>% format("%B %Y")  
text_high_basket<-round(last(graph_data_inflation_basket$`>5%`)*100,1) 

basket_weight_date_prior_month<-last(unique(index(as.xts(graph_data_inflation_basket))-1)) %>% format("%B %Y")  
text_high_basket_prior<-round((graph_data_inflation_basket[nrow(graph_data_inflation_basket)-1,][4])*100,1) 

compare_high_weight_text<-conditional_alt2(text_high_basket-text_high_basket_prior)


text_low_basket<-round(last(graph_data_inflation_basket$`0%-2%`+graph_data_inflation_basket$`<0%`)*100,1) %>% paste0(sep="%") 




```


***

* As inflation becomes broad based in nature a greater proportion of the infaltion basket records higher rates of inflation. 
<br>
<br>
* In `r basket_weight_date`, `r paste0(text_high_basket,sep="%")` of the inflation basket reported inflation in excess of 5%. This is `r compare_high_weight_text` in  `r basket_weight_date_prior_month`.
<br>
<br>
* Approximately `r text_low_basket` of the inflation basket reported inflation less than or equal to 2%. This compares to over 50% prior to the pandemic.  
<br>
<br>

*** 


```{r OVER 5 FOR 12 proporation of inflation basket, echo=FALSE, warning=FALSE}


over_five_12_Months_graph
Latest_over_5_over_12<-round(last(over_five_12_Months_graph$data$Over_5*100),1) 
Latest_over_5_over_12_TEXT<-paste0(Latest_over_5_over_12,"%")
Latest_over_5_over_12_DATE<-last(over_five_12_Months_graph$data$Index)  %>% format("%B %Y")


Latest_over_5_over_12_ex_energy<-round(last(over_five_12_Months_graph$data$Over_5_ex_energy*100),1) 
Latest_over_5_over_12_ex_energy_TEXT<-paste0(Latest_over_5_over_12_ex_energy,"%")



```



***

* Reflecting both the broad based and the persistent nature of inflation, `r Latest_over_5_over_12_TEXT` of the components in the inflation basket had an inflation rate in excess of 5% for at least the last 12 months  in `r Latest_over_5_over_12_DATE`. 
<br>
<br>

* Exclduing the energy components from the basket, `r Latest_over_5_over_12_ex_energy_TEXT` of the remaining components in the inflation basket had an inflation rate in excess of 5% for at least the last 12 months  in `r Latest_over_5_over_12_DATE`.
<br>
<br>


*** 




```{r heatmap, echo=FALSE, warning=FALSE}


SERVICES_GOODS_XTS_INDEX_GROWTH<-growth(SERVICES_GOODS_XTS_INDEX["2020/"], freq=12) %>% round(1) %>%.["2021/"]
DF<-data.frame(SERVICES_GOODS_XTS_INDEX_GROWTH,index(SERVICES_GOODS_XTS_INDEX_GROWTH))

colnames(DF)<-c(Index_names,"Date")


DFF<-DF[names(sort(as_vector(CONTRIBUTION[nrow(CONTRIBUTION),]),decreasing = TRUE)[1:20])]
DFF<-data.frame(DFF,index(SERVICES_GOODS_XTS_INDEX_GROWTH["2021/"]))
DFF<-DFF[which(colnames(DFF)!="Gas")]
DFF<-DFF[which(colnames(DFF)!="Electricity")]
DFF<-DFF[which(colnames(DFF)!="Other.services.for.Personal.Transport")]
DFF<-DFF[which(colnames(DFF)!="Liquid.Fuel")]
DFF<-DFF[which(colnames(DFF)!="Solid.Fuels")]

Graph_Data_Heatmap<-DFF %>% .[1:16] 

colnames(Graph_Data_Heatmap)<-Graph_Data_Heatmap %>% names() %>% gsub(
                        pattern = "\\,",
                        replacement = " ") %>%  gsub(
                        pattern = "\\.",
                        replacement = " ")    %>% str_squish()



DFFF<-melt(DFF,id=c("index.SERVICES_GOODS_XTS_INDEX_GROWTH..2021...."))


DFFF<-DFFF %>% mutate(variable = recode(.$variable,  "Mineral.Water..Soft.Drinks..Vegetable.Juices" = "Soft drinks","Non.durable.househld.goods" ="Non-durable","Electrical.Appliances.for.personal.care"="Personal care app","Accomdation.Services"="Hotel,etc."))


GG_heatmap<-ggplot(data=DFFF, aes(y=variable,x=index.SERVICES_GOODS_XTS_INDEX_GROWTH..2021....,fill=value, label=value))+
                   geom_tile(color="black",size=1.1, lwd = 0,
            linetype = 0)+geom_text(aes(label = value), color = "black", size = 2)+scale_fill_gradient2(low = "green", high = "red",midpoint = 1)+  theme(legend.position = "none")

       
GG_heatmap<-GG_heatmap+labs(title="Heatmap of the highest contribution to annual inflation (excl.Energy)", caption="Source: CSO, Eurostat, DOF calculations",
       y="")+theme(plot.title = element_text(hjust = 0.5),axis.title.x = element_blank())
GG_heatmap



NAMES_HIGH_HEATMAP<-sort(as_vector(Graph_Data_Heatmap[nrow(Graph_Data_Heatmap),]),decreasing = TRUE)[1] %>% names()
heatmap_date<-last(unique(DFFF$index.SERVICES_GOODS_XTS_INDEX_GROWTH..2021....))

text_heatmap_growth_rate<-sort(as_vector(Graph_Data_Heatmap[nrow(Graph_Data_Heatmap),]),decreasing = TRUE)[1] %>% as.numeric() %>% paste0(sep="%")

NAMES_HIGH_HEATMAP_2<-sort(as_vector(Graph_Data_Heatmap[nrow(Graph_Data_Heatmap),]),decreasing = TRUE)[2] %>% names()
text_heatmap_growth_rate_2<-sort(as_vector(Graph_Data_Heatmap[nrow(Graph_Data_Heatmap),]),decreasing = TRUE)[2] %>% as.numeric() %>% paste0(sep="%")

NAMES_HIGH_HEATMAP_3<-sort(as_vector(Graph_Data_Heatmap[nrow(Graph_Data_Heatmap),]),decreasing = TRUE)[3] %>% names()
text_heatmap_growth_rate_3<-sort(as_vector(Graph_Data_Heatmap[nrow(Graph_Data_Heatmap),]),decreasing = TRUE)[3] %>% as.numeric() %>% paste0(sep="%")

       
```



***
* The heatmap above excludes the energy components to allow for a greater focus on the core components. 
<br>
<br>

* `r NAMES_HIGH_HEATMAP` recorded particularly strong inflation in `r format(heatmap_date, "%B %Y")`, increasing by `r text_heatmap_growth_rate` on an annual basis. 
<br>
<br>

* `r NAMES_HIGH_HEATMAP_2` and `r NAMES_HIGH_HEATMAP_3` also recorded strong annual inflation in `r format(heatmap_date, "%B %Y")`, increasing by `r text_heatmap_growth_rate_2` and `r text_heatmap_growth_rate_3` respectively. 
<br>
<br>

***


```{r contribution EA inflation, echo=FALSE, message=FALSE, warning=FALSE}

FOOD_EA_XTS<-rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.CP011") %>% .$value %>% as.numeric() %>% as.xts(order.by = rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.CP011") %>% .$period)

FOOD_EA_XTS<-FOOD_EA_XTS
RENT_EA_XTS<-rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.CP041") %>% .$value %>% as.numeric() %>% as.xts(order.by = rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.CP041") %>% .$period)
RENT_EA_XTS<-RENT_EA_XTS

NEIG_EA_XTS<-rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.IGD_NNRG") %>% .$value %>% as.numeric() %>% as.xts(order.by = rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.IGD_NNRG") %>% .$period)


NEIG_EA_XTS<-NEIG_EA_XTS

ENERGY_EA_XTS<-rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.NRG") %>% .$value %>% as.numeric() %>% as.xts(order.by = rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.NRG") %>% .$period)

ENERGY_EA_XTS<-ENERGY_EA_XTS

CORE_SERVICES_EA_XTS<-rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.SERV") %>% .$value %>% as.numeric() %>% as.xts(order.by = rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.SERV") %>% .$period) - RENT_EA_XTS

CORE_SERVICES_EA_XTS<-CORE_SERVICES_EA_XTS

MISC_GOOD_SERVICES_EA_XTS<-rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.CP12") %>% .$value %>% as.numeric() %>% as.xts(order.by = rdb("Eurostat/prc_hicp_ctrb/M.PC_PNT.EA.CP12") %>% .$period) 

MISC_GOOD_SERVICES_EA_XTS<-MISC_GOOD_SERVICES_EA_XTS


EA_INFLATION<-CORE_SERVICES_EA_XTS+ENERGY_EA_XTS+NEIG_EA_XTS+RENT_EA_XTS+FOOD_EA_XTS+MISC_GOOD_SERVICES_EA_XTS
EA_INFLATION_CONTRIBUTION<-merge(CORE_SERVICES_EA_XTS,ENERGY_EA_XTS,NEIG_EA_XTS,RENT_EA_XTS,FOOD_EA_XTS,MISC_GOOD_SERVICES_EA_XTS)
IRE_INFLATION_CONTRIBUTION<-merge(NEIG,FOOD,ENERGY,Rent,CORE_SERVICES)


delta_EA_IRE_ONE<-data.frame(EA_INFLATION_CONTRIBUTION$CORE_SERVICES_EA_XTS-IRE_INFLATION_CONTRIBUTION$CORE_SERVICES,
  EA_INFLATION_CONTRIBUTION$NEIG_EA_XTS-IRE_INFLATION_CONTRIBUTION$NEIG,
  EA_INFLATION_CONTRIBUTION$RENT_EA_XTS-IRE_INFLATION_CONTRIBUTION$Rent,
  EA_INFLATION_CONTRIBUTION$FOOD_EA_XTS-IRE_INFLATION_CONTRIBUTION$FOOD,
  EA_INFLATION_CONTRIBUTION$ENERGY_EA_XTS-IRE_INFLATION_CONTRIBUTION$ENERGY, index(EA_INFLATION_CONTRIBUTION["2017/"])
) 


delta_EA_IRE<-delta_EA_IRE_ONE %>% .[37:nrow(delta_EA_IRE_ONE),] %>% melt(id=c("index.EA_INFLATION_CONTRIBUTION..2017....")) %>% na.omit() %>%  mutate(variable = recode(.$variable,  "RENT_EA_XTS" = "Rent","NEIG_EA_XTS" ="NEIG","FOOD_EA_XTS" ="Food","CORE_SERVICES_EA_XTS" ="Core Services","ENERGY_EA_XTS" ="Energy"))

Graph_Data_EA<-delta_EA_IRE_ONE %>% na.omit() %>% .[1:5] %>% round(3)
Graph_Data_EA<-Graph_Data_EA*-1
colnames(Graph_Data_EA)<-c("Core Services","NEIG","Rent","Food","Energy")

 

DELTA_EA_IRE_CON_plot<-ggplot(data=delta_EA_IRE, aes(y=value*-1, x=index.EA_INFLATION_CONTRIBUTION..2017...., fill=variable)) + 
  geom_bar(position="stack", stat="identity")+theme(legend.position='bottom',element_text(size=100))+
  labs(x="",
       title=" Ireland V's Euro Area Inflation",
       caption="Source: CSO, Eurostat, DOF calculations",
       y="percentage point difference")+
  scale_fill_manual(name = "", values  = c("NEIG" = DOF_colours[1],"Food" = DOF_colours[2],"Energy" = DOF_colours[3],"Rent" = DOF_colours[5],"Core Services" = DOF_colours[4]))+
  scale_y_continuous(labels=function(x) paste0(x,"%"))+theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))+theme(legend.position=c(0.3,0.9),plot.title = element_text(hjust = 0.5),legend.background=element_blank())

  


IRE_EA_DIFF<-data.frame(index(EA_INFLATION["2022/"]), LINE_DATA$Growth[25:length(EA_INFLATION["2020/"])]-EA_INFLATION["2022/"])

colnames(IRE_EA_DIFF)<-c("Date","IRE_EA_DIFF")
IRE_EA_DIFF<-melt(IRE_EA_DIFF, id=c("Date"))
       
DELTA_EA_IRE_CON_plot_2<-DELTA_EA_IRE_CON_plot+geom_line(data=IRE_EA_DIFF,aes(x=Date, y=value),size = 1)

DELTA_EA_IRE_CON_plot_2

IRELAND_HIGHER_VAL<-Graph_Data_EA[nrow(Graph_Data_EA),][which(Graph_Data_EA[nrow(Graph_Data_EA),]>=0)]

IRELAND_LOWER_VAL<-Graph_Data_EA[nrow(Graph_Data_EA),][which(Graph_Data_EA[nrow(Graph_Data_EA),]<=0)]


Text_IRELAND_higher<-paste0(colnames(IRELAND_HIGHER_VAL[1:length(IRELAND_HIGHER_VAL)-1]),sep=",")
Text_IRELAND_higher_last<-paste0(((colnames(IRELAND_HIGHER_VAL[length(IRELAND_HIGHER_VAL)]))))


Text_IRELAND_Lower<-paste0(((colnames(IRELAND_LOWER_VAL[1:length(IRELAND_LOWER_VAL)-1]))),sep=",")

Text_IRELAND_Lower_Last<-paste0(((colnames(IRELAND_LOWER_VAL[length(IRELAND_LOWER_VAL)]))))


```


```{r EA TEXT ONLY, warning=FALSE, include=FALSE}

text_IRE_EA_DIFF<-conditional_alt2(IRE_EA_DIFF$value[nrow(IRE_EA_DIFF)])

```


***

* The graph above illustrates the difference between Ireland and Euro Area inflation. 
<br>
<br>

* In `r format(index(EA_INFLATION), "%B %Y")[nrow(EA_INFLATION)]` inflation in Ireland was `r text_IRE_EA_DIFF` than in the Euro Area. 
<br>
<br>

* `r Text_IRELAND_Lower` `r Text_IRELAND_Lower_Last` in Ireland recorded lower annual inflation than the same components in the Euro Area as a whole. 
<br>
<br>

* `r Text_IRELAND_higher` `r Text_IRELAND_higher_last` in Ireland recorded higher annual inflation than the same components in the Euro Area as a whole. 
<br>
<br>

***

```{r Survery, warning=FALSE, include=FALSE}


Service_price_expectation<-rdb("Eurostat/ei_bsse_m_r2/M.BAL.BS-PE3M.SA.IE")%>% .$value %>% as.numeric() %>% as.xts(order.by = rdb("Eurostat/ei_bsse_m_r2/M.BAL.BS-PE3M.SA.IE") %>% .$period) %>% .["2017/"]


GR_overall_services<-growth(inflation_excel$`Overall Services (2015= 100)`,12) %>% as.xts(order.by=index(as.xts(Date_index[253:length(Date_index)])))

expectations_graph_data<-merge(GR_overall_services,Service_price_expectation) %>% round(1)
names(expectations_graph_data)<-c("HICP Services","Service Price Expectations") 

scale = 0.1


EXPECTED_INFLT<-ggplot(data=expectations_graph_data,aes(x=index(expectations_graph_data)))+geom_line(aes(y=`HICP Services`, colour="HICP Services Growth (lhs)"),size=1)+
  theme(legend.position=c(0.8,0.2),plot.caption = element_text(hjust=0),legend.background=element_blank())+
  
  geom_line(aes(y=`Service Price Expectations`/10, colour="Service Price Expectation (rhs)"),size=1)+  
  scale_y_continuous(sec.axis = sec_axis(~.*10, name="balance")) +
  
    labs(x="",
       title="Service price expectations over the next 3 months",
       caption="Source: CSO, Eurostat, DOF calculations",
       y="annual percentage change")+
  scale_color_manual(name = "", values = c("HICP Services Growth (lhs)" = DOF_colours[2],"Service Price Expectation (rhs)" = DOF_colours[3]))+
  theme_bw()+theme(panel.border = element_blank(),axis.line =element_line(colour = "black"))

EXPECTED_INFLT_graph<-EXPECTED_INFLT+theme(legend.position=c(0.2,0.9),plot.title = element_text(hjust = 0.5))


EXPECTED_INFLT_graph


Change_expectations<-expectations_graph_data$`Service Price Expectations`-lag.xts(expectations_graph_data$`Service Price Expectations`,1)

expectations_services_prices<-if(as.numeric(Change_expectations[length(na.omit(Change_expectations))])>0){
  paste0("service prices are expected to increase over the coming months")
} else {
  paste0("service prices are expected to moderate over the coming months")
}

```

```{r Graph, echo=FALSE, warning=FALSE}
EXPECTED_INFLT_graph

```



***

* Survey based estimates of the expected price developments over the next three months provide a useful forward looking indicator of price developments. 
<br>
<br>

* The lastest reading for `r format(index(Change_expectations[length(Change_expectations)]),"%B %Y")` suggests that  `r expectations_services_prices`. 
<br>
<br>



```
